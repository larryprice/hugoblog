<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title> Larry Price &middot; Larry Price </title>

  
  <link rel="stylesheet" href="http://localhost:1313//css/poole.css">
  <link rel="stylesheet" href="http://localhost:1313//css/syntax.css">
  <link rel="stylesheet" href="http://localhost:1313//css/hyde.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.ico">

  
  <link href="http://localhost:1313/index.xml" rel="alternate" type="application/rss+xml" title="Larry Price" />
</head>

<body>

<div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>Larry Price</h1>
      <p class="lead">
      An elegant open source and mobile first theme for <a href="http://hugo.spf13.com">hugo</a> made by <a href="http://twitter.com/mdo">@mdo</a>. Originally made for Jekyll.
      </p>
    </div>

    <ul class="sidebar-nav">
      <li><a href="/">Home</a> </li>
      
    </ul>

    <p>&copy; 2015. All rights reserved. </p>
  </div>
</div>


    <div class="content container">
<div class="posts">

      
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2015-02-22-peopleware/">
        Peopleware
      </a>
    </h1>

    <span class="post-date">Sun, Feb 22, 2015</span>

    <blockquote>
<p>Visual supervision is a joke for development workers. Visual supervision is for prisoners.</p>
</blockquote>

<p>###The Gist</p>

<p><a href="http://amzn.to/1JzYT3i">Peopleware</a>, originally published in 1987, is the most relevant book ever written for managing software teams and organizations. DeMarco and Lister give a light-hearted take on all the wrong ways to manage IT projects and give helpful shoves towards some better alternatives.</p>

<p>###My Opinion</p>

<p>I knew this book would be a good fit for me, but I had no idea just how much I would like it. This book connects a lot of pain points I&rsquo;ve had so far in my (relatively) short career, so much so that I cannot believe we still have these problems nearly thirty years since its inception.</p>

<p>In particular, I found the first half of this book life-affirming. The second half is more about managing people/teams, which is harder for me to get a grasp on as a developer, though now I&rsquo;ll be quietly (or loudly) judging my managers based on what I read. Let me go into details about all my favorite parts of this book.</p>

<p><em>Quality &ndash; If Time Permits</em>. Sacrificing quality for the sake of time and/or money is an extremely common theme in our industry. Not only does a low-quality product hurt the bottom line, but software builders base thier self-esteem on the quality of their code and releasing bad code makes us feel bad. Morale is guaranteed to hit rock-bottom when we are not given enough time to determine edge cases and iron out bugs before releasing a product.</p>

<p>Parkinson&rsquo;s Law is complete gibberish. Parkinson&rsquo;s Law states that <em>work expands to fill the time allocated</em>. I&rsquo;ve heard this phrase thrown around pretty persistently in my professional life, especially when we talk about estimating story points. I shouldn&rsquo;t need to go into why this is a terrible thing to tell a dev team. It&rsquo;s insulting; do we truly believe that our development team does not want to get the work done as efficiently as possible?</p>

<p><em>The Office Environment</em>. This part of the book hit a little too close to home for me. I recently moved desks and have been having unforeseen interruption and distraction issues. I sat right next to the door entering Main Engineering. Hundreds of times a day, I would hear the <em>beep!</em> of a badge swipe, the <em>clunk!</em> of the door unlocking, the <em>crunch!</em> of the handle being pushed in while the door swings open, and finally the <em>ker-chunk!</em> of the door closing and locking. Each of these times, my head would naturally bounce up towards the doorway to see who&rsquo;s entered. In the most unfortunate of cases, I would make eye contact with the intruder, prompting them to come and chat for a brief moment. Time and time again, my concentration would be broken. I finally realized this a few days ago and moved my desk back into a little corner, which alleviated a big part of this problem.</p>

<p><em>You Never Get Anything Done Around Here Between 9 and 5</em>. I have become somewhat infamous in the office for being the first one to work. I currently arrive around 7am, although I&rsquo;ve been known to show up anywhere between 5:30am and 7:30am depending on what I&rsquo;m working on. I do this because <a href="http://abcnews.go.com/Business/facebook-open-plan-office-rich-distractions/story?id=19545464">the open office plan that software culture is currently infatuated with</a> drives me insane. I had begun to think I was the only one in the industry who would prefer a shared private office to an open cube farm, but fortunately this book has reassured me of my sanity. Knowledge work requires quiet time without distractions or interruptions, which often means it requires walls and a door.</p>

<p><em>You Never&hellip;</em> also discusses space issues. The authors are famous for conducting  &ldquo;coding war games,&rdquo; where individuals from different companies compete in a programming challenge while timing themselves and writing down every disruption that affected their time. In these studies, they found that those with a greater amount of personal space tended to do better than those with less. The top quartile had 78 square feet on average, while the bottom had 46 square feet. My estimate puts my current space at around 40 square feet.</p>

<p>Somewhere in <em>The Office Environment</em>, the authors discuss windows (the transparent kind), which I wanted to breifly touch on. Our current facilities are window-rich, but window-seat poor due to the design of the building. Fortunately, we have a Commons area that is &ldquo;<a href="http://www.mrbreakfast.com/ucp/674_6841_ucp.jpg">Oops! All Windows</a>&rdquo; at our disposal, but I would love to be able to glance out a window from my desk. My eyes get tired throughout the long day of staring at my computer; the authors prescribe desks with at least 8 feet of space between the developer and the wall such that the developer can let his or her eyes rest from time to time. This is a difficult problem to solve with cubicles. Windows also help with this.</p>

<p>There is also a lot of content in this book about managing people, especially those in software. You should read it. There are good discussions about not forcing teams to do overtime, keeping players who work well together on the same teams, and letting underlings make decisions.</p>

<p>All in all, this book was incredibly useful for me and made me feel a little less alien. I read the second edition of this book, though I have come to learn there has recently been a third edition released.</p>

<p>###Who Would Like This</p>

<p>Software developers and anyone who thinks they have direct control over software developers should stop whatever they are doing right now and read this book. Did you read this book twenty years ago? <em>Read it again</em>.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2015-02-11-ollert-is-now-open-source/">
        Ollert is now open source
      </a>
    </h1>

    <span class="post-date">Wed, Feb 11, 2015</span>

    

<p><a href="https://ollertapp.com">Ollert</a>, the Trello data analytics tool, has been open sourced under <a href="https://github.com/sep/ollert/blob/master/LICENSE">GNU Affero GPL v3.0</a>. The source code can be found <a href="https://github.com/sep/ollert/">on Github</a> and I&rsquo;ve already accepted several pull requests.</p>

<h4 id="why:91a8505ce7232e3372e61c9b8f758bab">Why?</h4>

<p>I&rsquo;ve been working towards this for a few months now. Although Ollert was a lot of fun to create and has helped quite a few people learn more about their Trello boards, I&rsquo;ve been having trouble finding the time to write new features in between my other pursuits. Although <a href="http://www.sep.com/">SEP</a> has given me resources in the past, it&rsquo;s not always easy to find people off-project who have the right experience, determination, and time to grok the codebase and start churning out new features.</p>

<p>An interesting pattern started to appear: With every other feature request I received for Ollert, the requestor would add in some other loaded question: Where is the source code? Is there a Github repo so I can add issues? Do you accept pull requests?</p>

<p>Random strangers on the internet wanted to help. These are people with the drive to work with me even though I couldn&rsquo;t give them anything in return. These are people with fresh perspectives on Trello usage which I had never imagined. These are the developers whose help I sorely wanted.</p>

<h4 id="feature-requests:91a8505ce7232e3372e61c9b8f758bab">Feature requests?</h4>

<p>I am still accepting feature requests. Feature requests are now dealt with through our <a href="https://github.com/sep/ollert/issues">issues page</a>.</p>

<h4 id="contributing:91a8505ce7232e3372e61c9b8f758bab">Contributing?</h4>

<ul>
<li>Write tests</li>
<li>Run tests</li>
<li>Seriously, the <a href="https://travis-ci.org/sep/ollert">travis-ci build</a> had better be green.</li>
<li>Follow the currently in-place patterns. If you don&rsquo;t like them, let me know your idea before you work for a week and I deny your changes.</li>
<li>Create issues for whatever you&rsquo;re working on.</li>
<li>We do things by pull requests. Make a fork, make a branch, let Github do the rest.</li>
</ul>

<h4 id="and-so-it-continues:91a8505ce7232e3372e61c9b8f758bab">And so, it continues&hellip;</h4>

<p>This does not mean I am abandoning Ollert. Internally we&rsquo;ll still be discussing how to increase traffic and improve user experience. Hopefully, open sourcing Ollert will give us invaluable feedback on the code and fresh perspectives on features. I&rsquo;m looking forward to the future of Ollert.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2015-01-17-managing-a-go-environment-in-ubuntu/">
        Managing a Go Environment in Ubuntu
      </a>
    </h1>

    <span class="post-date">Sun, Jan 18, 2015</span>

    <p>Many moons ago, I wrote about <a href="/blog/2013/12/15/setting-up-a-go-environment-in-ubuntu-12-dot-04">setting up a Go environment in Ubuntu</a>. After writing that post, I dropped Go development for nearly a year. Today I run the <a href="http://www.meetup.com/Indy-Golang/events/219612982/">Indy Golang meetup</a>, and soon I&rsquo;ll be starting a new work project where I&rsquo;ll be recommending a Go-based tech stack. I&rsquo;ve learned a thing or two about Go and managing its dependencies since I wrote that initial blog post, and I intend to give a short presentation to my meetup about my recent findings. Before I do, I thought I&rsquo;d write a preliminary blog post detailing the tools I use to keep my Go environment sane.</p>

<p>###Installing Go###</p>

<p>The easiest way to install Go in Ubuntu is through <code>aptitude</code>. However, the default version in the Ubuntu repos gets stale fast. I found a tool similar to <code>rvm</code> for downloading and installing local versions of Go called <a href="https://github.com/moovweb/gvm">gvm</a>. For better or worse, <code>gvm</code> is installed through a bash script. Fortunately, it doesn&rsquo;t require sudo:</p>

<pre><code class="language-bash">$ bash &lt; &lt;(curl -s -S -L https://raw.githubusercontent.com/moovweb/gvm/master/binscripts/gvm-installer)
</code></pre>

<p>At this point I removed all my previous finaglig with <code>$GOROOT</code> and <code>$GOPATH</code> from my dot files. You can use <code>gvm listall</code> to see all available versions of Go. As of the writing of this blog post, <code>go1.4.1</code> is the latest release; however, <code>go1.4</code> is the most recent release available with <code>gvm</code>. I&rsquo;m not sure when the list is updated, but I have confidence that it is fairly regular. To install a Go and set it as the default Go:</p>

<pre><code class="language-bash">$ gvm install go1.4 --default
$ which go
/home/lrp/.gvm/gos/go1.4/bin/go
</code></pre>

<p>###Managing Packages###</p>

<p>This is where I come to a fork in the road: <code>gvm</code>, the tool we used to install the desired version of Go, has a concept of pkgset similar to <code>rvm gemset</code>. However, I find the syntax for using a pkgset tiresome every time I come into a directory. I prefer something more automatic. As an additional pain, <code>gvm</code> does not provide a mechanism for installing dependencies from a list of known dependencies. I sought out other tools to address these pains and found <a href="https://github.com/pote/gpm">gpm</a> and <a href="https://github.com/pote/gvp">gvp</a>.</p>

<p><code>gpm</code> is a tool used to manage Go packages. It reads in a file called <code>Godeps</code> which contains a list of packages with versions and can install them from their individual sources. I&rsquo;m currently infatuated with <code>gpm</code> as it addresses a lot of concerns I had when initially learning Go: shared local dependencies, unclear versioning, and installing dependencies from a fresh clone. Install <code>gvm</code> and <code>gvp</code>:</p>

<pre><code class="language-bash">$ pushd /tmp
$ git clone https://github.com/pote/gvp.git &amp;&amp; cd gvp
$ ./configure &amp;&amp; sudo make install
$ cd /tmp
$ git clone https://github.com/pote/gpm.git &amp;&amp; cd gpm
$ ./configure &amp;&amp; sudo make install
$ popd
</code></pre>

<p>We can follow two paths here: using <code>gvm pkgset</code> or using a local <code>.godeps</code> directory to store our dependencies discretely. For these examples, I&rsquo;ll create a directory called <code>gotest</code> with a single file in it:</p>

<p>``` go hello.go
package main</p>

<p>import &ldquo;github.com/go-martini/martini&rdquo;</p>

<p>func main() {
    server := martini.Classic()
    server.Get(&ldquo;/&rdquo;, func() string {
        return &ldquo;<h1>Hello, world!</h1>&ldquo;
    })</p>

<pre><code>server.Run()
</code></pre>

<p>}</p>

<pre><code>
####Method 1: gvm pkgset alongside gpm####

Create and start using a new pkgset:

``` bash
$ gvm pkgset create gotest
$ echo $GOPATH
/home/lrp/.gvm/pkgsets/go1.4/global
$ gvm pkgset use gotest
$ echo $GOPATH
/home/lrp/.gvm/pkgsets/go1.4/gotest:/home/lrp/.gvm/pkgsets/go1.4/global
</code></pre>

<p>What this means is that we are now using our <code>gotest</code> pkgset as default, but the global pkgset will be used to dig up any missing packages. In order to install any dependencies, we need to create a <code>Godeps</code> file for <code>gpm</code> to consume. Our application from above has a dependency on <code>go-martini</code>, so let&rsquo;s add a dependency to <code>v1.0</code> in our Godeps file:</p>

<p>``` text Godeps
github.com/go-martini/martini v1.0</p>

<pre><code>
After you run `go build` to verify that the dependencies aren't installed, run `gpm install` to pull the required packages into your specified pkgset. Run `go build` again and revel in your own brilliance.

That was pretty great, right? The only issue is remembering to type `gvm pkgset use gotest` every time you restart your terminal or switch projects. Otherwise, `gvm` is practically a replacement for one of my favorite ruby tools `rvm`.

####Method 2: gpm and gvp####

`gpm` is intended to be similar to `npm`, a package management tool for NodeJS. The author suggests using a tool called `gvp` to set the `GOPATH` without much thought. If we start a fresh terminal in our example directory, we can use `gvp` to set up our `GOPATH`:

``` bash
$ echo $GOPATH
/home/lrp/.gvm/pkgsets/go1.4/global
$ source gvp
$ echo $GOPATH
/home/lrp/Projects/2015/gotest/.godeps:/home/lrp/Projects/2015/gotest
</code></pre>

<p>You can note the difference in our <code>GOPATH</code> here relative to <code>gvm</code>: we will be using our current directory as a source of code in addition to a local <code>.godeps</code> directory. Go ahead and add <code>.godeps</code> to your <code>.gitignore</code> file or equivalent. We can use the same <code>Godeps</code> file as before:</p>

<p><code>text Godeps
github.com/go-martini/martini v1.0
</code></p>

<p>We run <code>gpm install</code> to install the dependencies to our local <code>.godeps</code> directory.</p>

<p>I prefer this method to using pkgsets. I&rsquo;ve had better luck building projects with complicated structures, and it&rsquo;s a lot easier for me to run <code>source gvp</code> than it is to remember the name of my pkgset. Both methods work pretty well and give me warm fuzzies about managing my dependencies. I&rsquo;m certain that as Go continues to mature more solutions will come available. I&rsquo;ve also been researching using Docker with gpm only, which requires very little tweaking to what I&rsquo;ve already discussed here.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2015-01-16-think-like-a-chef/">
        Think Like a Chef
      </a>
    </h1>

    <span class="post-date">Fri, Jan 16, 2015</span>

    <p>###The Gist</p>

<p>Celebrity chef Tom Colicchio&rsquo;s <a href="http://amzn.to/15faZfN">Think Like a Chef</a> is a recipe-book-slash-culinary-theory hybrid. The reader is taken through a series of basic cooking techniques applied to a plethora of ingredients, followed by a focus on several interesting ingredients used in a variety of recipes, climaxing with a series of three ingredients used to create many interesting meals.</p>

<p>###My Opinion</p>

<p>This book is designed to not just be about recipes, but instead about taking techniques and ingredients and demonstrating unique and interesting ways to think about them. I&rsquo;ve always liked to think that cooking and software engineering have a lot in common. Chefs and programmers have to juggle whole systems of information in their heads at once to solve the problem at hand. Chefs and programmers follow instructions until it no longer benefits them, at which point they make substitutions to create novel solutions. Chefs and programmers tend to dress a bit strange compared to the average businessman. Not to mention we both have to wear hair nets.</p>

<p>I like to cook. I like to think about how I can create different dishes, how I can utilize aging pantry or freezer items, and how I can perfect spice combinations to build restaurant-quality meals. And I like to eat. So I thought I would like this book. Personally, I found the author to be distractingly arrogant and the book design to be irritatingly repetitive. Although not designed as a simple recipe book, I would have been better served using it as such. However, were I to use this as a recipe book, I would have a lot of issues finding many of the exotic ingredients called for in the middle of Indiana, to say nothing of how expensive all his favorite ingredients are.</p>

<p>The pieces of this book that I really enjoyed were the prose on using one&rsquo;s intuition to substitute ingredients, spices, and cooking styles as appropriate; these seemed like the more intellectual parts of the book that I could actually relate to. As a software engineer, I&rsquo;m often working on a problem that seems like it can be solved by following the standard recipe, but actually requires a level of clever substitution to build it into a new idea entirely. As a home cook, I make a substitution in nearly every recipe I find; sometimes it works, sometimes it doesn&rsquo;t. I would have enjoyed this book much more thoroughly had the focus actually been on intuitive cooking instead of fanciful recipes.</p>

<p>###Who Would Like This</p>

<p>Are you about to make a lavish dinner to impress house guests? You could probably find some pretty good (and descriptive) recipes in this book. However, I heard of this thing called the internet that has many more recipes and descriptions of cooking styles as well. If you like beautiful pictures of food, you may also eat this book up (though hopefully not literally). If you happen to be a fan of this celebrity clown, maybe you&rsquo;d enjoy his cavalier writing style more than I did.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2015-01-11-an-example-use-case-for-docker/">
        An Example Use Case for Docker
      </a>
    </h1>

    <span class="post-date">Sun, Jan 11, 2015</span>

    <p>I spent a lot of time last week asking questions about Docker. <a href="#whatdocker">What</a> is Docker? How could Docker help me <a href="#whydocker">day-to-day</a>? How easy is Docker to <a href="#howdocker">use</a>? How does Docker like its eggs cooked? Isn&rsquo;t Docker a brand of sneakers?</p>

<p>###<a name="whatdocker"></a>What is Docker?###</p>

<p><a href="https://www.docker.com/">Docker</a> is a utility for maintaining system environments. Docker capitalizes on <a href="https://en.wikipedia.org/wiki/LXC">Linux containers</a>, a method of operating system virtualization which isolates multiple process groups on a single host.</p>

<p>Through a series of commands, Docker pulls up a base system image and applies changes to create a custom image. Docker provides the means to access any of these step-level containers for further manipulation. Docker uses a unique layered system such that sibling layers can utilize the same base images, in contrast to a virtual machine which would require multiple copies of things like operating systems, shared libraries, and shared binaries. The image below is an excellent visualization of the difference between a virtual machine and a Docker container.</p>

<p><img src="https://i.imgur.com/Lps6K6y.png?1" alt="VM vs LXC" />
</p>

<p>###<a name="whydocker"></a>Why use Docker?###</p>

<p>Docker&rsquo;s primary job is to take in a series of commands and spit out a clean environment with those settings. This is especially useful in deployment. I can take the Docker <code>ubuntu</code> image, download and install all my dependencies, copy over my application code, and run my application given some environment variables.</p>

<p>All of that should sound somewhat familiar if you&rsquo;ve ever used <a href="https://heroku.com">heroku</a>. Heroku performs very similar tasks to get your application up and running: take a Linux image, download base tools for ruby/python/nodejs/whatever, install application-specific dependencies (through bundler, flask, npm, etc.), and run your application given some environment. Docker gives you the power of heroku at the development level. &hellip;Sort of.</p>

<p>If I can create a Docker container for my application to run in, I can set up a build server to use a container to run my tests. I can use that same container to build a <em>clean</em> staging environment. I can use the staging container to build an <em>identically clean</em> production environment. With that knowledge in hand, I know the exact state of the production environment every time I deploy and I can reproduce it locally.</p>

<p>Theoretically, I can even use Docker for setting up a development environment, although after a few days of attempting this I still think you&rsquo;re better off running natively.</p>

<p>Of course, Docker keeps <a href="https://www.docker.com/resources/usecases/">a big list of examples</a> from big-name company use-cases if you&rsquo;re interested.</p>

<p>###<a name="howdocker"></a>Example Usage###</p>

<p>Brass. Tacks. Let us get down to them, compadre.</p>

<p>You probably want to <a href="https://docs.docker.com/installation/#installation">install Docker</a> first. If you&rsquo;re not using Linux, have fun installing <a href="https://github.com/boot2docker/boot2docker">boot2docker</a>, the rest of us are going to get started without you.</p>

<p>I started by trying to bootstrap my environment for <a href="https://ollertapp.com">Ollert</a> with Docker. Ollert uses ruby-2.2, QtWebkit (in test), and MongoDB. It uses bundler to install any required ruby gems. Not too complicated, but I&rsquo;ve noticed it&rsquo;s never easy to get a new developer&rsquo;s environment quite right.</p>

<p>We start out with the official <a href="https://registry.hub.docker.com/_/ruby/">ruby:2.2.0</a> image from the Docker Hub:</p>

<pre><code class="language-bash">$ docker run ruby:2.2.0 echo &quot;B-b-b-b-brass t-t-t-t-tacks!&quot;
</code></pre>

<p>OMG that step will take forever if you&rsquo;ve never downloaded the base <code>debian</code> image. It downloads and sets up quite a few layers. If you&rsquo;re interested in what it&rsquo;s doing behind the scenes and you can read Dockerfiles, <a href="https://github.com/docker-library/ruby/blob/b7fefd2fa79882da90feb0718430680c77c5fa8b/2.2/Dockerfile">this file</a> is what&rsquo;s being executed. Anyway, when it&rsquo;s done you should see a friendly reminder about what we&rsquo;ve gotten down to. We use <code>docker run</code> to run (download first if necessary) an image; in this case, the <code>ruby:2.2.0</code> image. Everything after the image name is the command to run. Now that we&rsquo;ve downloaded some base images, you can check out your available images using <code>docker images</code>.</p>

<p>Now I need to install my system-level dependencies:</p>

<pre><code class="language-bash">$ docker run ruby:2.2.0 apt-get update
</code></pre>

<p>Note how this time the base image was already found in your local repository, resulting in a command that ran pretty quickly (based on your internet speeds (sorry Comcast customers!)). But what have we really done so far? We&rsquo;ve created two separate containers: one with our initial echo command (useless) and one with all our updates. To see these containers, use <code>docker ps -a</code>. This will give you output similar to the following:</p>

<pre><code class="language-bash">$ docker ps -a
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS                      PORTS             NAMES
ad5ddd55f2c2        ruby:2.2.0        &quot;apt-get update&quot;         2 seconds ago       Exited (0) 2 seconds ago                        mad_curie
10cbaac4488c        ruby:2.2.0        &quot;echo 'B-b-b-b-brass&quot;    15 minutes ago      Exited (0) 15 minutes ago                       mad_perlman
</code></pre>

<p>These are now the containers available. We can create a new image from the first container using <code>docker commit ad5 rubyapp</code>, which will allow us to use it to create further containers. However, if we were to do this for every command we wanted to execute, we might be here for a while. We could go into <code>bash</code> on the base image and do all of our steps:</p>

<pre><code class="language-bash">$ docker run -it ruby:2.2.0 /bin/bash
root@1be43510341e:/# apt-get update
...
root@1be43510341e:/# apt-get auto-remove
...
root@1be43510341e:/# apt-get install -y --force-yes libqtwebkit-dev mongodb
...
</code></pre>

<p>We could then use this image to run our app - however, this is also tedious and a bad solution. We want something that we can see on a granular level and reproduce every time for a base image. Fortunately, Docker provides us an easy way to do this using a DSL. Introducing the <code>Dockerfile</code>:</p>

<pre><code class="language-Dockerfile"># base image
FROM ruby:2.2.0

#install system-level dependencies
RUN apt-get update &amp;&amp; apt-get autoremove -y &amp;&amp; apt-get install -y --force-yes libqtwebkit-dev mongodb

# install gems from /tmp such that bundling is CACHED
WORKDIR /tmp
ADD Gemfile Gemfile
ADD Gemfile.lock Gemfile.lock
ADD .env .env
RUN bundle install

# load application source
ADD . /usr/src/app
WORKDIR /usr/src/app

# port where application is served
EXPOSE 5000
</code></pre>

<p>The syntax is a little different, but all we&rsquo;re doing is telling Docker our base image, issuing commands, and copying files. The <code>ADD</code> command allows us to copy files from our host system. In this case, I copy over <code>.</code> to <code>/usr/src/app</code> in the container. I also copy over my Gemfile separately to <a href="http://ilikestuffblog.com/2014/01/06/how-to-skip-bundle-install-when-deploying-a-rails-app-to-docker/">cache the bundle so it does not install every time</a>. I then expose the port I want my application to use. Run this file as such:</p>

<pre><code class="language-bash">$ docker build -t rubyapp .
</code></pre>

<p>This creates an image called <code>rubyapp</code> and a container for every line of the Dockerfile that is run. Although your first build may take a moment, subsequent builds will be cached and should be significantly faster. Now, if we want to run my application:</p>

<pre><code class="language-bash">$ docker run -d --name rubyappinstance rubyapp foreman start -d /usr/src/app
</code></pre>

<p>I use <code>foreman</code> to start my application from the given directory. I tell Docker that the application will be daemonized using the <code>-d</code> flag. If I check my running containers with <code>docker ps</code>, I&rsquo;ll see my application running. If I want to stop it, I just run <code>docker stop rubyappinstance</code>.</p>

<p>I&rsquo;m going to stop there for now. In order to get Ollert working properly, I also need to <a href="http://docs.docker.com/userguide/dockerlinks/">link a Mongo database</a> and change some environment variables in my application, but those are relatively easy tasks.</p>

<p>###Is it worth it?###</p>

<p>The only conclusion is a definite maybe. Docker is definitely pretty cool. It may be able to help you deploy custom applications easier; for Ollert, it feels like overkill. There is a lot of overhead in downloading core versions of different operating systems, and I already find myself itching to clean up all the leftover Docker images/containers on my machine I used once and never again. After getting the Docker development out of the way (building and testing a Dockerfile), you may save yourself some time in the future if you have to change hosting services or CI environments. Try it out! It&rsquo;s a pretty neat concept and definitely worth your attention in 2015.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2014-12-31-2014-retrospective/">
        2014 Retrospective
      </a>
    </h1>

    <span class="post-date">Wed, Dec 31, 2014</span>

    <p>Happy New Year, dear reader.</p>

<p>2014 was a fairly good year for me. I wrote a lot of code, read a lot of books, and published a lot of blog posts.</p>

<p>###Things I got paid to do###</p>

<p>2014 was a reaffirmation of career goals alongside the opportunities to work with several very different clients. In addition to working on cool stuff, I was promoted to Software Engineer 2. During the tail end of the year, I had the chance to work from home part of the week, which was a great experience. A sampling of my professional works this year:</p>

<ul>
<li>I wrapped up my time writing Qt/C++ for a touch-screen automated-guidance system embedded in heavy machinery. I spent the first two months of the year playing Tech Lead for a small team of misfits leaving the project during an organizational restructure. I had the opportunity to work directly with a project architect to redesign features and guide my fellow developers through the implementation.</li>
<li>I worked on <a href="https://h2w.cc">Health2Wealth</a>, a ruby application created by some work friends to track Fitbit data and allow an administrator to award monetary rewards for reaching goals.</li>
<li>I pitched, designed, and implemented a product called <a href="https://ollertapp.com">Ollert</a>, a Trello analysis tool written in ruby. Built during a 48-hour <a href="http://www.sep.com/labs/startupweekend/">SEP Startup Weekend</a>, I led a team of 6 to bring the project to fruition. SEP has fully embraced the product and I continue to work on <a href="/blog/2014/12/02/ollert-6-months-later/">improving it</a> when not on project work. We currently get about 300 sessions a month, and I frequently get emails from users thanking me, reporting bugs, or submitting feature requests.</li>
<li>I became part of a team of developers working on a modern asset-tracking tool to replace an existing Microsoft Access tool. This was my introduction to C# programming with ASP.NET MVC. The project was short-lived for my team, but sparked my interests in RESTful APIs and Javascript.</li>
<li>I worked on a rewrite of a huge WebForms e-commerce site. We created a hybrid site running some pages in the WebForms engine and all of our new pages in fresh MVC. We worked with a high-fidelity prototype created by an outside company, which proved at times invaluable and at other times a thorn in our sides. We worked directly with members of the client on-site, who were able to provide us with great insights into the legacy system and helped us work out unclear requirements.</li>
<li>In December, I had some fun working on a solo proof-of-concept with a new client. This client is planning to do a rewrite of a large application in 2015 and wanted to do some investigation into rules engines, particularly those using Java. I worked through a few libraries and landed on JBoss Drools, an open-source rules engine with an integrated frontend called KIE Workbench. It&rsquo;s been a while since I wrote any Java code, and I&rsquo;d certainly never deployed any Java web applications. After two weeks of work, I was able to launch a web application using Spring MVC and integrate a KIE Workbench instance running on the same Azure virtual machine. The application is able to pick up rule changes from the Workbench automatically, without recompilation or redeployment.</li>
</ul>

<p>###Of my own volition###</p>

<p>I had a lot of fun coding ideas this year, most of them lost to the raptures of time. A few items of note:</p>

<ul>
<li>BYO Game of Life (<a href="http://byo-game-of-life.herokuapp.com">http://byo-game-of-life.herokuapp.com</a>)

<ul>
<li>My most recent release - a frontend web client allowing the user to give a URL pointing to a Game of Life backend. I created a <a href="https://github.com/larryprice/game-of-life-impl">Go implementation</a> as part of my presentation for the inaugural <a href="http://www.meetup.com/Indy-Golang/events/219199103/">Indy Golang meetup</a>.</li>
</ul></li>
<li>3rd Day Organics

<ul>
<li>We finally finished version 1.0 of 3DO, a custom e-commerce website for a co-worker&rsquo;s spouse&rsquo;s cooperative food program. We built the whole application from scratch; in hindsight, we should have set something up using <a href="https://spreecommerce.com">spree</a> or another commerce framework.</li>
</ul></li>
<li>Fortune Cookie API (<a href="http://fortunecookieapi.com">http://fortunecookieapi.com</a>)

<ul>
<li>A fairly silly API written using NodeJS to get data associated with fortune cookies: fortunes, lessons in Chinese, and lottery numbers. I implemented a simple application to access the data at <a href="http://demo.fortunecookieapi.com">http://demo.fortunecookieapi.com</a>.</li>
</ul></li>
<li>mongoose-simple-random (<a href="https://www.npmjs.com/package/mongoose-simple-random">https://www.npmjs.com/package/mongoose-simple-random</a>)

<ul>
<li>My foray into NodeJS packages - this is a plugin which adds <code>findRandom</code> and <code>findOneRandom</code> methods to any mongoose schema. Used extensively in the Fortune Cookie API.</li>
</ul></li>
<li>Ollert (<a href="https://ollertapp.com">https://ollertapp.com</a>)

<ul>
<li>I know I listed it under a paid project, but I was putting over 8 hours a week into Ollert between the time it was originally built and the time I was paid to work on it. It&rsquo;s my big pet project, and I&rsquo;m proud of the things that it and I have accomplished. Trello has noted our accomplishments, validating all the hard work and long hours I&rsquo;d sunk into it.</li>
</ul></li>
</ul>

<p>###Book It - Where&rsquo;s my free pizza?###</p>

<p>I think that I read 11 books this year. See my <a href="/blog/books">books section</a> for a quick check of which books you should be reading. Some of my favorites:</p>

<ul>
<li><a href="http://amzn.to/14coDAd">Rework</a> and <a href="http://amzn.to/1rzTsZH">Remote</a> by Jason Fried</li>
<li><a href="http://amzn.to/14coIUG">Punished by Rewards</a> by Alfie Kohn</li>
<li><a href="http://amzn.to/1tAMWU0">The XX Factor</a> by Alison Wolf</li>
<li><a href="http://amzn.to/1Ai3mBk">The Lean Startup</a> by Eric Ries</li>
<li><a href="http://amzn.to/1x4jaXh">Made to Stick</a> by Chip Heath</li>
</ul>

<p>###This blog o&rsquo; mine###</p>

<p>In reality, I put quite a bit of work into this blog.</p>

<p>I published <strong>24 blog posts in 2013</strong>; I published <strong>37 in 2014</strong> (including this one).</p>

<p>I had <strong>1700 sessions and 2420 pageviews in 2013</strong>. I did almost that well in a single month at the end of 2014. I had <strong>10,194 sessions and 12,997 pageviews in 2014</strong> (as of 10:46AM EST <sup>12</sup>&frasl;<sub>31</sub>/2014).</p>

<p>In February, I set up a custom domain at &ldquo;larry-price.com&rdquo;. Since then, <a href="/blog/2014/12/14/migrating-an-octopress-blog-from-github-pages-to-openshift/">I moved from Github Pages to OpenShift</a> and added SSL.</p>

<p>I integrated Google AdSense this summer. Full disclosure: I&rsquo;ve &ldquo;earned&rdquo; $3.78 in the past 6 months. From my perspective, these ads are simply an experiment to see how I could potentially monetize this blog. Another experiment was posting Amazon Associate links with my <a href="/blog/categories/write-ups">write-up posts</a>; I&rsquo;ve gotten 4 clicks and 0 buys.</p>

<p>In an attempt to keep people on the site &ldquo;longer&rdquo;, I added a Related Posts section above the Comments - it makes the blog take forever to generate and has had negligible results. It turns out users are more likely to click the related tags than the related posts. I intend to remove the Related Posts section soon (it may not be there when you read this).</p>

<p>###Hello, 2015###</p>

<p>As I enter the new year, I want to be able to look back next year at a set of naïve goals and wonder why I ever thought they were practical. So here they are:</p>

<ul>
<li>Contribute meaningful code to several open source projects not created by me</li>
<li>Read at least 1 book per month</li>
<li>Attend more meetups

<ul>
<li>As a note, I am in fact <em>starting</em> a <a href="http://www.meetup.com/Indy-Golang">meetup for Google Go in Indianapolis</a> starting on January 6, 2015. This goal may actually be attainable!</li>
</ul></li>
<li>&gt;3000 sessions/month on this blog (currently ~1400)</li>
<li>Become pro at using chopsticks

<ul>
<li>I&rsquo;m already pretty good, but by the end of 2015 I will be eating pizza with chopsticks</li>
</ul></li>
<li>More effectively conceal emotions when working with peers and clients

<ul>
<li>Use this energy and passion to put the situation in my control instead</li>
</ul></li>
<li>Work remotely more and better</li>
<li>Obtain more technical leadership roles on projects

<ul>
<li>Not entirely in my control, I know, but I&rsquo;m hoping that 2015 is a year where I&rsquo;m able to demonstrate both my technical skills and proclivity to command</li>
</ul></li>
</ul>

<p>###Goodbye, 2014###</p>

<p>Thanks for reading. Have you thought about doing one of these yourself? You really should! There&rsquo;s lots of help out there if you need it - you can even reach out to me, if you like.</p>

<p>As always, may your compile times be short and your error messages meaningful.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2014-12-12-migrating-an-octopress-blog-from-github-pages-to-openshift/">
        Deploying an Octopress site to Openshift
      </a>
    </h1>

    <span class="post-date">Sun, Dec 14, 2014</span>

    <p>I&rsquo;ll detail how to take a new or existing GH Pages blog in Octopress and deploy it to OpenShift.</p>

<p>###Why?</p>

<p>I recently moved my blog from Github Pages to <a href="https://www.openshift.com/">OpenShift Online</a>. I did this because I wanted to utilize SSL with my custom domain - <a href="https://github.com/isaacs/github/issues/156">a feature not currently available on Github Pages</a> (it&rsquo;s <sup>12</sup>&frasl;<sub>14</sub>/2014 - let me know when this becomes possible!). OpenShift supports SSL with a free account, so I decided to make the switch. I wanted to use the existing architecture set up by <a href="https://github.com/imathis/octopress">Octopress</a> that built my GH Pages blog. Hopefully you see a little lock icon in your address bar if you&rsquo;re reading this from <a href="/">the site</a>.</p>

<p>###<a name="step0"></a>Step 0: Create an OpenShift account</p>

<p>Here&rsquo;s the link: <a href="https://www.openshift.com/app/account/new">https://www.openshift.com/app/account/new</a>. They&rsquo;re serious about the first and second options being free. The difference is signing up for the second option requires credit card information to give you the possibility of scaling your application. The second option is what allows you to add certs for doing SSL.</p>

<p>###<a name="step1"></a>Step 1: Create a Ruby 1.9.3 application</p>

<p>Octopress still uses ruby 1.9.3; for simplicity&rsquo;s sake, so will we. Assuming you have ruby-1.9.3 installed and the rhc gem installed (gem install rhc), create a new ruby-1.9 application on OpenShift:</p>

<pre><code class="language-bash">$ rhc app create octopress ruby-1.9
</code></pre>

<p>replacing &ldquo;octopress&rdquo; with your desired application name. I&rsquo;ve found this action takes some time, usually over a minute, while OpenShift allocates resources. When your application has been created, you should see an <code>ssh://</code> URL for your git repository on OpenShift. Make sure you can get access to this later.</p>

<p>If you&rsquo;re using a custom domain, now is as good a time as any to set it up. OpenShift has <a href="https://blog.openshift.com/custom-url-names-for-your-paas-applications-host-forwarding-and-cnames-the-openshift-way/">its own docs</a> to cover this topic.</p>

<p>###<a name="step2"></a>Step 2: Merge in &ldquo;Octoshift&rdquo;</p>

<p>I&rsquo;ve made some updates to the octopress repo that I haven&rsquo;t requested be pulled into the master branch yet. I&rsquo;ll update this section in the future if necessary.</p>

<p>If you&rsquo;re new to Octopress, clone from the master branch:</p>

<pre><code class="language-bash">$ git clone git@github.com:imathis/octopress.git
</code></pre>

<p>Either way, <code>cd</code> into your octopress directory and merge in my fork:</p>

<pre><code class="language-bash">$ git remote add octoshift git@github.com:larryprice/octopress.git
$ git pull octoshift master
</code></pre>

<p>###<a name="step3"></a>Step 3: Set up deployment</p>

<p>There is a rake task for setting up an OpenShift deployment called <code>setup_openshift</code>. This rake task clobbers the <code>_deploy</code> directory and reinitializes it using the URL for your OpenShift repository, which we committed to memory in <a href="#step1">Step 1</a>.</p>

<pre><code class="language-bash">$ rake setup_openshift[&quot;ssh://548e1873e0b8cddccf000094@octopress-username.rhcloud.com/~/git/octopress.git/&quot;]
rm -rf _deploy
mkdir -p _deploy/public
cd _deploy
Initialized empty Git repository in /home/lrp/Projects/2014/octopress/_deploy/.git/
remote: Counting objects: 21, done.
remote: Compressing objects: 100% (14/14), done.
remote: Total 21 (delta 2), reused 21 (delta 2)
Unpacking objects: 100% (21/21), done.
From ssh://octopress-username.rhcloud.com/~/git/octopress
 * branch            master     -&gt; FETCH_HEAD
 * [new branch]      master     -&gt; origin/master
cd -
cp config.ru _deploy/
cd _deploy
[master 5204046] Octopress init
 3 files changed, 27 insertions(+), 295 deletions(-)
 create mode 100644 Gemfile
 rewrite config.ru (99%)
 create mode 100644 public/index.html
cd -

---
## Now you can deploy to ssh://548e1873e0b8cddccf000094@octopress-username.rhcloud.com/~/git/octopress.git/ with `rake deploy` or `rake openshift` ##
</code></pre>

<p>###<a name="step35"></a>Step 3.5 Set up forcing SSL</p>

<p>Do you already have SSL for your domain? Bully for you! I&rsquo;ve included an option to <code>setup_openshift</code> to force traffic to use <code>https</code> in a production environment. Just send a second parameter to rake and it&rsquo;ll do the rest.</p>

<pre><code class="language-bash">$ rake setup_openshift[&quot;ssh://548e1873e0b8cddccf000094@octopress-username.rhcloud.com/~/git/octopress.git/&quot;,true]
</code></pre>

<p>Note that you will still need to change your URL in <code>_config.yml</code> if you are using a custom domain.</p>

<p>###<a name="step4"></a>Step 4: Deploy</p>

<p>Now we can just run the <code>openshift</code> or <code>deploy</code> rake tasks to deploy our app to OpenShift. This task verifies we have the latest version of our OpenShift <code>master</code> branch, installs missing gems, copies over your <code>public</code> folder, and pushes the application to OpenShift.</p>

<pre><code class="language-bash">$ rake deploy
## Deploying branch to OpenShift
## Pulling any updates from OpenShift
cd _deploy
From ssh://octopress-username.rhcloud.com/~/git/octopress
 * branch            master     -&gt; FETCH_HEAD
Already up-to-date.
Fetching gem metadata from https://rubygems.org/...........
Resolving dependencies...
Using rack (1.5.2) 
Using rack-protection (1.5.3) 
Using tilt (1.4.1) 
Using sinatra (1.4.5) 
Using bundler (1.3.5) 
Your bundle is complete!
Use `bundle show [gemname]` to see where a bundled gem is installed.
cd -
cd _deploy

## Committing: Site updated at 2014-12-14 23:13:54 UTC
[master b17225e] Site updated at 2014-12-14 23:13:54 UTC
 1 file changed, 17 insertions(+)
 create mode 100644 Gemfile.lock

## Pushing generated _deploy website
Counting objects: 9, done.
Delta compression using up to 8 threads.
Compressing objects: 100% (7/7), done.
Writing objects: 100% (9/9), 1.29 KiB | 0 bytes/s, done.
Total 9 (delta 1), reused 0 (delta 0)
remote: Stopping Ruby cartridge
remote: Waiting for stop to finish
remote: Building git ref 'master', commit b17225e
remote: Building Ruby cartridge
remote: bundle install --deployment --path ./app-root/repo/vendor/bundle
remote: Fetching gem metadata from https://rubygems.org/..........
remote: Installing rack (1.5.2) 
remote: Installing rack-protection (1.5.3) 
remote: Installing tilt (1.4.1) 
remote: Installing sinatra (1.4.5) 
remote: Using bundler (1.3.5) 
remote: Your bundle is complete!
remote: It was installed into ./vendor/bundle
remote: Preparing build for deployment
remote: Deployment id is b4ef1149
remote: Activating deployment
remote: Compilation of assets is disabled or assets not detected.
remote: Starting Ruby cartridge
remote: -------------------------
remote: Git Post-Receive Result: success
remote: Activation status: success
remote: Deployment completed with status: success
To ssh://548e1873e0b8cddccf000094@octopress-username.rhcloud.com/~/git/octopress.git/
   a5071bb..b17225e  master -&gt; master

## OpenShift deploy complete
cd -
</code></pre>

<p>###Fin</p>

<p>That&rsquo;s that. Treat it as any Octopress install. I&rsquo;ll see if the owners of the octopress repository would be interested in pulling in my customizations and update this blog post as necessary.</p>

<p>As for my switch from GH Pages to OpenShift: I&rsquo;ve found OpenShift to be just as fast as the GH Pages static server, especially when combined with <a href="https://www.cloudflare.com/">Cloudflare&rsquo;s</a> CDN and optimization systems. No regrets so far. Drop me a line in the comments if you have a beef with OpenShift or know of any equivalent alternatives.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2014-12-08-millennials-and-management/">
        Millennials &amp;amp; Management
      </a>
    </h1>

    <span class="post-date">Mon, Dec 8, 2014</span>

    <p>###The Gist</p>

<p>A generation that grew up with the internet has entered the workforce, and they&rsquo;ve begun to make demands that some managers find uncomfortable. <a href="http://amzn.to/12kiG2J">Millennials &amp; Management</a> addresses some of the generational disconnects between Baby Boomers/Generation X and the fresh faces of Generation Y.</p>

<p>###My Opinion</p>

<p>The most difficult part of this book is coming to terms with the word millennial; a vague term used to describe those of us born anywhere between the early 80s and early 00s (<a href="https://en.wikipedia.org/wiki/Millennials">Wikipedia agrees</a>). The term encapsulates several distinct sets of young adults: those entering the workforce around the time the .com bubble burst; those entering the workforce post-<sup>9</sup>&frasl;<sub>11</sub>; and those still struggling to find jobs after entering the workforce in the currently receding recession. Fortunately, it does not generally include those whipper-snappers born with a cell phone in their hand.</p>

<p>From a series of surveys with millennials (1980-2000), Gen Xers (1960-1980), and Baby Boomers (1945-1960), the author finds that this generation has very different aspirations from their parents. Millennials saw their parents grow old slagging through a job they hated with the dream of a big fat pension waiting for them when they retire. Millennials were told they could achieve anything and would be rewarded for perfect attendence. Millennials want to live life to the fullest while they&rsquo;re young and when they retire. Millennials think they&rsquo;re entitled to work wherever they want whenever they want wearing whatever they want. Millennials are pretty much the reason that iPhones exist.</p>

<p>The author discusses her own company&rsquo;s struggle to fit Generation Y into company culture. Her experiences arevery relevant and highly laudable, evolving from a crotchity old boss complaining about kids and their cell phones to an approachable, flexible manager who sits in the cube area with her employees and allows for remote work when appropriate. She describes how millennials want to be happy in their work, and thus always on the lookout for greener pastures. This causes a lot of turnover for younger employees who don&rsquo;t believe they are living up to their full potential or don&rsquo;t think they are being respected.</p>

<p>There is advice in this book for managing millennials mostly revolving around being more flexible for a modern electronic world. Being a part of Gen Y myself, I was doing a lot of mental head-nodding and &ldquo;yeah, that&rsquo;s how I want to be treated&rdquo; during most chapters. However, there were a few areas where the author&rsquo;s advice is essentially to pander to millennials, which I don&rsquo;t necessarily agree with. There needs to be compromise and understanding on both sides <em>every time</em>.</p>

<p>The author also includes advice for millennials dealing with superiors and co-workers. Some of this advice is common sense and good manners, sometimes making it sound like it&rsquo;s aimed towards snot-nosed kids; but generally the advice provided is valid and good to follow. I didn&rsquo;t pick up any one-liners after reading this book, but I certainly found it helpful (and interesting) to see inside the heads of individuals with a Generation X or Boomer mindset. I think it will help me empathize with my more mature peers when discussing my career and ideas that are important in my working life.</p>

<p>###Who Would Like This</p>

<p>It&rsquo;s in the title. Millennials should be able to scrape some empathy out of this book for more mature generations, and maybe even for other millennials. Managers can also get an eye-opening view into how Generation Y thinks, especially managers having trouble relating to younger generations. Parents just don&rsquo;t understand, after all. A good, short read for both sides of the equation.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2014-12-02-ollert-6-months-later/">
        Ollert - 6 Months Later
      </a>
    </h1>

    <span class="post-date">Tue, Dec 2, 2014</span>

    <p><a href="/blog/2014/03/17/sep-startup-weekend-ollert">Nine months ago</a> I brought a team of 6 together to build a data analysis tool called <a href="https://ollertapp.com">Ollert</a>. <a href="/blog/2014/07/13/ollert-reveal-the-data-behind-your-trello-boards">A few months later</a>, I started working with <a href="//sep.com">SEP</a> to find time to make Ollert better. Where do we stand today?</p>

<p>From a traffic perspective, we&rsquo;re doing pretty well. The numbers are increasing steadily over time, as are the number of people who use the application on a near-daily basis. Although we have surpassed our modest initial goals, we would like to build up a larger audience in the coming months.</p>

<p>We&rsquo;ve had about 1800 different users visit the site for a total of over 5000 pageviews. On average, users hit about 2 pages per visit and stay with us for almost 90 seconds at a time. About half of all traffic comes from social media such as Twitter, LinkedIn, and Reddit, but we&rsquo;ve also seen some interesting traffic patterns come out of Trello, <a href="/">my blog</a>, <a href="//sep.com/labs">SEP Labs</a>, and various other blogs.</p>

<p><a href="//trello.com">Trello</a> reached out to us a few months ago to congratulate us on making such a neat application using their API. They sent us some shirts and stickers for our trouble. It was an extremely satisfying moment.</p>

<p>On the technical side of things, we&rsquo;ve made several changes to the application.</p>

<p>We removed the concept of &ldquo;signing up&rdquo; for Ollert, as it was the greatest cause of confusion on the site. I replaced it with a mechanism that &ldquo;automatically&rdquo; signs a user up when they connect to a Trello account using OAuth. This makes our lives easier because we don&rsquo;t have to store passwords, and the lives of users easier because they don&rsquo;t have to come up with and remember another password.</p>

<p>Every aspect of the site has been made faster. Server requests have been made faster by switching to unicorn and utilizing the &ldquo;workers&rdquo; feature. Trello API call times have been slashed - Board fetch time dropped from 1.8s to .18s, Label chart 17.6s down to .426s, WIP chart 18.2s to .221s, CFD 15s to 1s.</p>

<p>We added two highly-requested charts - the Burn Down and Burn Up. It takes a certain type of Trello board to make these useful, and I&rsquo;m looking forward to finding someone one day who&rsquo;s able to make good use of them.</p>

<p>We also improved the look of all pages (most notably the home page) with some help from SEP&rsquo;s UX team.</p>

<p>Oh, and now it works significantly better on mobile.</p>

<p>What does the future hold for Ollert?</p>

<p>In the short term I&rsquo;m looking to implement a Cycle Time chart and add in a baseline for the Burndown chart. Long-term is a little less clear, but we may have a sizable announcement soon.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2014-10-31-remote-office-not-required/">
        Remote: Office Not Required
      </a>
    </h1>

    <span class="post-date">Fri, Oct 31, 2014</span>

    <blockquote>
<p>The city is the original talent hub. Traditionally, those who ran the engines of capitalism thought: &ldquo;Let&rsquo;s gather a large numberof people in a small grographical are where they must live on top of each other in tight quarters, and we&rsquo;ll be able to find plenty of able bodies to man our factories.&rdquo; Most splendid, Sir Moneybags!</p>

<p>From the section titled &ldquo;End of city monopoly&rdquo;</p>
</blockquote>

<p>###The Gist</p>

<p><a href="http://www.amazon.com/gp/product/0804137501/ref=as_li_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=0804137501&amp;linkCode=as2&amp;tag=larpriandthee-20&amp;linkId=6RSEPWJB4VV7ZUGR"><strong>Remote</strong></a> by Jason Fried and David Hansson of <a href="https://basecamp.com/">BaseCamp</a> (formerly 37signals), similarly to previous entry <a href="http://www.amazon.com/gp/product/0307463745/ref=as_li_qf_sp_asin_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=0307463745&amp;linkCode=as2&amp;tag=larpriandthee-20"><strong>Rework</strong></a>, is a book that will surely resonate with most working Americans who despise commuting and the constant distraction of the modern office. <strong>Remote</strong> discusses the pros and cons of working remotely, with a bias towards the positive aspects.</p>

<p>###My Opinion</p>

<p>I read this book in a day. I don&rsquo;t mean a Saturday or a holiday of some kind (although it was Halloween, I suppose). I mean I read part of it in the morning, drove to the office, returned home in the afternoon, and finished it before dark. I love the authors&rsquo; down-to-earth tone and I love the idea of telecommuting. There&rsquo;s also lots of pictures. Yea, pictures!</p>

<p>Remote work is not a new concept, but the number of people choosing to telecommute has begun to dramatically increase. This is mostly because we all work with a digital wall in front of us all day called a computer, and many jobs don&rsquo;t require direct contact with human beings the entire work-day. America seems to be coming to terms with the fact that our current corporate system is broken: the offices of 2014 are not the offices of the 1960s, but we still live in a world of endless meetings and sprawling cube farms.</p>

<p>Telecommuting opens up a world of possibilities. Obviously, a company offering remote positions will gain the opportunity to hire new talent from other cities, states, or even countries. Less obviously, current employees can be given the chance to be free from the shackles of a single office buildling in a single city. Instead of a company&rsquo;s top talent leaving the company to go live in New Orleans instead of Chicago, the employee can choose to live wherever she wants and telecommute, keeping all the training and knowledge gained inside the company.</p>

<p>Co-working spaces are becoming much more prevalant in major cities across the US, and are a great home office replacement for those without a spare room. If you haven&rsquo;t visited a local co-working space, I suggest you go visit one! Someone will gladly let you in for a tour and you can see what all the fuss is about. If you&rsquo;re not into paying for an open-space membership, there are always coffee shops and libraries that are happy to house you on a daily basis.</p>

<p>The biggest downside to remote work seems to be in isolation: socializing becomes more of a hobby than a requirement. There may be chats, emails, and the occasional phone call to respond to throughout the day, but none of those can make up for face-time with other humans. Some individuals will have families to socialize with, but you can&rsquo;t put all the burden on the people you love. Hobbies, meetups, and conferences would likely become much more important from a social perspective to an individual working remotely.</p>

<p>###Who Would Like This</p>

<p>The modern workforce will eat this up. There is no way that millenials will put up with the archaic concept of 9-5 in the office. They (I suppose <em>we</em>, though sometimes it pains me to admit it) never take the status quo as a satisfactory answer.</p>

<p>I think that the blanket term &ldquo;manager&rdquo; would benefit from reading this book, but may be disgruntled by what they find inside. Handling people is not easy, and handling them remotely seems like an unsettling concept.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2014-10-29-the-epic-battle-between-estimates-and-getting-work-done/">
        My Battle With Hour-Based Estimation
      </a>
    </h1>

    <span class="post-date">Wed, Oct 29, 2014</span>

    <p>I despise estimating in hours. Hours are too granular. Hours are too difficult to distinguish from hours on a clock (<em>they&rsquo;re even spelled the same</em>).</p>

<p>In any project where we work in hours, we always desparately task out stories in hours fill our capacity. <em>Which is also measured in hours</em>. We take people&rsquo;s days off and we estimate that developers spend about <sup>3</sup>&frasl;<sub>4</sub> of the day watching Youtube videos and reading Hacker News. So a developer works <strong>about 6 clock hours</strong> in a given day.</p>

<p>Then we start tasking out stories. We estimate that this task will take <strong>about 12 hours</strong>, this one <strong>about 8 hours</strong>, and we&rsquo;ll top it all off with a task of <strong>about 4 hours</strong> for ad-hoc testing. All in all, this story is estimated to take <strong>exactly 24 hours</strong>.</p>

<p>Now we do some math. Obviously, since a developer can get <strong>6 hours</strong> of work done in a day and this story will take <strong>24 hours</strong>, the story will be done in <strong>exactly 4 development days</strong>, or <strong>exactly 3 real days</strong>. We watch our capacity (in hours) fill by 24 and note all the space that&rsquo;s left.</p>

<p>Someone without reference to our developer-day-to-work-day comparison walks by. Excellent, it&rsquo;ll be done in three days, you say? That fits the schedule perfectly, tell the client we&rsquo;ll be done with that feature by Thursday. Let&rsquo;s add some more to your backlog&hellip;</p>

<p>For all we know, this estimate may work out. However, from my experience, the 8 hour task and 12 hour task will probably spend about the same amount of time in development, taking anywhere from 1-3 days each. Fortunately, the &ldquo;testing&rdquo; task will only take about 30 minutes.</p>

<p>What&rsquo;s wrong here?</p>

<p>Humans are bad at estimating. We become much worse at estimating when we start talking about knowledge work. I happen to believe we become even worse at estimating when we try to use time as a unit of measure. How long does it take you to get to work? I would say it takes me about 5 minutes. Google Maps tells me I would be lucky to get there in 10 without traffic. My estimation in minutes is <strong>bad</strong>, conflated by the monotony of performing a menial task over and over again.</p>

<p>When we have retros, we don&rsquo;t discuss how incorrect our hourly measurements were. We have a hybrid system of estimating stories in points and tasks in hours. We discuss the discrepancy between estimated and actual story points instead, despite the disconnect between our task estimates and our story estimates. (Another reason we don&rsquo;t discuss hour estimations at the retro is that it would take <strong>forever</strong> due to the high number of tasks and the granularity of hours (did this take one day or two, I can&rsquo;t remember)).</p>

<p>Do I have a solution to this problem? Of course I do. Don&rsquo;t use hours. Stick with points, and keep them as vague and hand-wavey as possible.</p>

<p>We often run into an issue of associating points with number of hours or days. &ldquo;Well, a 3 takes us about a week and a 5 takes us about 2 weeks. This story seems like it&rsquo;ll take about a week.&rdquo;</p>

<p>Points <strong>do not</strong> translate directly to how long a story will take. Points <strong>do</strong> translate to how much work a story feels like relative to the stories which have come before it.</p>

<p>Eventually, you should have a big enough pile of 1s, 2s, 3s, and 5s that you can relate a new story to a previous story. This story feels like a 3, about as much work as that story where we had to herd those cats. This story feels like a 1, technically all I have to do is flip this boolean&hellip;</p>

<p>When starting a project, estimate stories but don&rsquo;t try to estimate a capacity. Just see how many points you can get done in a sprint. Do it again for the second sprint. Keep doing it until your numbers balance out. This means that your estimates are becoming consistent and you&rsquo;re getting over the new project hump. Now you can tell your manager that you should be able to get 20 points done in a sprint, because you&rsquo;ve consistently bounced around that number the past few sprints.</p>

<p>Don&rsquo;t get too hasty and start telling people that you should be able to do more points with each sprint. I hate to break it to you, but you&rsquo;re not getting that much better each sprint. You need to adjust your point estimation to match your current competency level.</p>

<p>End rant. It&rsquo;ll probably be a long time before we see the death of hourly estimations, especially with big-name tools like Rally and Visual Studio Online containing fields explicitly for that purpose. Just fight the good fight for now.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2014-10-28-to-system-test-or-not-to-system-test/">
        To System Test or Not to System Test
      </a>
    </h1>

    <span class="post-date">Tue, Oct 28, 2014</span>

    <p>System tests: a boon to product verification, but also time taken away from raw development. System-level testing means bringing up the whole system and running through a set of steps to verify that the system is working properly on all levels.</p>

<p>We have lots of system tests on our project, some that check for the existence of UI elements, and some that verify that a user can go through the entire e-commerce process. Some of the tests require network access, so they take up to 3 or 4 minutes. I had gotten used to writing system tests with <a href="https://www.ruby-lang.org/en/">ruby</a> and <a href="https://github.com/jnicklas/capybara">capybara</a>, which I&rsquo;ve always found straightforward and easy to write. But this current project is in ASP.NET MVC, which seems to have greatly complicated bringing up and automatically manipulating the system. Our current test suite takes over an hour to run and results in at least 10 consistently-failing tests (referred to as &ldquo;flaky&rdquo; for dignity&rsquo;s sake).</p>

<p>Because of this, there has been talk about getting rid of the system tests.</p>

<p>Getting rid of system tests? Doesn&rsquo;t this go against everything we believe in? Think of TDD! Think of the children! Think of acceptance criteria! Won&rsquo;t somebody think of the children!</p>

<p>So I&rsquo;ve been thinking: what is the purpose of system tests? The first thing that comes to mind is the obvious: to test the full stack. Often components work well individually but throw tantrums when forced to interact with the rest of the system.</p>

<p>Another obvious answer: system health. If the system tests are passing, then surely the site still works after my push! You did add a system test for that changeset, right?</p>

<p>I&rsquo;m not satisfied with those answers. Those are great <em>side effects</em> to writing system tests, but they aren&rsquo;t <em>sustainable</em> reasons. For their own devious reasons, someone can always delete a system test that would have broken with your code change. You can always write your system test steps poorly, resulting in incorrect (though passing) behavior.</p>

<p>The best reason for writing system tests is <strong>to find out what you&rsquo;ve accomplished</strong>.</p>

<p>Sometimes when I finish coding a new feature, I ask myself &ldquo;MY GOD WHAT HAVE I DONE.&rdquo; There are unit tests in place, and they have great names like <code>SetsIsValidToTrue</code> and <code>ReturnsSomethingThatsNotNull</code> and <code>DoesntCrashTheSystem</code>, but they fail to tell me what just happened. So I switch context to the system tests. In writing a system test, I bring up the whole system, run through my Happy Path™ and my edge cases, and <strong>I can see precisely what I&rsquo;ve done</strong>. I can watch my work succeed or fail. I can see when it takes way too many complicated page clicks to perform a task. I can see that when I click something too quickly the page fails to load. I can see that the URL is just plain <em>weird</em>. Most importantly, I can sit back and <strong>see</strong> it happening.</p>

<p>So I push my system test to the build server and it works fine until a few dozen other changesets go through on the same page and eventually the system test becomes flaky.</p>

<p>Where did we go wrong?</p>

<p>I have an idea on how to deal with this, but you&rsquo;re probably not going to like it.</p>

<p>As soon as I push a system test, it becomes legacy. You are no longer allowed to edit this system test. If you are updating that feature, you are responsible to <em>delete</em> and potentially <em>rewrite</em> each relevant test. In doing this, you are now required to think about the way the whole system fits together every time you push a feature. System tests will become a picture frozen in time of the way the feature worked the last time it was worked on. System tests will no longer be <em>a rolling history of what the system did</em>, but <em>an exact specification of what the system does</em>. They become a piece of the development process to demonstrate the intended functionality of the feature.</p>

<p>In following this practice, we technically lose out on reusable system test code. I say good riddance, as testing code is the quickest part of any system to become bloated and convoluted. The loss in test creation speed could be worth the gain in developer knowledge of the intricacies of the system.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2014-10-14-the-wisdom-of-confucius-now-available-in-an-api/">
        The wisdom of Confucius - now available in an API
      </a>
    </h1>

    <span class="post-date">Tue, Oct 14, 2014</span>

    <p>I make a lot of silly things while learning new technology. In this case I have tapped into the almighty power of <a href="https://en.wikipedia.org/wiki/Confucius">Confucius</a>, a Chinese philosopher from 2500 years ago credited for writing or editing many Chinese classic texts. Growing up as an American child, I associated Confucius with proverbs, and I associated proverbs with that classic after-Chinese-dinner dessert <a href="https://en.wikipedia.org/wiki/Fortune_cookie">the fortune cookie</a>.</p>

<p>Fortune cookies are a pure delight: a message in a bottle from the restaurant&rsquo;s proprietors for you to enjoy as you kindly vacate the facility.</p>

<p>Most fortune cookies that I&rsquo;ve opened recently have three parts: a fortune (generally a proverb), a lesson in simplified Chinese, and a lottery number. So many secrets wrapped up in such a small, golden treasure.</p>

<p>Ever left a Chinese restaurant, gotten in your car, and felt the need to break something only to realize you left your precious fortune cookie on the table? I have built a solution.</p>

<p><a href="http://fortunecookieapi.com/">The Fortune Cookie API</a> is a simple, RESTful API built to generate fortune cookie data. The root URL shows documentation built using <a href="https://apiary.io/">Apiary.io</a>.</p>

<p>How does it work? I need fortunes now!</p>

<p>There are options. You can get <code>fortunes</code> from the <a href="http://fortunecookieapi.com/v1/fortunes">/v1/fortunes</a> endpoint, <code>lessons</code> from the <a href="http://fortunecookieapi.com/v1/lessons">/v1/lessons</a> endpoint, and lottery numbers from the <a href="http://fortunecookieapi.com/v1/lottos">/v1/lottos</a> endpoint. By default you get 100 of any model, but all endpoints include a <code>limit</code> (max 1000), <code>skip</code>, and <code>page</code> parameter to facilitate getting all the lessons and fortunes. For lottery numbers, we approximately build <a href="https://en.wikipedia.org/wiki/Powerball">Powerball</a> numbers except we currently ignore the rule for red balls, which means there are something ike 42 billion different possibilities. Due to the high number of potential lottery numbers, the <code>lottos</code> endpoint also includes a <code>firstId</code> parameter that lets you start from anywhere.</p>

<p>But there&rsquo;s no need to get the individual models (unless you&rsquo;re into that kind of thing)! I also created a <a href="http://fortunecookieapi.com/v1/cookie">/v1/cookie</a> endpoint to retrieve a random fortune, lesson, and lottery number as a single object. Woohoo! You can specify the number of cookies (max 100) with the <code>limit</code> parameter.</p>

<pre><code>GET http://fortunecookieapi.com/v1/cookie

{
  &quot;fortune&quot;: {
    &quot;id&quot;: &quot;53ffcf1d4ea4f76d1b8f223e&quot;,
    &quot;message&quot;: &quot;This fortune intentionally left blank&quot;
  },
  &quot;lotto&quot;: {
    &quot;id&quot;: &quot;001000200030004000500006&quot;,
    &quot;numbers&quot;: [10,20,30,40,50,6]
  },
  &quot;lesson&quot;: {
    &quot;id&quot;: &quot;53ffcf1d4ea4f76d1b8f2241&quot;,
    &quot;chinese&quot;: &quot;因特网&quot;,
    &quot;pronunciation&quot;: &quot;yintewang&quot;,
    &quot;english&quot;: &quot;internet&quot;
  }
}
</code></pre>

<p>Now you can fill that hole in your heart where the fortune cookies are missing. If you&rsquo;re interested in the code, you can <a href="https://github.com/larryprice/fortune-cookie-api">check it out on Github</a>.</p>

<p>UPDATE: I&rsquo;ve registered the domain <a href="http://fortunecookieapi.com">fortunecookieapi.com</a> for the love of fortune cookies. Enjoy.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2014-09-15-fetching-random-mongoose-objects-the-simple-way/">
        Fetching Random Mongoose Objects the Simple Way
      </a>
    </h1>

    <span class="post-date">Mon, Sep 15, 2014</span>

    <p>As I venture through the land of <a href="http://nodejs.org/">NodeJS</a>, I&rsquo;ve found the wonder and magic of <a href="http://npmjs.org/">NPM</a>, a package management tool for Javscript similar to <a href="https://www.ruby-lang.org/">ruby</a>&rsquo;s gems. Although there are nearly 100,000 packages on the main npmjs site (94,553 at time-of-writing), it seems there are still niches to be filled.</p>

<p>Recently, while working on a <strong>top secret side-project</strong>, I wanted to grab a random object from a <a href="https://www.mongodb.org/">MongoDB</a> collection. I used the highly-extensible <a href="http://mongoosejs.com/">mongoose</a> to set up my models and just needed to find a package somewhere with the desired functionality. I found such a package called <a href="https://github.com/matomesc/mongoose-random">mongoose-random</a>, but, unfortunately, I was never able to get this plugin to work correctly. The plugin in question also needed to insert new columns on your tables, which I didn&rsquo;t really want. So I decided to create a new package.</p>

<p><a href="https://www.npmjs.org/package/mongoose-simple-random">mongoose-simple-random</a> is an incredibly easy way to include a random accessor on your mongoose models. All that&rsquo;s required is adding the plugin to the schema before compiling the model:</p>

<p>``` javascript test.js
var random = require(&lsquo;mongoose-simple-random&rsquo;);</p>

<p>var s = new Schema({
  message: String
});
s.plugin(random);</p>

<p>Test = mongoose.model(&lsquo;Test&rsquo;, s);</p>

<pre><code>
Now I can ask the model for a single random element of the `Test` model with a single call to `findOneRandom`:

``` javascript find_one.js
var Test = require('./test');

Test.findOneRandom(function(err, element) {
  if (err) console.log(err);
  else console.log(element);
});
</code></pre>

<p>Need to find more than one? Use <code>findRandom</code> to get an array:</p>

<p>``` javascript find_five.js
var Test = require(&lsquo;./test&rsquo;);</p>

<p>Test.findRandom({}, {}, {count: 5}, function(err, results) {
  if (err) console.log(err);
  else console.log(results);
});</p>

<pre><code>
Zowee! Just like the default `find` methods, you can pass in optional filters, fields, and options:

``` javascript find_five_with_optionals.js
var Test = require('./test');

var filter = { type: { $in: ['education', 'engineering'] } };
var fields = { name: 1, description: 0 };
var options = { skip: 10, limit: 10, count: 5 };
Test.findRandom(filter, fields, options, function(err, results) {
  if (err) console.log(err);
  else console.log(results);
});
</code></pre>

<p>Given 1000s of objects, performance is excellent. I haven&rsquo;t tested it on larger-scale databases, but I wouldn&rsquo;t mind seeing some performance tests in the future.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2014-08-31-the-honest-truth-about-dishonesty/">
        The (Honest) Truth About Dishonesty
      </a>
    </h1>

    <span class="post-date">Sun, Aug 31, 2014</span>

    <p>###The Idea</p>

<p>Everyone lies. Everyone cheats. From Marcy down the street cheating on her diet to Bernie Madoff committing massive finanical fraud, we&rsquo;re all a little dishonest from time to time. With the power of experimentats and research, Dan Ariely seeks to learn what leads humans to act dishonestly in <em><a href="http://amzn.to/1qsOgTy">The (Honest) Truth About Dishonesty</a></em>.</p>

<p>###The Gooey Center</p>

<p>Since reading <em><a href="http://amzn.to/VYzVTZ">Predictably Irrational</a></em> earlier this year, I&rsquo;ve really liked reading Dan Ariely; his writing style is familiar yet authoritative, making for highly readable books filled with high-quality experiments and meaningful insights. <em>The (Honest) Truth About Dishonesty</em> is a similar read to <em>Predictably Irrational</em>, but with a tight focus on what drives the common man to lie and cheat.</p>

<p>The main takeaway is, given the chance, most people will cheat just a little given the opportunity. Ariely&rsquo;s experiments found that very few people cheated heavily, even in situations where the likelihood of being caught is minimal. Rounding up your billable hours on a timesheet is easy to do without a shred of guilt, and the likelihood of getting caught is approximately nil. On the other hand, fudging an hour or two in a single day is not something anyone I know would take lightly. Unfortunately, if you round up billable hours by 10 minutes a day for a whole week, you&rsquo;ve fudged nearly an hour of billable work (without the guilt).</p>

<p>Day-to-day living makes us less honest. If you&rsquo;ve had a long day at work, you&rsquo;re more likely to cheat on your diet when you get home because your defenses have been torn down. You&rsquo;re more likely to put things off in favor of sitting around watching television.</p>

<p>Ariely finds that collaboration also leads to more dishonesty: as humans, we are more willing to bend the rules if it will benefit someone else, especially if we have befriended that someone else.</p>

<p>###Who Would Like This</p>

<p>Those interested in behavioral economics should get a kick out of this book, especially if they enjoyed Ariely&rsquo;s other works. Reading this book can also make you think more critically about some of the &ldquo;little white lies&rdquo; you tell yourself and others throught the day.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2014-08-22-fixing-some-minor-bugs-in-trellos-client-dot-js/">
        Hotfixing a Bug in Trello&#39;s client.js
      </a>
    </h1>

    <span class="post-date">Fri, Aug 22, 2014</span>

    <p>I&rsquo;m a huge fan of <a href="https://trello.com">Trello</a>, and I recently created an app to analyze Trello data called <a href="https://ollertapp.com">Ollert</a>. Ollert makes heavy use of the <a href="http://trello.com/docs">Trello API</a>. I&rsquo;ve written previously about <a href="/blog/2014/03/18/connecting-to-the-trello-api/">using Trello&rsquo;s client.js to connect to the Trello API</a>.</p>

<p>During some ad-hoc testing of opening/closing the Trello authorization popup, I found that clicking &ldquo;Deny&rdquo; on the popup, reopening it, and then clicking &ldquo;Connect&rdquo; resulted in me not being able to connect. I spent some time looking into workarounds and I even contacted Trello support. After studying <a href="https://trello.com/1/client.coffee">client.coffee</a>, I eventually found the problem: the Trello client keeps around an anonymous object called <code>ready</code> that stores some session data. When a user clicks &lsquo;Deny&rsquo;, this <code>ready</code> object remembers. I was able to fix the Deny/Allow issue by pulling down a local copy of client.js and making an interface change to the module:</p>

<p>``` javascript client.js
clearReady: function() {
  ready = {}
}</p>

<pre><code>
From [another issue I was having](/blog/2014/07/07/deauthorizing-token-with-the-trello-client/), I already call `Trello.deauthorize()` before my application attempts to contact Trello, so now I also make a call to `Trello.clearReady()`. My `authorize()` function looks like this:

``` javascript trello-controller.js
var authorize = function (expires, callback) {
  Trello.deauthorize();
  Trello.clearReady();

  Trello.authorize({
    name: &quot;Ollert&quot;,
    type: &quot;popup&quot;,
    interactive: true,
    expiration: expires,
    persist: false,
    success: callback,
    scope: {
      read: true,
      write: true
    }
  });
}
</code></pre>

<p>Since I&rsquo;ve pulled client.js locally, I&rsquo;m no longer sending my developer token when I load the file. I manually set my key when the page loads, but this could just as easily be done in my <code>authorize</code> method above.</p>

<p><code>javascript layout.haml
:javascript
  $(document).ready(function() {
    Trello.setKey(&quot;#{ENV['PUBLIC_KEY']}&quot;)
  });
</code></p>

<p>You can find a copy of my modified client.js <a href="https://gist.github.com/larryprice/1e67ddcd53c686fbc1de">in this Gist</a>.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2014-08-07-testing-through-the-trello-api-with-capybara-and-webkit/">
        Testing through a Trello connection with Capybara and Webkit
      </a>
    </h1>

    <span class="post-date">Thu, Aug 7, 2014</span>

    <p>During the hardening of <a href="https://ollertapp.com">Ollert</a>, a Trello data analysis tool I wrote, I started writing acceptance tests. I quickly ran into an issue where the meat of my application requires opening pop-up window, signing into Trello, and allowing my application access.</p>

<p>I created a test user on Trello with a few varied boards to allow for proper testing. In doing this, I store the user&rsquo;s login information in my .env file. For the most part, I can use the steps provided in <a href="https://gist.github.com/larryprice/546d6c029bb3074bd84c">this common web_steps.rb</a>.</p>

<p>``` cucumber Connecting.feature
Feature: Landing</p>

<p>Background:
  Given I am on the landing page</p>

<p>@javascript
Scenario: Deny connecting to Trello
  Given I follow &ldquo;Connect to Get Started&rdquo;
  And I press &ldquo;Deny&rdquo; on the Trello popup
  Then I should be on the landing page</p>

<p>@javascript
Scenario: Allow connecting to Trello
  Given I follow &ldquo;Connect to Get Started&rdquo;
  When I authorize with Trello as the test user
  Then I should not see &ldquo;Connecting&hellip;&rdquo;
  And I should not see &ldquo;Redirecting&hellip;&rdquo;
  And I should be on the boards page</p>

<pre><code>
When the Trello popup appears, we have to specify the window we're going to use. Since I'm using [capybara-webkit](https://github.com/thoughtbot/capybara-webkit), I'm going to go ahead and do all of my Trello popup activities in one step, which saves me from writing a lot of unnecessary steps.

``` ruby trello_popup_steps.rb
When /^I press &quot;(.*?)&quot; on the Trello popup$/ do |button|
  trello_popup = windows.last
  page.within_window trello_popup do
    click_button button
  end
end

When /^I authorize with Trello as the test user$/ do
  trello_popup = windows.last
  page.within_window trello_popup do
    click_link &quot;Log in&quot;

    fill_in &quot;user&quot;, with: ENV['TEST_USER_TRELLO_USERNAME']
    fill_in &quot;password&quot;, with: ENV['TEST_USER_TRELLO_PASSWORD']
    
    click_button &quot;Log In&quot;
    click_button &quot;Allow&quot;
  end
end
</code></pre>

<p>Straightforward so far. We grab the window handle and we click links, fill in fields, and press buttons within that window.</p>

<p>Note that I&rsquo;m using capybara-webkit, a headless web driver, to run my Javascript. Although the first test (&ldquo;Deny&rdquo;) will pass, the &ldquo;Allow&rdquo; test fails ambiguously. This is because capybara-webkit is not recognized as a supported browser by the Trello popup.</p>

<p>Anecdotally, I contacted Trello support about this and received the following response:</p>

<blockquote>
<p>Currently it is not possible to test this with a headless browser as you are looking to do without getting the unsupported browser message.</p>
</blockquote>

<p>So I guess we should just give up, right? &hellip;Or we could manipulate the headers we send to load the Trello popup such that Trello <em>thinks</em> we are Google Chromium.</p>

<p>``` cucumber trello_popup_steps.rb
When /^I authorize with Trello as the test user$/ do
  trello_popup = windows.last
  page.within_window trello_popup do
    page.driver.header(
      &ldquo;User-Agent&rdquo;,
      &ldquo;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ubuntu Chromium/34.0.1847.116 Chrome/34.0.1847.116 Safari/537.36&rdquo;
    )</p>

<pre><code>click_link &quot;Log in&quot;

fill_in &quot;user&quot;, with: ENV['TEST_USER_TRELLO_USERNAME']
fill_in &quot;password&quot;, with: ENV['TEST_USER_TRELLO_PASSWORD']

click_button &quot;Log In&quot;
click_button &quot;Allow&quot;
</code></pre>

<p>end
end</p>

<pre><code>
Fantastic. Now my tests pass. I can't sleep at night, but my tests pass.

Unfortunately, that won't be the case if I add more tests to this `.feature` file. Hidden somewhere deep in the browser's cache or cookies or somethings, Trello is remembering that we logged in sometimes. Sometimes it even remembers that someone else has logged in. The UI of the Trello popup changes based on whether it thinks you've already logged in. In order to keep things consistent, I like to add an if-statement to take care of this case.

``` cucumber trello_popup_steps.rb
When /^I authorize with Trello as the test user$/ do
  trello_popup = windows.last
  page.within_window trello_popup do
    page.driver.header(
      &quot;User-Agent&quot;,
      &quot;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ubuntu Chromium/34.0.1847.116 Chrome/34.0.1847.116 Safari/537.36&quot;
    )

    if page.has_content? &quot;Switch Accounts&quot;
      click_link &quot;Switch Accounts&quot;
    else
      click_link &quot;Log in&quot;
    end

    fill_in &quot;user&quot;, with: ENV['TEST_USER_TRELLO_USERNAME']
    fill_in &quot;password&quot;, with: ENV['TEST_USER_TRELLO_PASSWORD']
    
    click_button &quot;Log In&quot;
    click_button &quot;Allow&quot;
  end
end
</code></pre>

<p>Edge cases addressed. Now I can make connections to Trello and test my application. Be warned, I&rsquo;ve already had these tests break once when Trello updated the UI behind the Trello popup. If Trello ever stops supporting Chromium 34.0, these tests are also likely to stop working. These tests are most useful during development, when we have the potential to break the Trello connection ourselves, and so I think they are well worth the pain of potential future maintenance.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2014-08-05-javascript-testing-with-capybara-and-cucumber/">
        Javascript testing with Capybara and Cucumber
      </a>
    </h1>

    <span class="post-date">Tue, Aug 5, 2014</span>

    

<p>In the past, I had written off testing the Javascript in my <a href="http://www.sinatrarb.com/">Sinatra</a> apps as being not worth the pain of setting up. That was pretty naïve of me, as setting up web drivers in <a href="https://github.com/jnicklas/capybara">Capybara</a> is actually pretty easy.</p>

<p>For this post, I assume you already have a capybara-cucumber project set up. If you need help setting up your first tests, consider checking out <a href="/blog/categories/capybara/">some of my other blog posts</a> on the subject.</p>

<p>####Selenium</p>

<p>Selenium is the default Javascript driver for capybara. To install either run <code>gem install selenium-webdriver</code> or toss <code>selenium-webdriver</code> into your <code>Gemfile</code> and run <code>bundle install</code>.</p>

<p>If you want to run all of your tests with Javascript enabled, you can change the default driver in your <code>env.rb</code> file. For example:</p>

<p>``` ruby env.rb
ENV[&lsquo;RACK_ENV&rsquo;] = &lsquo;test&rsquo;</p>

<p>require_relative &lsquo;../../../web&rsquo;</p>

<p>require &lsquo;selenium-webdriver&rsquo;
require &lsquo;capybara/cucumber&rsquo;
require &lsquo;rspec&rsquo;</p>

<p>Capybara.app = Ollert
Capybara.default_wait_time = 10</p>

<h1 id="run-all-tests-using-javascript:d5ab1fc6ad4c6740d71e80746a960e70">run all tests using Javascript</h1>

<p>Capybara.default_driver = :selenium</p>

<p>World do
  Ollert.new
  Mongoid.purge!
end</p>

<pre><code>
Using Selenium means that your tests will be running using Firefox. Unfortunately, this makes them much, much slower than when you were running the tests using rspec. What I recommend is to limit yourself to only use the Javascript driver when you need to. To accomplish this, we change our `env.rb` file as such:

``` ruby env.rb
ENV['RACK_ENV'] = 'test'

require_relative '../../../web'

require 'selenium-webdriver'
require 'capybara/cucumber'
require 'rspec'

Capybara.app = Ollert
Capybara.default_wait_time = 10

# use the following web driver to run tests
Capybara.javascript_driver = :selenium

World do
  Ollert.new
  Mongoid.purge!
end
</code></pre>

<p>And add the <code>@javascript</code> tag to our Cucumber feature files. I&rsquo;ve written <a href="/blog/2013/04/15/tags-in-c-plus-plus-cucumber-tests/">about using tags in the past</a>, and they are incredibly useful. For example:</p>

<p>``` cucumber DoStuff.feature
Feature: Do Stuff</p>

<p>Scenario: Nothing happens with Javascript disbaled
  Given I visit the home page
  When I click &ldquo;Where are they?!&rdquo;
  Then I should not see &ldquo;I&rsquo;m Batman.&rdquo;</p>

<p>@javascript
Scenario: Correct text is displayed with Javascript enabled
  Given I visit the home page
  When I click &ldquo;Where are they?!&rdquo;
  Then I should see &ldquo;I&rsquo;m Batman.&rdquo;</p>

<pre><code>
Assuming there is some Javascript activated by clicking &quot;Where are they?!&quot; that displays the text &quot;I'm Batman.&quot;, both of the above scenarios will pass. This is because none of the Javascript will run in the first scenario, so the text will not be displayed. In the second scenario, Capybara knows to use the webdriver we set up previously when it sees the `@javascript` tag.

####Poltergeist

[Poltergeist](https://github.com/teampoltergeist/poltergeist) is the first &quot;headless&quot; web driver I tried. Usage is mostly identical to usage for Selenium, so I'll focus on installation here.

Poltergeist uses [PhantomJS](http://phantomjs.org/), so we need to start by downloading the binary ([32-bit](https://bitbucket.org/ariya/phantomjs/downloads/phantomjs-1.9.7-linux-i686.tar.bz2) or [64-bit](https://bitbucket.org/ariya/phantomjs/downloads/phantomjs-1.9.7-linux-x86_64.tar.bz2)) and putting it in our path. On my Linux machine, I extracted the contents of the download and copied `bin/phantomjs` to my `/usr/local/bin` directory, which I already have in my path. You can also copy it directly to `/usr/bin` if you like.

On the ruby side, we do that same old song and dance: either do `gem install poltergeist` or add `poltergeist` to your `Gemfile` and run `bundle install`. Edit your `env.rb`:

``` cucumber env.rb
ENV['RACK_ENV'] = 'test'

require_relative '../../../web'

require 'capybara/poltergeist'
require 'capybara/cucumber'
require 'rspec'

Capybara.app = Ollert
Capybara.default_wait_time = 10

# use the following web driver to run tests
Capybara.javascript_driver = :poltergeist

World do
  Ollert.new
  Mongoid.purge!
end
</code></pre>

<p>Now your Javascript tests should be running using the Poltergeist webdriver. Since Poltergeist is truly headless, your tests will run much faster than they did while using Selenium, but you won&rsquo;t be able to see what&rsquo;s going on while your tests run. There are some slight syntactic differences between the way Poltergeist and Selenium handles separate windows, but other than that they are extremely similar.</p>

<p>####Webkit</p>

<p><a href="https://github.com/thoughtbot/capybara-webkit">Capybara-webkit</a> is where I eventually landed for running my own tests, after having issues accessing other windows with Poltergeist. Capybara-webkit is also headless and relies on <code>QtWebKit</code> to render pages. So, for starters, you&rsquo;re going to have to install <code>qtwebkit</code>. This has a varied degree of difficulty depending on which operating system you&rsquo;re using, but I didn&rsquo;t have too many problems in Ubuntu once I figured out which library I needed. For help, check <a href="https://github.com/thoughtbot/capybara-webkit/wiki/Installing-Qt-and-compiling-capybara-webkit">the guide</a>. On my machine:</p>

<pre><code class="language-bash">$ sudo apt-get install libqtwebkit-dev
</code></pre>

<p>Once more: either do <code>gem install capybara-webkit</code> or add <code>capybara-webkit</code> to your <code>Gemfile</code> and run <code>bundle install</code>. Edit your <code>env.rb</code>:</p>

<p>``` cucumber env.rb
ENV[&lsquo;RACK_ENV&rsquo;] = &lsquo;test&rsquo;</p>

<p>require_relative &lsquo;../../../web&rsquo;</p>

<p>require &lsquo;capybara/cucumber&rsquo;
require &lsquo;capybara/webkit&rsquo;
require &lsquo;rspec&rsquo;</p>

<p>Capybara.app = Ollert
Capybara.default_wait_time = 10</p>

<h1 id="use-the-following-web-driver-to-run-tests:d5ab1fc6ad4c6740d71e80746a960e70">use the following web driver to run tests</h1>

<p>Capybara.javascript_driver = :webkit</p>

<p>World do
  Ollert.new
  Mongoid.purge!
end
```</p>

<p>Again, you won&rsquo;t be able to see your tests run, but they should be pretty snappy. I was able to use capybara-webkit to tackle some window issues I was having, but (as of this writing) capybara-webkit has not caught up with more modern capybara window-switching syntax. Other than that, the syntax is identical to the other drivers I&rsquo;ve discussed for common cases. If you&rsquo;re running capybara-webkit on a CI server, see <a href="http://blog.55minutes.com/2013/09/running-capybara-webkit-specs-with-jenkins-ci/">this post about using Xvfb</a>.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2014-08-02-use-nvm-to-manage-your-nodejs-install/">
        Use NVM to manage your NodeJS install
      </a>
    </h1>

    <span class="post-date">Sat, Aug 2, 2014</span>

    <p>I&rsquo;ve been trying to get into <a href="http://nodejs.org/">NodeJS</a>, and so my immediate thought is that I want to be able to install different versions for different projects, a la <a href="https://rvm.io">rvm</a> for <a href="https://ruby-lang.org">ruby</a>. Fortunately, this already exists.</p>

<p><a href="https://github.com/creationix/nvm">NVM</a> gives me the equivalent functionality of rvm but for NodeJS, making all my dreams come true. Here&rsquo;s how I installed it on my Linux boxes:</p>

<pre><code class="language-bash">$ curl https://raw.githubusercontent.com/creationix/nvm/v0.12.2/install.sh | bash
</code></pre>

<p><em>Note: This URL will get you nvm version 0.12.2. This link may not be valid in the future, where you come from. Check out the <a href="https://github.com/creationix/nvm">github repo</a> for any newer versions. If you&rsquo;re brave, trusting, or just really naïve, you can even change <code>v0.12.2</code> above to <code>master</code> to get the bleeding edge install.</em></p>

<p>The above line of code will download the files, install nvm in your home directory, and update your profile to include nvm&rsquo;s current Node version in your path. NVM autocomplete isn&rsquo;t in place by default, but we can enable it by adding the following to the end of our .bash_profile:</p>

<pre><code class="language-bash">[[ -r $NVM_DIR/bash_completion ]] &amp;&amp; . $NVM_DIR/bash_completion
</code></pre>

<p>Now it&rsquo;s time to actually install us some Node! You can use <code>nvm ls-remote</code> to list the versions of Node currently available for download. At the time of this writing, the most recent version is <strong>v0.11.13</strong>. Installing is easy (and quick):</p>

<pre><code class="language-bash">$ nvm install 0.11.13
...
$ nvm use 0.11.13
</code></pre>

<p>Since this is the only Node on my system, I&rsquo;d like to set it as the default.</p>

<pre><code class="language-bash">$ nvm alias default 0.11.13
</code></pre>

<p>What if I&rsquo;m <code>cd</code>ing out of control and I don&rsquo;t know what Node version I need in my current directory? Create a file called <code>.nvmrc</code> in the directory containing the version number you want nvm to use and then type <code>node use</code> ENTER; Now you&rsquo;re using the version of Node you meant to. This also prevents people from using the wrong versions of Node to try to run your code, which would of course be a catastrophe.</p>

<p>PLUS nvm installs the right version of npm whenever you install Node, so there&rsquo;s no need to worry about dealing with your base npm not working with different versions of Node.</p>

<p>Thank <a href="https://en.wikipedia.org/wiki/Free_and_Open_Source_Software">FOSS</a> for nvm. Maybe one day soon I&rsquo;ll do useful things in Node an tell you about them.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2014-07-13-ollert-reveal-the-data-behind-your-trello-boards/">
        Ollert - Reveal The Data Behind Your Trello Boards
      </a>
    </h1>

    <span class="post-date">Sun, Jul 13, 2014</span>

    <p>Introducing <a href="https://ollertapp.com">Ollert</a>, a tool to show you what your <a href="//trello.com">Trello</a> boards can&rsquo;t tell you on their own.</p>

<p>Trello does a great job of telling you about the here and now of your Trello boards; who&rsquo;s working on what task and what is the current state of a task. But what if I want to know about the state of the whole project? How many work items have we finished in the past sprint, iteration, or duration of the project? He who does not understand the past is destined to repeat his mistakes ad nauseum.</p>

<p>Ollert is a tool with these ideas in mind. Authorize Ollert access to your Trello account, select the board you would like to learn more about, and see all the battle scars your board has experienced throughout the duration of the project.</p>

<p>Learn about your velocity through a Cumulative Flow Diagram. View your work in progress with a WIP chart. See which labels your team uses most frequently with our label chart. See information about your cards and lists from a historical perspective.</p>

<p><a href="https://ollertapp.com/signup">Create an account</a> with Ollert to show your support. Users who sign up for an Ollert account will have their Trello authorization saved, saving the hassle of authorizing with Trello every time the user visits the site. An Ollert account is perfect for any user who views board progress frequently, or for creating a continuous display on an office monitor.</p>

<p>Since Ollert&rsquo;s initial release <a href="/blog/2014/03/17/sep-startup-weekend-ollert/">several months ago</a>, Ollert now boasts over 4000% faster load times, increased data security using SSL and encrypted cookies, and a more consistent Trello connection experience in all modern web browsers.</p>

<p>Discover Ollert now at <a href="https://ollertapp.com">ollertapp.com</a>.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2014-07-12-testing-automated-emails-with-email-spec-in-cucumber/">
        Testing automated emails with email-spec in Cucumber
      </a>
    </h1>

    <span class="post-date">Sat, Jul 12, 2014</span>

    

<p>Now that <a href="/blog/2014/07/08/sending-emails-with-pony-and-sendgrid/">I send emails using Pony</a>, I want to be able to verify that the emails are being generated correctly. I also don&rsquo;t want to send real emails and have my tests check an inbox somewhere. I found a couple of solutions to do this, including <a href="https://github.com/johnmendonca/pony-test">pony-test</a> and <a href="https://github.com/bmabey/email-spec">email-spec</a>. Although pony-test fits my needs perfectly, the last commit was December 27, 2011 (2.5 years ago at the time of this post), and thus was using an outdated version of <a href="https://github.com/jnicklas/capybara">capybara</a> which I was unwilling to use. Fortunately, pony-spec is mostly just a fork of email-spec with all the non-Pony components ripped out.</p>

<p>I&rsquo;m going to be using Cucumber to test my emails, but email-spec also boasts compatibility with rspec and Turnip. To get started:</p>

<pre><code class="language-bash">$ gem install email-spec
</code></pre>

<p>The developers of email-spec were kind enough to give us some free step definitions. If I was using rails, I could just type <code>rails generate email_spec:steps</code>, but since I&rsquo;m using Sinatra I opted just to copy-paste the file into my <code>step_definitions/</code> directory. You can find <code>email_steps.rb</code> <a href="https://raw.githubusercontent.com/bmabey/email-spec/master/lib/generators/email_spec/steps/templates/email_steps.rb">on Github</a>.</p>

<p>In <a href="/blog/2014/07/08/sending-emails-with-pony-and-sendgrid/">my last post about small horses and emails</a>, I used the following code to send a confirmation email on signup:</p>

<p>``` ruby web.rb</p>

<h1 id="toc_0:fc24f51bf0f4b159a20fecc6f3770b7e">&hellip;</h1>

<p>post &lsquo;/signup&rsquo; do
  user = User.create! params</p>

<p>url = &ldquo;#{request.base_url}/account/reset/#{user.generate_verification_hash}&rdquo;
  Pony.mail(
    to: user.email,
    from: &ldquo;MyApp Help Desk <a href="mailto:noreply@myapp.com">noreply@myapp.com</a>&rdquo;,
    subject: &ldquo;MyApp Account Verification&rdquo;,
    body: &ldquo;A request has been made to verify your MyApp account (<a href="https://myapp.com).&quot;">https://myapp.com).&quot;</a> +
          &ldquo;If you made this request, go to &rdquo; + url + &ldquo;. If you did not make this request, ignore this email.&rdquo;,
    html_body: haml(
      :verify_account_email,
      layout: false,
      locals: {
        email: user.email,
        date: DateTime.now.strftime(&ldquo;%H:%M:%S%P %B %d, %Y&rdquo;),
        ip: request.ip,
        url: url
      }
    )
  )
end</p>

<h1 id="toc_1:fc24f51bf0f4b159a20fecc6f3770b7e">&hellip;</h1>

<pre><code>
``` haml /views/verify_account_email.haml
%p
  Hello!
%p
  An account verification has been requested for your new &lt;a href=&quot;https://myapp.com&quot;&gt;MyApp&lt;/a&gt; account.

%ul
  %li
    Username: #{locals[:email]}
  %li
    Time: #{locals[:date]}
  %li
    IP address: #{locals[:ip]}

%p
  If you made this request, click the link below or copy-paste the following URL into your browser to verify your account:

%p
  %a{href: &quot;#{locals[:url]}&quot;, alt: &quot;Verify&quot;, title: &quot;Click to verify account&quot;}
    #{locals[:url]}

%p
  If you did not request this new account, please ignore this email.

%p
  Sincerely,
  %br
  Team MyApp

%p
  This email account is not monitored and will not receive replies. For more information, contact &lt;a href=&quot;mailto:connect@myapp.com&quot;&gt;connect@myapp.com&lt;/a&gt;.
</code></pre>

<p>Given the pre-defined steps from email-spec, testing that this email gets sent is a breeze. Adding a scenario to my feature file:</p>

<p>``` cucumber features/SignupConfirmation.feature
Feature: Signup Confirmation
  As a new user
  When I sign up
  I should receive a confirmation email</p>

<p>Background:
  Given a clear email queue
  When I go to the signup page
  And I fill in &ldquo;email&rdquo; with &ldquo;prez@whitehouse.gov&rdquo;
  And I fill in &ldquo;password&rdquo; with &ldquo;bunnies&rdquo;
  And I press &ldquo;Sign Up&rdquo;
  Then &ldquo;prez@whitehouse.gov&rdquo; should receive an email</p>

<p>Scenario: Receives email with correct contents
  When &ldquo;prez@whitehouse.gov&rdquo; opens the email
  Then they should see the email delivered from &ldquo;MyApp Help Desk <a href="mailto:noreply@myapp.com">noreply@myapp.com</a>&ldquo;
  And they should see &ldquo;MyApp Account Verification&rdquo; in the email subject
  And they should see &ldquo;Username: prez@whitehouse.gov&rdquo; in the email body
  And they should see &ldquo;An account verification has been requested&rdquo;
```</p>

<p>That&rsquo;s it. Now we know that an email like the one above will be sent during signup. What we can&rsquo;t test here is that our SMTP server (or equivalent) is working, so in reality I&rsquo;m only testing that the email will attempt to send that looks like the one I test against.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2014-07-08-sending-emails-with-pony-and-sendgrid/">
        Sending emails with Pony and Sendgrid
      </a>
    </h1>

    <span class="post-date">Tue, Jul 8, 2014</span>

    

<p>It&rsquo;s incredible how easy it is to send emails through a web application, there&rsquo;s no wonder we get so much spam. Assuming we have a <a href="http://ruby-lang.org">ruby</a> app using <a href="http://sinatrarb.com">Sinatra</a>, <a href="http://adam.herokuapp.com/past/2008/11/2/pony_the_express_way_to_send_email_from_ruby/">Pony</a> is one of the easiest ways to get started with your own spam empire.</p>

<p>Installation is, as always, trivial with ruby. Install the gem with <code>gem install pony</code> or add <code>gem pony</code> to your <code>Gemfile</code> and run <code>bundle install</code>.</p>

<p>I like to configure Pony in my application&rsquo;s <code>configure</code> block. I could also add it to my <code>config.ru</code>, but I like to keep that file as tiny as posible to avoid having configuration code all over the place.</p>

<p>``` ruby web.rb</p>

<h1 id="toc_0:5ab344014f78a7ee40372e0a19955ec4">&hellip;</h1>

<p>require &lsquo;pony&rsquo;
require &lsquo;sinatra/base&rsquo;</p>

<p>class Application &lt; Sinatra::Base
  configure do
    # &hellip;</p>

<pre><code>Pony.options = {
  :via =&gt; :smtp,
  :via_options =&gt; {
    :address =&gt; 'smtp.sendgrid.net',
    :port =&gt; '587',
    :domain =&gt; 'myapp.com',
    :user_name =&gt; ENV['SENDGRID_USERNAME'],
    :password =&gt; ENV['SENDGRID_PASSWORD'],
    :authentication =&gt; :plain,
    :enable_starttls_auto =&gt; true
  }
}
</code></pre>

<p>end</p>

<p># &hellip;
end</p>

<pre><code>
This block tells Pony to use the [SendGrid](http://sendgrid.com/) server to send mail, use the &quot;myapp.com&quot; HELO domain, and dig up the username and password fields from my environment.

If you're using [Heroku](https://heroku.com) to host your application, you can [sign up for a SendGrid account through your Heroku app](https://addons.heroku.com/sendgrid), which gives you instant access to your SendGrid account. The `username` and `password` field you need to fill in your environment are automatically populated in your Heroku config, which you can view by running `heroku config` for your application. The free account gets you up to 200 emails a day.

Since I might have multiple developers working in my source code and testing the email-sending functionality, I have all the developers [sign up for their own free SendGrid account](https://sendgrid.com/user/signup). This should help to alleviate some of the email volume from any particular account while developing. After signing up, it took my account nearly 4 hours to be &quot;provisioned&quot; (see: approved) by the SendGrid team. Once you're approved you can start sending emails using your developer account credentials. I stick my username/password in my local `.env` file (another reason to make sure you're not storing your environment on your server or in your git repo).

So let's actually send an email. Let's create a route that sends an email to verify a new user account; I'll take some liberties by saying we have a `User` model defined already that generates a signup verification hash. I can tell pony to send a plaintext body through the `body` option and an HTML body through the `html_body` option.

``` ruby web.rb
# ...
post '/signup' do
  user = User.create! params

  url = &quot;#{request.base_url}/account/reset/#{user.generate_verification_hash}&quot;
  Pony.mail(
    to: user.email,
    from: &quot;MyApp Help Desk &lt;noreply@myapp.com&gt;&quot;,
    subject: &quot;MyApp Account Verification&quot;,
    body: &quot;A request has been made to verify your MyApp account (https://myapp.com).&quot; +
          &quot;If you made this request, go to &quot; + url + &quot;. If you did not make this request, ignore this email.&quot;,
    html_body: haml(
      :verify_account_email,
      layout: false,
      locals: {
        email: user.email,
        date: DateTime.now.strftime(&quot;%H:%M:%S%P %B %d, %Y&quot;),
        ip: request.ip,
        url: url
      }
    )
  )
end
</code></pre>

<p>``` haml views/verify_account_email.rb
%p
  Hello!
%p
  An account verification has been requested for your new <a href="https://myapp.com">MyApp</a> account.</p>

<p>%ul
  %li
    Username: #{locals[:email]}
  %li
    Time: #{locals[:date]}
  %li
    IP address: #{locals[:ip]}</p>

<p>%p
  If you made this request, click the link below or copy-paste the following URL into your browser to verify your account:</p>

<p>%p
  %a{href: &ldquo;#{locals[:url]}&ldquo;, alt: &ldquo;Verify&rdquo;, title: &ldquo;Click to verify account&rdquo;}
    #{locals[:url]}</p>

<p>%p
  If you did not request this new account, please ignore this email.</p>

<p>%p
  Sincerely,
  %br
  Team MyApp</p>

<p>%p
  This email account is not monitored and will not receive replies. For more information, contact <a href="mailto:connect@myapp.com">connect@myapp.com</a>.
```</p>

<p>When you have a user hit this route, an email will be sent to the user with the given subject, to, from, and body fields using the configuration parameters given in the previous <code>configure</code> block. Fast, easy, and, best of all, no <code>sendmail</code> configuration.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2014-07-07-deauthorizing-token-with-the-trello-client/">
        Deauthorizing Token with the Trello Client
      </a>
    </h1>

    <span class="post-date">Mon, Jul 7, 2014</span>

    <p>In my <a href="https://ollertapp.com">application</a>, a user can connect to Trello without logging in. Whenever this &ldquo;anonymous&rdquo; user hits the landing page, I attempt to force the <a href="https://trello.com/docs/gettingstarted/clientjs.html">Trello client</a> to authorize the user again. By doing this, the user can return to the landing page whenever he or she likes to switch usernames. My authorize code looks like this:</p>

<pre><code class="language-javascript">function AuthenticateTrelloAlways() {
  Trello.authorize({
    name: &quot;Ollert&quot;,
    type: &quot;popup&quot;,
    interactive: true,
    expiration: &quot;1hour&quot;,
    persist: false,
    success: onAuthorizeSuccessful,
    scope: {
      read: true
    },
  });
}
</code></pre>

<p>This works oh-so-wonderfully in Chrome and Firefox, but, even during the hackathon which spawned <a href="https://ollertapp.com">Ollert</a>, we noticed that IE10/11 were causing some unexpected issues. Authorization would work the first time the user hit the landing page, but on subsequent visits telling Trello to Allow or Deny access resulted in the popup showing a white screen and never calling my callback function. Closing and reopening IE would allow me to authorize once, presumably until the &ldquo;1hour&rdquo; that I requested the original token for expired. I also verified this problem existed in IE9.</p>

<p>After several hours tweeting obscenities about IE, I stumbled upon the answer while browsing the source code for Trello&rsquo;s <a href="https://trello.com/1/client.coffee">client.coffee</a>. About one third of the way through the code, I found this function:</p>

<pre><code class="language-javascript"># Clear any existing authorization
deauthorize: -&gt;
  token = null
  writeStorage(&quot;token&quot;, token)
  return
</code></pre>

<p>All this code does is unset the class variable <code>token</code> and unset the local store variable of the same name. So I changed my <code>AuthenticateTrelloAlways()</code> method:</p>

<pre><code class="language-javascript">function AuthenticateTrelloAlways() {
  Trello.deauthorize();

  Trello.authorize({
    name: &quot;Ollert&quot;,
    type: &quot;popup&quot;,
    interactive: true,
    expiration: &quot;1hour&quot;,
    persist: false,
    success: onAuthorizeSuccessful,
    scope: {
      read: true
    },
  });
}
</code></pre>

<p>Voilà. Why does this only happen in IE? I was originally going to blame the local store, but, since I was able to reproduce the defect in IE9 (no HTML5), I no longer believe that to be the case. I&rsquo;m currently resigned to chalk it up as IE just being IE.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2014-06-12-lessons-learned-during-the-conception-of-ollert/">
        Lessons Learned during the Conception of Ollert
      </a>
    </h1>

    <span class="post-date">Thu, Jun 12, 2014</span>

    <p>During <a href="http://sep.com">SEP&rsquo;s</a> previous <a href="http://sep.com/labs/">startup weekend</a>, I pitched an idea for a <a href="http://trello.com">Trello</a> Analysis Tool called <a href="https://ollertapp.com">Ollert</a>. In less than three days, a team of 6 built a minimal viable product (MVP) and put it live on the internet. In a little over three months, I have slowly guided Ollert through the legal department, obtained a real domain with security, and fixed a few bugs along the way. I&rsquo;ve learned a thing or two about seeing a hackathon project to fruition that I&rsquo;d like to get in writing.</p>

<p>###1. You Can Never Be Too Prepared</p>

<p>Before Startup Weekend, I spent days refining my idea and coming up with a cute little proof of concept. I even laid out work items for my developers to work on. When I finally discovered a clever name, I thought my preparation was over.</p>

<p>I was wrong.</p>

<p>Although I requested 5 developers to help me build Ollert, my plans only allowed for two developers to work simultaneously. I didn&rsquo;t realize how hard it would be to keep everyone busy all the time, especially my less-experienced engineers.</p>

<p>Although I did proof-of-concept my idea before we started, I failed to proof-of-concept the more dynamic capabilities a multi-user web application needs to provide. This mistake cost another developer and I the first night of the weekend, plus a bit of the next morning.</p>

<p>Don&rsquo;t even get me started about environment setup. Although I run <a href="http://www.ubuntu.com">Ubuntu</a> natively and had all my developer tools ready before we started work Friday night, the rest of my team were users of That Other Operating System. I should have created a virtual machine with everything all set up, burned it to several USB drives, and let my developers set up VirtualBox without my intervention.</p>

<p>###2. Talk to Legal</p>

<p>Why do I care about legal? Isn&rsquo;t this my responsibility anyway?</p>

<p>As it turns out, putting a startup weekend project live on the internet before the weekend is over is really cool from a team perspective, but terrifying from a legal perspective. With our MVP, I wasn&rsquo;t using SSL to encrypt user data. I didn&rsquo;t consider how Fog Creek would react once they realized our name is their name backwards. I even had the chutzpah to stick my company&rsquo;s logo in my site&rsquo;s footer.</p>

<p>A quick discussion with management will prepare both sides for the &ldquo;grand reveal&rdquo; if the project makes it to launch. Personally, I&rsquo;d like to see some level of legal counsel in the Startup Weekend &ldquo;pre-pitch&rdquo; session to get feedback before implementation.</p>

<p>###3. Listen</p>

<p>The second day, one of my developers mentioned using endpoints in the application, and I rejected this idea on the basis that it was too complicated. On the dawn of the final day, we realized that we needed to use his approach or the application would be unusable. This required us to do a lot of rework that could have been avoided. I often think about what other ideas might have been suggested by my team that I may have accidentally ignored.</p>

<p>###4. Easy Tasks</p>

<p>My assumption going into Startup Weekend was that my team would all be familiar enough with the technology to be able to &ldquo;jump right in&rdquo; or follow along with someone who could. This was a bad assumption.</p>

<p>It&rsquo;s easy to find tasks that <em>I</em> can do. It&rsquo;s much more difficult to find tasks that <em>anyone</em> could do. What are the less-involved tasks on your current project that a less-experienced developer could work on until they&rsquo;re ready to tackle something bigger? Can they set up the database, or the tests? Can you find a guide for them to follow to do these things? If not, you&rsquo;ll have people on your team who don&rsquo;t feel involved but desperately want to help.</p>

<p>###5. Start Small</p>

<p>Ollert is a pretty big idea, especially for a three-day project. I had high hopes of making it even bigger until the dawn of the final day. I wanted to include some sort of payment system to prove that we would be able to charge people when they sign up without actually charging them. This &ldquo;feature&rdquo; of fake payment has no place in a real product, and would have been misleading at best. We had dozens of ideas for statistics and charts to make it into the website that just weren&rsquo;t that useful.</p>

<p>Limiting scope might have allowed us to come up with a more polished MVP; I walked away the final evening wishing I had left out sign up/in in favor of giving the application more sex appeal.</p>

<p>###Conclusion</p>

<p>Starting a project is hard. It&rsquo;s even more difficult when you have to delegate most of the work to other people. Startup Weekend is a manger and a mortuary, seeing the birth of many ideas and the death of most. I hope to take this experience and make an even better new product next Startup Weekend.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2014-06-03-jasmine-a-whole-new-world-of-javascript-testing/">
        Jasmine - A Whole New World of Javascript Testing
      </a>
    </h1>

    <span class="post-date">Wed, Jun 4, 2014</span>

    <p><a href="https://jasmine.github.io/">Jasmine</a>: a headless Javascript testing library written entirely in Javascript. With similarities to <a href="http://rspec.info">rspec</a>, I&rsquo;ve quickly grown attached to this framework and have been looking for opportunities to discuss it. <a href="https://jasmine.github.io/2.0/introduction.html">Version 2.0</a> was recently released, so I&rsquo;ll be focusing on the standalone 2.0 concepts. To get started, download and uncompress <a href="https://github.com/pivotal/jasmine/tree/master/dist">the standalone distribution</a>.</p>

<p>The uncompressed directory structure will have three subdirectories: <code>spec</code>, <code>src</code>, and <code>lib</code>. <code>lib</code> contains all the Jasmine source code. <code>src</code> contains some sample Javascript class that is tested by test files contained in <code>spec</code>. Outside of the subdirectories is the special file <code>SpecRunner.html</code>. This file is how we will run our tests.</p>

<p>Let&rsquo;s start a new pizza place.</p>

<p>We&rsquo;ll need Pizza. A Pizza will need several things: size, style, toppings, and price. We&rsquo;ll have a few styles available, but also allow our guests to request additional toppings. We&rsquo;ll also set the price based on the size and number of toppings. Create the files <code>src/pizza.js</code> and <code>spec/PizzaSpec.js</code> and add them to <code>SpecRunner.html</code>.</p>

<p>We&rsquo;ll start by being able to get the styles from Pizza.</p>

<p>``` js spec/PizzaSpec.js
describe(&ldquo;Pizza&rdquo;, function() {
  var pizza;</p>

<p>beforeEach(function() {
    pizza = new Pizza();
  });</p>

<p>it(&ldquo;should give a choice of styles&rdquo;, function() {
    expect(pizza.getStyles()).toContain(&ldquo;meat lovers&rdquo;);
    expect(pizza.getStyles()).toContain(&ldquo;veg head&rdquo;);
    expect(pizza.getStyles()).toContain(&ldquo;supreme&rdquo;);
  });
});</p>

<pre><code>
The syntax is just lovely: We use `describe` to set visual context, `beforeEach` to perform a task before each spec, and `it` to encapsulate a test. The results of running `SpecRunner.html` in my browser:

</code></pre>

<p>Pizza should give a choice of styles
  TypeError: pizza.getStyles is not a function in file:///home/lrp/docs/jasmine/spec/PizzaSpec.js (line 9)</p>

<pre><code>
Fixing it:

``` js src/pizza.js
function Pizza() {
  this.getStyles = function() {
    return [&quot;meat lovers&quot;, &quot;veg head&quot;, &quot;supreme&quot;];
  }
}
</code></pre>

<p>And the results:</p>

<pre><code>Pizza
    should give a choice of styles
</code></pre>

<p>Let&rsquo;s set the toppings:</p>

<p>``` js spec/PizzaSpec.js
describe(&ldquo;Pizza&rdquo;, function() {
  // &hellip;</p>

<p>describe(&ldquo;toppings&rdquo;, function() {
    it(&ldquo;should have no toppings when no style and no extras given&rdquo;, function() {
      pizza.initialize();
      expect(pizza.getToppings().length).toBe(0);
    });</p>

<pre><code>it(&quot;should have only extras when no style and extras given&quot;, function() {
  var extras = [&quot;pineapple&quot;, &quot;edamame&quot;, &quot;cheeseburger&quot;]
  pizza.initialize(null, null, extras);

  expect(pizza.getToppings().length).toBe(extras.length);
  for (var i = 0; i &lt; extras.length; i++) {
    expect(pizza.getToppings()).toContain(extras[i]);
  }
});

it(&quot;should have special toppings when given style and extras&quot;, function() {
  var extras = [&quot;pineapple&quot;, &quot;edamame&quot;, &quot;cheeseburger&quot;];
  pizza.initialize(null, &quot;veg head&quot;, extras);

  expect(pizza.getToppings().length).toBe(7);
});

it(&quot;should have special toppings when given style&quot;, function() {
  var extras = [&quot;pineapple&quot;, &quot;edamame&quot;, &quot;cheeseburger&quot;];
  pizza.initialize(null, &quot;veg head&quot;);

  expect(pizza.getToppings().length).toBe(4);
});
</code></pre>

<p>});
});</p>

<pre><code>
For these tests, I nested a describe block to give better context to what I'm testing. Fixing the tests:

``` js src/pizza.js
function Pizza() {
  // ...

  var size, toppings;

  function findToppings(style, extras) {
    toppings = extras ? extras : [];

    switch (style) {
      case (&quot;meat lovers&quot;):
        toppings.push(&quot;ham&quot;, &quot;pepperoni&quot;, &quot;bacon&quot;, &quot;sausage&quot;);
        break;
      case (&quot;veg head&quot;):
        toppings.push(&quot;onion&quot;, &quot;tomato&quot;, &quot;pepper&quot;, &quot;olive&quot;);
        break;
      case (&quot;supreme&quot;):
        toppings.push(&quot;pepperoni&quot;, &quot;onion&quot;, &quot;sausage&quot;, &quot;olive&quot;);
        break;
    }
  }

  this.getToppings = function() {
    return toppings;
  };

  this.initialize = function(pizzaSize, style, extras) {
    size = pizzaSize;
    findToppings(style, extras);
  };
}
</code></pre>

<p>And finally, I&rsquo;ll deal with the cost. I&rsquo;ll come out of scope of the nested <code>describe</code> and nest another <code>describe</code>.</p>

<p>``` js spec/PizzaSpec.js
describe(&ldquo;Pizza&rdquo;, function() {
  // &hellip;</p>

<p>describe(&ldquo;cost&rdquo;, function() {
    it(&ldquo;is determined by size and number of toppings&rdquo;, function() {
      pizza.initialize(10, &ldquo;supreme&rdquo;);
      expect(pizza.getToppings().length).toBe(4);
      expect(pizza.getCost()).toBe(7.00);
    });</p>

<pre><code>it(&quot;is determined by size and number of toppings including extras&quot;, function() {
  pizza.initialize(18, &quot;meat lovers&quot;, [&quot;gyros&quot;, &quot;panchetta&quot;]);
  expect(pizza.getToppings().length).toBe(6);
  expect(pizza.getCost()).toBe(12.00);
});
</code></pre>

<p>});
});</p>

<pre><code>
To fix this test, I'll use my handy-dandy pizza-cost formula:

``` js src/pizza.js
function Pizza() {
 // ...

  this.getCost = function() {
    return size/2 + toppings.length * .5;
  }

  // ...
}
</code></pre>

<p>This is great and all, but a bit simple. What if we wanted to make an ajax call? Fortunately, I can fit that into this example using <a href="http://onlinepizza.se/api/">Online Pizza</a>, the pizza API. Unfortuantely, the API is kind of garbage, but that doesn&rsquo;t make this example any more meaningless. You can <a href="https://github.com/pivotal/jasmine-ajax/raw/master/lib/mock-ajax.js">download jasmine-ajax on Github</a>, and stick it in your <code>spec/</code> directory and add it to <code>SpecRunner.html</code>. At this point I need to include [jquery]() as well.</p>

<p>In order to intercept ajax calls, I&rsquo;ll <code>install</code> the ajax mocker in the <code>beforeEach</code> and uninstall it in an <code>afterEach</code>. Then I write my test, which verifies that the ajax call occurred and returns a response.</p>

<p>``` js spec/PizzaSpec.js
beforeEach(function() {
  jasmine.Ajax.install();</p>

<p>pizza = new Pizza();
});</p>

<p>afterEach(function() {
  jasmine.Ajax.uninstall();
});</p>

<p>describe(&ldquo;sendOrder&rdquo;, function() {
  it(&ldquo;returns false for bad pizza&rdquo;, function() {
    pizza.sendOrder();</p>

<pre><code>expect(jasmine.Ajax.requests.mostRecent().url).toBe(&quot;http://onlinepizza.se/api/rest?order.send&quot;);

jasmine.Ajax.requests.mostRecent().response({
  status: &quot;500&quot;,
  contentType: &quot;text/plain&quot;,
  responseText: &quot;Invalid pizza&quot;
});

expect(pizza.orderSent()).toBe(false);
</code></pre>

<p>});</p>

<p>it(&ldquo;returns true for good pizza&rdquo;, function() {
    pizza.sendOrder();</p>

<pre><code>expect(jasmine.Ajax.requests.mostRecent().url).toBe(&quot;http://onlinepizza.se/api/rest?order.send&quot;);

jasmine.Ajax.requests.mostRecent().response({
  status: &quot;200&quot;,
  contentType: &quot;text/plain&quot;,
  responseText: &quot;OK&quot;
});

expect(pizza.orderSent()).toBe(true);
</code></pre>

<p>});
});</p>

<pre><code>
To get this to work, I add some logic to the `Pizza` class to set some state based on what the ajax call returns.

``` js src/pizza.js
var orderSuccess;

this.sendOrder = function() {
  orderSuccess = null;

  $.ajax({
    type: &quot;POST&quot;,
    url: &quot;http://onlinepizza.se/api/rest?order.send&quot;,
    success: function() {
      orderSuccess = true;
    },
    error: function() {
      orderSuccess = false;
    }
  });
}

this.orderSent = function() {
  return orderSuccess;
}
</code></pre>

<p>Ajax calls tested. By installing Jasmine&rsquo;s ajax mock, all of the ajax calls were intercepted and were not sent to the server at Online Pizza. Any ajax calls that may have been fired by the <code>Pizza</code> class but were not addressed in the spec are ignored. The final test results look something like this:</p>

<pre><code>Pizza
    sendOrder
        returns false for bad pizza
        returns true for good pizza
    styles
        should give a choice of styles
    toppings
        should have no toppings when no style and no extras given
        should have only extras when no style and extras given
        should have special toppings when given style and extras
        should have special toppings when given style
    cost
        is determined by size and number of toppings
        is determined by size and number of toppings including extras
</code></pre>

<p>Full sample code <a href="https://github.com/larryprice/jasmine-pizza">available on Github</a>. There&rsquo;s a lot of other interesting things Jasmine can do that I&rsquo;m still learning about. If applicable, I&rsquo;ll try to create a blog post for advanced Jasmine usage in the future.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2014-05-25-git-out-the-way-rebase-workflow/">
        Git out the Way - Rebase Workflow
      </a>
    </h1>

    <span class="post-date">Sun, May 25, 2014</span>

    <p>We use <a href="http://www.git-scm.com/">git</a> on my current project, and we used to always use remote branches. After doubling the number of developers touching the repo, we found that remote feature branches led to merge conflicts, stale branches, and hidden code. We&rsquo;ve switched away from using remote feature branches, favoring instead to commit directly to <code>origin/master</code>, making remote feature branches the exception. We do this using a simple method called <code>rebase</code>.</p>

<p>What does it mean to <code>rebase</code>?</p>

<p>When you rebase your local changes onto another branch, your changes become the head of that branch. For instance, say I start working off remote branch <code>master</code>, specifically changeset <code>M2</code>. I then make some changes and commit locally, which I&rsquo;ll note as changeset <code>L</code>. While I was making my changes, some other developer pushed to remote branch <code>master</code>, resulting in changeset <code>M3</code>.</p>

<pre><code>M1 -&gt; M2 -&gt; M3
        \
         -&gt;L
</code></pre>

<p>This is where <code>rebase</code> comes in. I want to rebase my local commit on top of <code>M3</code>, which will make it the new head of <code>master</code>.</p>

<pre><code>$ git rebase origin/master
</code></pre>

<pre><code>M1 -&gt; M2 -&gt; M3 -&gt; L
</code></pre>

<p>Now I can keep working locally. Until I push my local <code>master</code> to <code>origin</code>, every time I <code>rebase</code> will cause all of my commits to rebase on the head of <code>master</code>.</p>

<p>I like to keep as close to <code>origin/master</code> as possible since we have a fairly active repository. If I want to make sure I have the bleeding edge of <code>master</code>, sometimes I don&rsquo;t have my local changes in working order when I want to rebase. Some people like to stash and unstash local changes, but that takes too much effort for me. I prefer just to use <code>git commit --amend</code> to constantly update the last changes I committed. You can only amend to an unpushed local commit, otherwise you&rsquo;d be changing history remotely (which is bad). Using the <code>amend</code> flag allows me to keep one solid local changeset around until I&rsquo;m comfortable with pushing it to <code>origin</code>. Also note that using <code>amend</code> also allows you to change the commit message of the last commit.</p>

<p>What happens when you need to use a remote branch?</p>

<p>Git&rsquo;s best-kept secret is <code>merge --squash</code>, a wonderful flag that gives you all the benefits of a <code>rebase</code> (linear history, fewer changesets), without all the hassle of a big fat rebase merge (rebasing infrequently can lead to merges that will haunt you in your sleep).</p>

<pre><code>$ git branch
* local-branch
master
$ git merge master
$ git checkout master
$ git merge local-branch --squash
</code></pre>

<p>This will give you a single changeset on the head of <code>master</code> containing all the changes you made in <code>local-branch</code>, including resolution of merge conflicts. <code>merge --squash</code> has eased a lot of the headaches my team had when stuck doing rebase merges previously.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2014-05-14-takeaways-from-agileindy-2014/">
        Takeaways From AgileIndy 2014
      </a>
    </h1>

    <span class="post-date">Wed, May 14, 2014</span>

    <p><a href="//agileindy.org/conference/">The AgileIndy Conference 2014</a> has come and gone. I wasn&rsquo;t sure what to expect, since it was my first conference, but I came out of it feeling rather positive.</p>

<p>A short list of my favorite things from this year&rsquo;s AgileIndy:</p>

<ul>
<li>Interesting speakers</li>
<li>Good food</li>
<li>Uncomfortable chairs</li>
<li><a href="//twitter.com/search?q=%23agileindy14&amp;src=hash">#agileindy14</a></li>
<li>Free booze</li>
<li>Lots of coffee</li>
<li>Champion dogs</li>
</ul>

<p>Good times. Personally, I found the first half of the day to be superior to the afternoon. I&rsquo;m not sure if it was the speakers or if I&rsquo;m just a morning person, but I&rsquo;m much more interested in discussing what the morning speakers had to say.</p>

<p>###The Dude</p>

<blockquote>
<p>We&rsquo;ve got hard problems to solve, we don&rsquo;t need aphorisms, we don&rsquo;t need truisms.
&ndash; David Hussman</p>
</blockquote>

<p>The event started out with the self-proclaimed &ldquo;Dude,&rdquo; <a href="//devjam.com/">David Hussman of DevJam</a>. I&rsquo;ve previously had some training involving Mr Hussman at <a href="//sep.com">SEP</a>, during which we had trouble explaining our relationship with Agile: gargantuan project, lots of devs, massive codebase, hour-long builds, and an immature implementation of the so-called Scalable Agile Framework. I thought I knew what to expect during this talk, but I was delightfully mistaken. Everything Hussman said during his keynote fit with the conversations I&rsquo;ve been having with my current teammates.</p>

<p>Hussman talked about &ldquo;process mass,&rdquo; or the weight that you carry as you gain more and more process on a project. &ldquo;Measure your success by evidence, not by adherence&rdquo; to the process. What good is completing a story if you don&rsquo;t have anything to show for it, or if you don&rsquo;t have the quality to back it up? Hussman discussed scrum, and the ridiculous concept of &ldquo;scrum of scrums,&rdquo; and potentially even a &ldquo;scrum of scrum of scrums.&rdquo; In his own words, &ldquo;At some point you have to have something other than a naming convention.&rdquo; Getting stuff done and feeling satisfied with your work is much more important than being able to audit the lifetime of a story, or what day of the week your team gets the most done, or how many meetings your ScrumMaster goes to.</p>

<p>Speaking of ScrumMasters (and Product Owners and Tech Leads for that matter), the Dude wants us to think critically about these roles. Why are Scrum Masters and Tech Leads in meetings all day? A Tech Lead mosies into standup in the morning just to say, &ldquo;Yesterday I was in meetings all day, today I&rsquo;m in meetings all day, no blockers.&rdquo; &ldquo;Somehow [we&rsquo;ve] bonded the process to the people,&rdquo; using process to hold team members hostage. We&rsquo;ve found ourselves turning Agile into a bloated mess, and we&rsquo;re in need of people to relieve the pressure.</p>

<p>###Estimation</p>

<p>During the first break-out session, <a href="//vance.com/">Steve Vance</a> talked about estimation, one of my favorite topics to complain about.</p>

<p>We started out by defining terms. Unfortunately, we use the word &ldquo;estimation&rdquo; to mean almost anything, from the very precise to the very vague. We &ldquo;estimate&rdquo; in T-shirt sizes, story points, days, and hours. We all mean something different when we make an estimation; it all boils down to an opinion. &ldquo;The work is going to take what it takes,&rdquo; and everyone has an opinion on how long that is.</p>

<p>I mentioned hours in the above paragraph as a unit of estimation. This is a particular pet peeve of mine: I absolutely despise estimating in hours. What do we even mean when we estimate in hours? Vance says, &ldquo;When I say hours as in this is going to take 3 hours, that does not mean 3 clock hours.&rdquo; So what <em>does</em> an hour mean? My current team uses a tool called TFS, which actually forces you to answer this question. So we &ldquo;estimate&rdquo; that Danny Developer will be able to accomplish 5 hours of work every day. We just turned Danny&rsquo;s day into hours on a clock. Now we &ldquo;estimate&rdquo; that a task will take &ldquo;about a day,&rdquo; which translates into 8 hours. Note that <code>1 task day != 1 Danny Day</code>. We&rsquo;re estimating tasks in these very precise units (real-life hours), and poor Danny will probably just work a 10-hour day to finish the task in &ldquo;1 day,&rdquo; which is what the team estimated the task would take.</p>

<p>T-shirt sizing or story points should be able to alleviate these problems, but we have to be vigilant not to concretely define these terms. Estimates should always be relative to yesterday&rsquo;s weather and not based on real time frames. Once you&rsquo;ve defined a 5-point story as taking exactly 5 days, you&rsquo;ve destroyed the whole system and you might as well start estimating in hours again.</p>

<p>###Anti-fragility</p>

<p><a href="//salhir.wordpress.com">Si Alhir</a> discussed the principles of &ldquo;anti-fragility&rdquo; during the pre-lunch session. Anti-fragility is a post-Agile concept. That&rsquo;s right: <em>post-Agile</em>. I know you were just getting used to Agile, but it seems that we&rsquo;ve created a monster that&rsquo;s getting harder and harder to control. Teams find themselves saying &ldquo;They&rsquo;re not Agile, we&rsquo;re Agile&rdquo; when describing the pitfalls of other teams.</p>

<p>So what is anti-fragility? It&rsquo;s easier to define in relative terms. Traditional teams are hurt by change and actively resist change; Agile teams embrace change and are able to inspect and adapt to it; Anti-Fragile teams embrace disorder and are able to adapt and evolve to chaos. &ldquo;Fragile teams want tranquility,&rdquo; while anti-fragile teams &ldquo;gain from stress.&rdquo; Anti-fragility involves shifting from focusing on avoiding risk to focusing on overcoming risk.</p>

<p>&ldquo;What have you removed?&rdquo; Si asks, reiterating Hussman from earlier in the day. &ldquo;More rules, more process causes more fragility.&rdquo; As our Agile teams add process, this becomes more evident. &ldquo;Dependency,&rdquo; &ldquo;the line between dev and test&rdquo;, and &ldquo;centralized power&rdquo; all cause fragility. Sprint cycles every 1-2 weeks cause a constant stress, which &ldquo;will kill you, numb you.&rdquo; Anti-fragile teams prefer &ldquo;acute stress with recovery time&rdquo; caused by overcoming risk as it materializes. The so-called ScrumMaster of an Agile team is protecting the team from risk, contributing to the overall fragility of the team.</p>

<p>&ldquo;The most fragile thing in the Agile world is teams,&rdquo; Si insists. &ldquo;Consistent, co-located teams.&rdquo; Teams should be able to be disbanded and created at-will or &ldquo;just in time&rdquo; as the need arises. Teams are created to attack &ldquo;focal points,&rdquo; or areas that need attention right away. This is an especially hard pill to swallow, since many of us like the familial feeling that comes with long-term teams. Not to mention the nightmares of billing if you&rsquo;re a consulting company.</p>

<p>###Conclusion</p>

<p>There were a few other speakers at the conference, but none hit quite as close to home as the three I&rsquo;ve discussed. Overall a very interesting conference and a very fun experience. I&rsquo;m excited to think about these ideas and I&rsquo;d like to attempt to use some of them to make my teams more efficient and maybe even a little happier. It looks like the general flow is to move away from massive amounts of process, working more like Lean Startup or Anti-fragile teams.</p>

<p>A decade from now, we&rsquo;ll be living in a post-anti-fragile world wondering what on earth we were thinking in this world of rules, definitions, estimations, and process.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2014-05-13-better-testing-in-go-with-gocheck/">
        Better testing in Go with gocheck
      </a>
    </h1>

    <span class="post-date">Tue, May 13, 2014</span>

    <p>As a quick reminder, <a href="//golang.org/">golang</a> is a really fun programming language to use. It even includes <a href="//golang.org/doc/code.html#Testing">testing out of the box</a>! Unfortunately, this out-of-the-box testing framework isn&rsquo;t all that great. It lacks the syntactic sugar of mature frameworks like <a href="//rspec.info">rspec</a> or <a href="//code.google.com/p/googletest/">gtest</a>.</p>

<p>Of course, there are alternatives. I found an open-source library (licensed with Simplified BSD) called <a href="//labix.org/gocheck">gocheck</a>.</p>

<p>Gocheck, how do I love thee? Let me count the ways:</p>

<ul>
<li>Test fixtures</li>
<li>Improved assertions</li>
<li>Improved test output</li>
<li>Sugar-coated syntax</li>
<li>Test skipping</li>
<li>Oh my</li>
</ul>

<p>As usual, it&rsquo;s time to guide you through a contrived example. Start by installing the package:</p>

<pre><code class="language-bash">$ go get gopkg.in/check.v1
</code></pre>

<p>Let&rsquo;s see, what should we make&hellip; how about a tip calculating library? We should start by testing, because we&rsquo;re obsessed with TDD.</p>

<p>Test #1: Returns 0 for free meal</p>

<p>``` go calculator_test.go
package cheapskate</p>

<p>import (
  &ldquo;testing&rdquo;
  . &ldquo;gopkg.in/check.v1&rdquo;
)</p>

<p>// Hook up gocheck into the &ldquo;go test&rdquo; runner.
func Test(t *testing.T) { TestingT(t) }</p>

<p>type MySuite struct{}</p>

<p>var _ = Suite(&amp;MySuite{})</p>

<p>func (s *MySuite) TestReturns0ForFreeMeal(c *C) {
  c.Assert(calculateTip(0.0), Equals, 0.0)
}</p>

<pre><code>
Not quite as obvious as the internal testing framework. First we hook up gocheck into the &quot;go test&quot; runner. Then we create a test suite; ours is empty for now and called `MySuite`. We call `Suite` to intialize the test runner with our custom suite. We then write our first test to assert that calculating the tip returns a value equal to 0. All tests must be prefixed with the word &quot;Test&quot;. Now I'll write the implementation:

``` go calculator.go
package cheapskate

func calculateTip(bill float64) float64 {
  return 0.0
}
</code></pre>

<p>Running the tests&hellip;</p>

<pre><code class="language-bash">$ go test
OK: 1 passed
PASS
ok    _/home/lrp/Projects/2014/gocheck-quick  0.003s
</code></pre>

<p>Woohoo! All passed. What happens if we write a failing test?</p>

<p>``` go calculator_test.go
&hellip;
func (s *MySuite) TestReturns15PercentByDefault(c *C) {
  c.Assert(calculateTip(100.0), Equals, 15.0)
}</p>

<pre><code>
Results:

``` bash
lrp@cilantro:~/Projects/2014/gocheck-quick$ go test

----------------------------------------------------------------------
FAIL: calculator_test.go:19: MySuite.TestReturns15PercentByDefault

calculator_test.go:20:
    c.Assert(calculateTip(100.0), Equals, 15.0)
... obtained float64 = 0
... expected float64 = 15

OOPS: 1 passed, 1 FAILED
--- FAIL: Test (0.00 seconds)
FAIL
exit status 1
FAIL  _/home/lrp/Projects/2014/gocheck-quick  0.003s
</code></pre>

<p>A nasty failure that one. I&rsquo;ll fix it and continue:</p>

<p>``` go calculator.go
package cheapskate</p>

<p>func calculateTip(bill float64) float64 {
  return .15 * bill
}</p>

<pre><code>
I want to create a Setup method for my entire suite. I'll store some silly information there for information's sake. The minBill and maxBill variables will only be set when I first load the suite.

``` go calculator_test.go
package cheapskate

import (
  &quot;testing&quot;
  . &quot;gopkg.in/check.v1&quot;
)

// Hook up gocheck into the &quot;go test&quot; runner.
func Test(t *testing.T) { TestingT(t) }

type MySuite struct{
  minBill float64
  maxBill float64
}

func (s *MySuite) SetUpSuite(c *C) {
  s.minBill = 0
  s.maxBill = 100
}

var _ = Suite(&amp;MySuite{})

func (s *MySuite) TestReturns0ForFreeMeal(c *C) {
  c.Assert(calculateTip(s.minBill), Equals, 0.0)
}

func (s *MySuite) TestReturns15PercentByDefault(c *C) {
  c.Assert(calculateTip(s.maxBill), Equals, 15.0)
}
</code></pre>

<p>What if I wanted to set some information at the start of each test? I&rsquo;ll log the current test number on the suite, updating it every time I run a test:</p>

<p>``` go calculator_test.go
package cheapskate</p>

<p>import (
  &ldquo;testing&rdquo;
  . &ldquo;gopkg.in/check.v1&rdquo;</p>

<p>&ldquo;fmt&rdquo;
)</p>

<p>// Hook up gocheck into the &ldquo;go test&rdquo; runner.
func Test(t *testing.T) { TestingT(t) }</p>

<p>type MySuite struct{
  testNumber int
}</p>

<p>func (s *MySuite) SetUpTest(c *C) {
  fmt.Println(s.testNumber)
  s.testNumber += 1
}
&hellip;</p>

<pre><code>
Result:

``` bash
$ go test
0
1
OK: 2 passed
PASS
ok    _/home/lrp/Projects/2014/gocheck-quick  0.004s
</code></pre>

<p>You can create tear down methods for suites and tests in the same manner, replacing the appropriate words above.</p>

<p>There&rsquo;s loads of other cool stuff gocheck can do, I&rsquo;ve barely scratched the surface with what little experience I&rsquo;ve had using it. Like any testing framework, I&rsquo;m sure it has its advantages and disadvantages, but it sure beats the pants off the off-the-shelf framework Google includes with golang.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2014-04-04-the-lean-startup/">
        The Lean Startup
      </a>
    </h1>

    <span class="post-date">Fri, Apr 4, 2014</span>

    <blockquote>
<p>If you cannot fail, you cannot learn.</p>
</blockquote>

<p>###The Gist</p>

<p><a href="http://ws-na.amazon-adsystem.com/widgets/q?ServiceVersion=20070822&amp;Operation=GetAdHtml&amp;ID=OneJS&amp;OneJS=1&amp;source=ac&amp;ref=qf_sp_asin_til&amp;ad_type=product_link&amp;tracking_id=larpriandthee-20&amp;marketplace=amazon&amp;region=US&amp;placement=0307887898&amp;asins=0307887898&amp;show_border=true&amp;link_opens_in_new_window=true&amp;MarketPlace=US"><em>The Lean Startup</em></a> by Eric Ries explains how Lean methodlogies are not only meaningful for startups, but can also be used to create innovation within large organizations.</p>

<p>###What I Think</p>

<p>If I had a nickel for every time the word &ldquo;entrepreneur&rdquo; showed up in this book&hellip;</p>

<p>Besides that, this book is highly insightful with many great examples of companies, small and large, that have built great products using Lean processes.</p>

<p>Part of what makes this book readable is the credibility of the author, a founder of several startups who has seen failure and success. I wasn&rsquo;t convinced that I would enjoy this book until I read Eric&rsquo;s story about IMVU&rsquo;s initial failures and how those failures were overcome. I won&rsquo;t spoil too much for anyone currently reading the book, but IMVU does eventually figure out what customers want, thanks in no small part to rethinking the way that the company develops software.</p>

<p>The majority of this book focuses on creating a minimal viable product. Creating an MVP is difficult from a developer&rsquo;s perspective, and the author touches on this quite a bit. Developers don&rsquo;t like to release products that may contain bugs or may not contain all the &ldquo;essential&rdquo; features, but an MVP is not about feature-completeness, it&rsquo;s about getting the product to users as quickly as possible to accelerate the &ldquo;build-measure-learn&rdquo; process.</p>

<p>Once again, I&rsquo;d like to stress that the real-world experiences described in this book are what makes it so convincing. Stories about IMVU, Intuit, and Toyota makes these concepts seem obtainable for a company of any size.</p>

<p>###Who Should Read This</p>

<p>You should read this if you&rsquo;re not sure how to get your company thinking about Lean processes. You should also read this if you want to eliminate waste on your project and learn how to get the most out of customer feedback. Open mind required to teach old dogs new tricks.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2014-03-29-using-sqlite-on-heroku/">
        Using sqlite on Heroku
      </a>
    </h1>

    <span class="post-date">Sat, Mar 29, 2014</span>

    <p>Or rather, &ldquo;Not Using sqlite on Heroku.&rdquo;</p>

<p><a href="//heroku.com">Heroku</a> does not support <a href="//sqlite.org">sqlite</a>. That doesn&rsquo;t mean we have to stop using sqlite in development, but it does mean we need to put in some workarounds to support our deployment environment. The rest of this article will use <a href="//ruby-lang.org">ruby</a> and <a href="//sinatrarb.com">Sinatra</a>.</p>

<p>Assuming you have a heroku app deployed and you have sqlite already working locally, this only takes a few steps. First we need to add a SQL database to our heroku app. From the project directory, we&rsquo;ll add the <a href="//addons.heroku.com/heroku-postgresql">heroku-postgresql</a> addon to our app.</p>

<pre><code class="language-bash">$ heroku addons:add heroku-postgresql:dev
</code></pre>

<p>The <code>dev</code> piece of this command tells heroku we want the small, free database. This database supports up to 10,000 rows and has a 99.5% uptime. Best of all: it&rsquo;s free. Other options have you pay $9/mo for 10,000,000 rows or $50+ for Unlimited usage. I recommend you start small.</p>

<p>Hopefully you got some success statements after adding heroku-postgresql. They should have included some new environment variables, which are links to your new Postgres database. Record these; we&rsquo;ll use them a little later.</p>

<p>Now we need to set up the back-end to be able to access a Postgres database when necessary. Hopefully you&rsquo;re using a decent abstraction library in your app that can access any SQL database. For ruby, I find <a href="//www.sequel.rubyforge.org/">Sequel</a> to be sufficient.</p>

<p>In our Gemfile, we&rsquo;ve probably already included the sqlite gem for use in our local environment. We can go ahead and move that into a <code>development</code> block, and we need to add the <code>pg</code> gem to either <code>production</code> or the global block.</p>

<p>``` ruby Gemfile
source &ldquo;<a href="https://rubygems.org&quot;">https://rubygems.org&quot;</a></p>

<p>ruby &lsquo;2.1.0&rsquo;</p>

<p>gem &lsquo;bundler&rsquo;
gem &lsquo;rake&rsquo;
gem &lsquo;sinatra&rsquo;
gem &lsquo;haml&rsquo;
gem &lsquo;sequel&rsquo;</p>

<p>group :production do
  gem &lsquo;pg&rsquo;
end</p>

<p>group :development do
  gem &lsquo;sqlite3&rsquo;
end</p>

<pre><code>
Heroku sets `ENV['RACK_ENV']` to &quot;production&quot; for us, which means that the pg gem should get picked up the next time we deploy. Now we need to tell our app which database to use in which situation.

One of the easiest places to make this decision is in Sinatra's `configure` block. I keep my local db in an environment variable called `LOCAL_DATABASE_URL`. This is where you use the environment variable heroku set for you when you set up your Postgres database; mine was called `HEROKU_POSTGRESQL_MAROON_URL`.

``` ruby web.rb
class App &lt; Sinatra::Base
  configure :production do
    Sequel.connect ENV['HEROKU_POSTGRESQL_MAROON_URL']
  end

  configure :development do
    Sequel.connect ENV['LOCAL_DATABASE_URL']
  end
end
</code></pre>

<p>This works because the default environment is &ldquo;development.&rdquo; Test locally, and then we can deploy.</p>

<pre><code class="language-bash">$ git push heroku master
</code></pre>

<p>And enjoy.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2014-03-26-rework/">
        Rework
      </a>
    </h1>

    <span class="post-date">Wed, Mar 26, 2014</span>

    

<blockquote>
<p>You want to get into the rhythm of making choices. When you get in that flow of making decision after decision, you build momentum and boost morale. Decisions are progress. Each one you make is a brick in your foundation. You can&rsquo;t build on top of &ldquo;We&rsquo;ll decide later,&rdquo; but you <em>can</em> build on top of &ldquo;Done.&rdquo;</p>

<p>Excerpt from &ldquo;Decisions are Progress&rdquo; in <em>Rework</em></p>
</blockquote>

<p>###The Gist</p>

<p><a href="http://www.amazon.com/gp/product/0307463745/ref=as_li_qf_sp_asin_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=0307463745&amp;linkCode=as2&amp;tag=larpriandthee-20"><em>Rework</em> by Jason Fried and David Heinemeier Hansson</a> is a business advice book for keeping small, focused teams without all the cruft of business.</p>

<p>###My Opinion</p>

<p><em>Rework</em> is my kind of book. It&rsquo;s best described as business advice for hippy programmers. It&rsquo;s amazing that this book describes the business practices of a real company that&rsquo;s modestly successful.</p>

<p>Speaking of the authors of this book, they&rsquo;re the guys who made <a href="//rubyonrails.org/">Ruby on Rails</a>, which gives them street cred as far as I&rsquo;m concerned.</p>

<p>This is a book of proverbs. Ignore the real world. Start a business, not a startup. Build half a product, not a half-assed product. Meetings are toxic. Hire managers of one. ASAP is po:son.</p>

<p>When you look at it, this advice is not insightful: it&rsquo;s obvious. It just also happens to be against how modern-day companies work. And maybe this advice isn&rsquo;t useful for everyone; once a company stops following these rules, it seems difficult to change. The smaller and newer the company, the easier it is to avoid the issues introduced with bigger businesses.</p>

<p>This book talks about ideas being cheap. Implementing the idea is where all the work lies. Have an idea? Start working on it now. Find time. Go to bed an hour later. Watch an hour less of TV. Your idea is meaningless unless you actually follow through.</p>

<p>There&rsquo;s also good advice within this book for people who are pressured to overwork. Avoid workaholics: overworking hurts the decision-making processes, so people who are working more hours are just spending more hours making worse decisions. When employees work long hours, other employees are also influenced to work longer hours. More poeple making worse decisions? Count me out. Hire people with outside lives who go home at 5: busy people have to manage their time, and will thus find more efficient ways to accomplish their work.</p>

<h3 id="who-would-like-this:58492d7e20bc3d21938de48bfa9c4e4b">Who Would Like This</h3>

<p>Interested in starting a company? In making managerial changes within your current company? In making changes to the way you work? Reading this book can help you realize that you don&rsquo;t need all the modern-day business cruft to make your business a success.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2014-03-24-sticky-footer-with-twitter-bootstrap/">
        Sticky footer with Twitter Bootstrap
      </a>
    </h1>

    <span class="post-date">Mon, Mar 24, 2014</span>

    <p>Sometimes CSS is a total pain.</p>

<p>We encountered a major CSS problem while working on our incredible startup weekend project <a href="//ollert.herokuapp.com">Ollert</a>. We had created a footer that we wanted below all of our content. We threw together some quick HTML and got a footer below all of the main content, and it looked really good when our main content filled up the entire screen.</p>

<p>What about when there was very little data on the screen? Well, then the footer just floated in the middle of the page, staring at us like some kind of psychotic hummingbird, waiting to slice you up when you&rsquo;re not looking. We searched online and found lots of different solutions; None of them worked. The footer just floated there, taunting us; Telling us to cry home to mommy. So we gave up on the prospect for the rest of the afternoon.</p>

<p>A few days after startup weekend, I found the real solution from the good folks at <a href="//getbootstrap.com/2.3.2/examples/sticky-footer.html">Twitter Bootstrap</a> themselves. It&rsquo;s pretty simple, really. Hooray for the internet!</p>

<p>Below is the HTML to create this effect with all the CSS styles embedded. Marked up with plenty of comments.</p>

<p>``` html index.html
&lt;!DOCTYPE html&gt;
<html lang="en" style="height: 100%;">
  <head>
    <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
  </head>
  <body style="height: 100%;">
    <div id="wrap" style="min-height: 100%; height: auto !important; height: 100%; margin: 0 auto -50px;">
      &lt;!&ndash; All your content goes inside wrap. &ndash;&gt;
      &lt;!&ndash; The bottom margin must be negative the footer min-height &ndash;&gt;
      &lt;!&ndash; Footer min-height is set to 50px in this case &ndash;&gt;
      <div class="container">
        <div class="row">
          <div class="h1">
            All Your Content
          </div>
        </div>
        <div class="row">
          All your content will go inside the &lsquo;wrap&rsquo; div.
        </div>
      </div>
      <div id="push" style="min-height: 50px;">
        &lt;!&ndash; This push node should be inside wrap and empty &ndash;&gt;
        &lt;!&ndash; Min-height is equal to the min-height of the footer &ndash;&gt;
      </div>
    </div>
  <script>document.write('<script src="http://'
        + (location.host || 'localhost').split(':')[0]
		+ ':1313/livereload.js?mindelay=10"></'
        + 'script>')</script></body>
  <div id="footer" style="min-height: 50px;">
    &lt;!&ndash; Some sweet footer content &ndash;&gt;
    <div class="container">
      <div class="small">
        Zowee, I&rsquo;ve got a footer stuck to the bottom!
      </div>
    </div>
  </div>
</html></p>

<p>```</p>

<p>Div tag ids such as &ldquo;wrap&rdquo;, &ldquo;push&rdquo;, and &ldquo;footer&rdquo; can be whatever you want. The height of the footer can be adjusted to fit whatever content you want; I found that using <code>min-height</code> instead of <code>height</code> allowed my content to resize appropriately when wrapped. Styles should definitely be moved to a css file.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2014-03-22-made-to-stick/">
        Made to Stick
      </a>
    </h1>

    <span class="post-date">Sat, Mar 22, 2014</span>

    <blockquote>
<p>Knowledge curses us, if we find it hard to imagine what it was like not to know it. And it becomes difficult to share our knowledge with others because we can&rsquo;t readily re-create our listener&rsquo;s state of mind.</p>
</blockquote>

<p>###The Gist</p>

<p><a href="http://www.amazon.com/gp/product/1400064287/ref=as_li_qf_sp_asin_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=1400064287&amp;linkCode=as2&amp;tag=larpriandthee-20"><em>Made to Stick</em> by brothers Chip Heath and Dan Heath</a> tries to uncover why some ideas capture our imagination while others fall into the abyss, never to be seen again.</p>

<p>###My opinion</p>

<p>I really enjoyed this book. I tend to read very technical books, so this was a nice change of pace. I coincidentally was reading this book while coming up with a &lsquo;pitch&rsquo; for my recent SEP Startup Weekend project, <a href="//ollert.herokuapp.com">Ollert</a>.</p>

<p><em>Made to Stick</em> lays out examples of really good and really mediocre descriptions of ideas. The authors then use the concepts discussed within the book to improve these ideas or discuss why they are effective. Whenever I hear people explaining real-world ideas, I start to think about the concepts laid out in this book. I&rsquo;d like to be able to use these concepts to communicate my own ideas more effectively, but I have thus far found it to be easier said than done.</p>

<p>The book is not terribly long. This allowed me to connect all the concepts and better critique the numerous examples.</p>

<p>Although I did enjoy the book, a few of the sections came off a little bit like a self-help program. The concepts described in the book are &lsquo;Simplicity&rsquo;, &lsquo;Unexpectedness&rsquo;, &lsquo;Concreteness&rsquo;, &lsquo;Credibility&rsquo;, &lsquo;Emotional&rsquo;, and &lsquo;Stories&rsquo;, which &ldquo;just happen&rdquo; to spell out <em>most</em> of the word &ldquo;success.&rdquo; This silly feel-goodery acronym makes the cynical side of me cringe.</p>

<p>###Who Would Like This</p>

<p>Anyone trying to communicate a new idea to someone else could benefit from this book. On a broader scope, this book can benefit your communication patterns in general. This is particularly helpful for professionals, who may have a difficulty expressing their ideas without getting too deep in the technicalities.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2014-03-20-using-the-trello-api-in-ruby/">
        Using the Trello API in Ruby
      </a>
    </h1>

    <span class="post-date">Thu, Mar 20, 2014</span>

    <p>So, you want to gather data using the <a href="//trello.com">Trello</a> API so that you can <a href="//ollert.herokuapp.com">do something cool with it</a>? And you&rsquo;re using <a href="//ruby-lang.org">Ruby</a>? Enter <a href="//github.com/jeremytregunna/ruby-trello">ruby-trello</a>. Install!</p>

<pre><code class="language-bash">$ gem install ruby-trello
</code></pre>

<p>We&rsquo;ll start off easy, and assume that we&rsquo;re writing a personal application where we only need to access data for one user at a time. We start by configuring ruby-trello. I&rsquo;m going to assume that you&rsquo;ve already generated a public key and received a member token and stored them in your environment.</p>

<p>``` ruby global_config_test.rb
require &lsquo;trello&rsquo;</p>

<p>Trello.configure do |config|
  # API key generated by visiting <a href="https://trello.com/1/appKey/generate">https://trello.com/1/appKey/generate</a>
  config.developer_public_key = ENV[&lsquo;PUBLIC_KEY&rsquo;]</p>

<p># Member token
  # larry-price.com/blog/<sup>2014</sup>&frasl;<sub>03</sub>/18/connecting-to-the-trello-api/
  config.member_token = ENV[&lsquo;MEMBER_TOKEN&rsquo;]
end</p>

<pre><code>
This connects me to a specific member as found through `ENV['MEMBER_TOKEN']`. I previously wrote [another post](/blog/2014/03/18/connecting-to-the-trello-api/) about getting a member token from a user.

For demonstration, I'll find myself, grab my first board, and then display the name, names of lists, members who have worked on the project, and some numbers about each of the cards in the board. This is essentially my proof of concept for a [super-cool web-app I wrote](/blog/2014/03/17/sep-startup-weekend-ollert/) called [Ollert][ollert].

``` ruby global_config_test.rb
...

# find myself
me = Trello::Member.find(&quot;_larryprice&quot;)

# find first board
board = me.boards.first
puts board.name
puts &quot;Lists: #{board.lists.map {|x| x.name}.join(', ')}&quot;
puts &quot;Members: #{board.members.map {|x| x.full_name}.join(', ')}&quot;
board.cards.each do |card|
      puts &quot;- \&quot;#{card.name}\&quot;&quot;
      puts &quot;-- Actions: #{card.actions.nil? ? 0 : card.actions.count}&quot;
      puts &quot;-- Members: #{card.members.count}&quot;
      puts &quot;-- Labels: #{card.labels.count}&quot;
end
</code></pre>

<p>Wow, cool! Such data! This is really great for a single user because we only have to make the connection to Trello once (which is not incredibly fast). However, this won&rsquo;t work in a multi-user environment since we configured ruby-trello to use a specific member token. So how do we connect to multiple members at a time? Let&rsquo;s print out the same data we did above for a single user, but using <code>Trello::Client</code> to connect to Trello.</p>

<p>``` ruby client_test.rb
require &lsquo;trello&rsquo;</p>

<p>me = Trello::Client.new(
  :developer_public_key =&gt; ENV[&lsquo;PUBLIC_KEY&rsquo;],
  :member_token =&gt; ENV[&lsquo;MY_MEMBER_TOKEN&rsquo;]
)</p>

<p>you = Trello::Client.new(
  :developer_public_key =&gt; ENV[&lsquo;PUBLIC_KEY&rsquo;],
  :member_token =&gt; ENV[&lsquo;YOUR_MEMBER_TOKEN&rsquo;]
)</p>

<p>[me, you].each do |user|
  puts user.fullname
  board = user.boards.first
  puts board.name
  puts &ldquo;Lists: #{board.lists.map {|x| x.name}.join(&lsquo;, &lsquo;)}&rdquo;
  puts &ldquo;Members: #{board.members.map {|x| x.full_name}.join(&lsquo;, &lsquo;)}&rdquo;
  board.cards.each do |card|
        puts &ldquo;- \&ldquo;#{card.name}\&ldquo;&rdquo;
        puts &ldquo;&ndash; Actions: #{card.actions.nil? ? 0 : card.actions.count}&rdquo;
        puts &ldquo;&ndash; Members: #{card.members.count}&rdquo;
        puts &ldquo;&ndash; Labels: #{card.labels.count}&rdquo;
  end
end
```</p>

<p>Now, as your friend and teacher, I command you to use this knowledge to go <a href="//ollert.herokuapp.com">do cool stuff</a> with Trello!</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2014-03-18-connecting-to-the-trello-api/">
        Connecting to the Trello API
      </a>
    </h1>

    <span class="post-date">Tue, Mar 18, 2014</span>

    <p><a href="//trello.com">Trello</a> has a <a href="//trello.com/docs/">pretty sweet API</a>, which we use extensively in our Trello-analysis app <a href="//ollert.herokuapp.com">Ollert</a>. Initially connecting to the Trello API took us a few hours, so I&rsquo;d like to make a record of how we managed to connect.</p>

<p>Making a connection to Trello requires two hashcodes: an application key and a Trello member token. You can generate and view your application key by visiting <a href="//trello.com/1/appKey/generate">https://trello.com/1/appKey/generate</a>.</p>

<p>The member token is something we need to get from the user. There are two ways to get a user&rsquo;s member token: through fragments and through a <strong>postMessage</strong>. You can also request different levels of access (read, write, read+write), and different expiration periods (such as 1 day, 30 days, or never) for member tokens. For the remainder of this writing, I&rsquo;ll be accessing a read-only member token that never expires.</p>

<p>We didn&rsquo;t have a lot of luck with fragments, but the concept is simple enough. You have the user click a link that probably says &ldquo;Connect With Trello&rdquo; which is similar to:</p>

<p><code>https://trello.com/1/authorize?key=applicationkey&amp;name=applicationname&amp;expiration=never&amp;response_type=token</code></p>

<p>At this point, the user is redirected to Trello and given the opportunity to Allow or Deny your application access. Once allowed, the user sees a static Trello page with their member token in plain text. Somehow you&rdquo;re supposed to convey to them that they should copy this token and paste it back to you. This has clear drawbacks in usability.</p>

<p>Using the <strong>postMessage</strong> method of accessing a member token was significantly more fruitful. Trello provides a Javascript file named <a href="https://trello.com/docs/gettingstarted/clientjs.html">client.js</a> that does most of the legwork for you. An example:</p>

<pre><code class="language-haml">%script{src: &quot;//api.trello.com/1/client.js?key=applicationkey&quot;}

function AuthenticateTrello() {
  Trello.authorize({
    name: &quot;YourApplication&quot;,
    type: &quot;popup&quot;,
    interactive: true,
    expiration: &quot;never&quot;,
    persist: true,
    success: function () { onAuthorizeSuccessful(); },
    scope: { write: false, read: true },
  });
}
function onAuthorizeSuccessful() {
  var token = Trello.token();
  window.location.replace(&quot;/auth?token=&quot; + token);
}

%a{href: &quot;javascript:void(0)&quot;, onClick: &quot;AuthenticateTrello()&quot;}
  Connect With Trello
</code></pre>

<p>When the user clicks the link, we have Trello set to activate a &ldquo;popup&rdquo; that will ask them to &ldquo;Allow&rdquo; or &ldquo;Deny&rdquo; our app from accessing their data. When the user allows us access, the popup closes and we hit the &ldquo;onAuthorizeSuccessful&rdquo; method. In my method, I simply redirect them to the <code>/auth</code> route with <code>token</code> manually added to the params list. One of the interesting options listed above is the &ldquo;persist&rdquo; option, which tells Trello whether it should prompt the user for his or her token every time. By telling Trello to persist, the user will only be presented with the popup when he or she needs to reauthenticate.</p>

<p>You can learn more about member tokens from <a href="//trello.com/docs/gettingstarted/authorize.html">https://trello.com/docs/gettingstarted/authorize.html</a>.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2014-03-17-sep-startup-weekend-ollert/">
        SEP Startup Weekend: Ollert
      </a>
    </h1>

    <span class="post-date">Mon, Mar 17, 2014</span>

    <p>Last weekend was <a href="//sep.com">SEP</a>&rsquo;s 6th Semi-Annual <a href="//sep.com/labs/startupweekend/">Startup Weekend</a>. For those unfamiliar, software developers pitch ideas Friday evening and developers volunteer their time to come up with a <a href="//en.wikipedia.org/wiki/Minimum_viable_product">minimum viable product</a> in the next 48 hours. Free beer is the only thing that makes such a weekend possible.</p>

<p>I&rsquo;ve been before and participated in other people&rsquo;s projects and it&rsquo;s always a blast. However, this weekend was different: I had an idea to pitch. Although the idea went through many names, the core concept remained the same:</p>

<blockquote>
<p>To tell Trello users what their boards say about the past and the future through unique visuals.</p>
</blockquote>

<p><a href="//trello.com">Trello</a> is a collaborative workflow management tool that does a wonderful job of showing you the present. There is currently no way on Trello to see your past history or compare yesterday&rsquo;s weather. This simplicity is part of the beauty of Trello, but also an opportunity.</p>

<p>My idea was to create a web application where a user could quickly and easily connect with Trello and view information he or she had never seen previously. I would offer a trial service requiring no login that would allow access to all this data, given that the user puts up with authenticating with Trello every time he or she visits the site. There would be a free membership, which would allow the user to &ldquo;permanantly&rdquo; connect to Trello. To monetize, I wanted to offer a paid membership, where the user would be given the ability to compare &ldquo;historical&rdquo; Trello data by selecting begin and end dates for the Trello data that is analyzed.</p>

<p><a href="//ollert.herokuapp.com">Ollert</a> is the result of this Startup Weekend idea. A live version of Ollert can be found at <a href="//ollert.herokuapp.com">ollert.herokuapp.com</a>.</p>

<p>I worked on <a href="//ollert.herokuapp.com">Ollert</a> with 5 other great developers, and we got a spectacular amount of work done given that we only spent a single weekend programming. We were able to direct users to connect with Trello, let them select a board, and then generate and display 12 different statistics and analyses. We also implemented Sign Up/Login.</p>

<p>We worked on <a href="//ollert.herokuapp.com">Ollert</a> to the last minute, so not everything got in. We never implemented the paid member feature and we didn&rsquo;t get in all the analytics we wanted. We also had some great ideas come out while we were working on <a href="//ollert.herokuapp.com">Ollert</a> that didn&rsquo;t make it into the application, such as filtering chart types and selecting favorites.</p>

<p>Overall, my teammates and I had a great time and we are confident that we&rsquo;ve created something useful.</p>

<p>My current intention is to do several more blog posts about <a href="//ollert.herokuapp.com">Ollert</a> including Connecting to the Trello API, Using ruby-trello, Using sqlite on Heroku, What I Should Have Had Ready Before Asking People To Work For Me, and The Future of Ollert.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2014-02-22-using-x-editable-to-do-in-line-editing-for-you/">
        Using x-editable to do in-line editing for you
      </a>
    </h1>

    <span class="post-date">Sat, Feb 22, 2014</span>

    <p>In-line editing is traditionally difficult. Taking a static HTML node and turning it into an editable text field and then sending that data off somewhere is a little bit more Javascript than I like to write. My team and I came up against a very difficult UX problem which I spent over a week trying to understand. After building and discussing several solutions, we eventually decided to narrow the scope of what the user should be able to change. We would present the user with a table where one of the columns would be editable.</p>

<p>Rather than showing a table with the third column always as a field for text entry, I used the Javascript library <a href="//vitalets.github.io/x-editable/">X-editable</a>. X-editable allows me to display my editable item as a link. When the user clicks the item, the link turns into a text field with a Save/Cancel button (and a &lsquo;clear&rsquo; button as a bonus). The &lsquo;Save&rsquo; button submits an AJAX &lsquo;POST&rsquo; or &lsquo;PUTS&rsquo;, where we are then allowed to validate and save the data. The &lsquo;Cancel&rsquo; button turns the text field back into a link with the original value.</p>

<p>Hooray, someone else has already done the hard work for us! So, what I want to do is dynamically generate a table with objects and allow the user to edit one of the columns. In my case, only the end column is editable, but I could just as easily spread this availability to all my columns. I&rsquo;m using all my favorite tools to create this page, specifically <a href="//ruby-lang.org/en/">ruby</a>, <a href="//sinatrarb.com">Sinatra</a>, <a href="//getbootstrap.com">Twitter Bootstrap</a>, and <a href="//haml.info">HAML</a>.</p>

<p>X-editable has implementations using Bootstrap, jQuery UI, and jQuery. Since I&rsquo;m already using Bootstrap in my app, I&rsquo;m going to go with that version. Note that there are Bootstrap 2 and Bootstrap 3 builds of X-editable, and I&rsquo;m using the Bootstrap 3 variety.</p>

<p>First I include the necessary files at the top of my HAML document.</p>

<p>``` haml /views/manage_data.haml
%script{src: &ldquo;//code.jquery.com/jquery.js&rdquo;}
%script{src: &ldquo;//getbootstrap.com/dist/js/bootstrap.min.js&rdquo;}
%link{href: &ldquo;//getbootstrap.com/dist/css/bootstrap.min.css&rdquo;, rel: &ldquo;stylesheet&rdquo;}</p>

<p>%link{href: &ldquo;//cdnjs.cloudflare.com/ajax/libs/x-editable/1.5.0/bootstrap3-editable/css/bootstrap-editable.css&rdquo;, rel: &ldquo;stylesheet&rdquo;}
%script{src: &ldquo;//cdnjs.cloudflare.com/ajax/libs/x-editable/1.5.0/bootstrap3-editable/js/bootstrap-editable.min.js&rdquo;}</p>

<pre><code>
I'm going to dumb my page down so I only have to show the important parts. I'm going to create a table from an array of hashes called `@options`. Each hash has two important fields for this table: Points and Dollars. I will iterate over `@options`, displaying the `points` field as plain text and the `dollars` field as an X-editable link. Each hash also has a `value` field containing the primary key for the object to be edited.

``` haml /views/manage_data.haml
.container
  .row
    .col-md-6
      %table{id: &quot;edit_points_goal&quot;, class: &quot;table table-responsive table-hover table-bordered&quot;}
        %thead
          %tr
            %th{width: &quot;35%&quot;}
              Points
            %th{width: &quot;65%&quot;}
              Dollars
        %tbody
          - @options.each do |option|
            %tr
              %td{style: &quot;height: 45px; padding: 4px 8px; vertical-align: middle;&quot;}
                #{option[:points]}
              %td{style: &quot;height: 45px; padding: 4px 8px; vertical-align: middle;&quot;}
                %a{href:&quot;javascript:void(0)&quot;, &quot;data-type&quot;=&gt;&quot;text&quot;, &quot;data-pk&quot;=&gt;&quot;#{option[:value]}&quot;, &quot;data-url&quot;=&gt;&quot;/update&quot;, &quot;data-title&quot;=&gt;&quot;Enter dollar amount&quot;}
                  #{option[:dollars]}
</code></pre>

<p>The important part is the <code>a</code> tag:</p>

<ul>
<li><code>href</code> goes nowhere.</li>
<li><code>data-type</code> tells X-editable how it will edit the presented data. According to the docs, types include text, textarea, select, date, checklist and more.</li>
<li><code>data-pk</code> is the primary key of our data in the database. In my case, that comes to me stored in the <code>value</code> field of the option hash.</li>
<li><code>data-url</code> is the <code>post</code> method that will be used to interpret the data.</li>
<li><code>data-title</code> is used to tell the user what to do.</li>
</ul>

<p>Our code won&rsquo;t do anything yet seeing as it&rsquo;s not connected. We need some Javascript to do that. I put the Javascript at the top of my file, underneath the included files. The first thing we need to do is tell X-editable what type of editing we&rsquo;ll be doing. The options are in-line editing or a pop-up. I want the in-line editing in this case. The second thing I want to do is to set the <code>editable</code> attribute on the appropriate DOM objects. Since I&rsquo;m using an array, I found the easiest way to do this was to start at the table&rsquo;s id (edit_points_goal) and trace down to the <code>a</code> tag.</p>

<p>``` haml /views/manage_data.haml
:javascript
  $.fn.editable.defaults.mode = &lsquo;inline&rsquo;;</p>

<p>$(document).ready(function() {
    if (#{vm.editable}) {
      $(&lsquo;#edit_points_goal tbody tr td a&rsquo;).editable();
    }
  });</p>

<pre><code>
Now we need to deal with the `post` request. If you're really impatient to see things work, you should be able to see your in-line editable code in action, but the `post` call will fail with a &quot;NoMethodError.&quot;

Our `post` is going to be really simple. We verify that we have a non-negative integer and we either save and return 200 or we return 400 with an appropriate message. Our table in this example is just called `Data`, and we use `find` to get a value out of the database.

``` ruby web.rb
post &quot;/update&quot; do
  data = Data.find(id: params[&quot;pk&quot;])

  unless params[&quot;value&quot;].match(/[^0-9]/)
    data = params[&quot;value&quot;].to_i
    data.save
    return 200
  end

  return {400, [], &quot;Please enter a valid non-negative number&quot;}
end
</code></pre>

<p>Things should be working now. When you enter good data and click the &lsquo;Ok&rsquo; button, our <code>post</code> will be called and the text field will turn back into a link. When you enter bad data, you should see our error message below the text field box.</p>

<p>Issues I encountered:</p>

<ul>
<li>Table column width shifting - Fixed by setting the widths explicitly, as seen above (35% and 65%).</li>
<li>Table height shifting - Fixed by setting the style of the <code>td</code> as seen above to give a larger height, more padding, and aligning the inner objects explicitly. I would recommend moving this definition to a <code>.css</code> or <code>.scss</code> file.</li>
<li>&ldquo;NoMethodError&rdquo; after clicking Go - Unfortunately, if you made any coding errors in your route, you won&rsquo;t be able to see the Sinatra error page but will instead you&rsquo;ll be presented with a giant wall of HTML below the text box. Try to parse this error, but if you struggle to find out what went wrong you can always substitute a form-post method in place of the <code>a</code> tag, which may allow you to more easily figure out the problem.</li>
</ul>

<p>The <a href="//vitalets.github.io/x-editable/docs.html">X-editable docs</a> are extremely helpful for beginners. There is even more detail on the X-editable site, including editing multiple items, editing dates, and using a pop-up to edit the data.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2014-02-22-let-me-be-a-billboard-for-duckduckgo-for-a-few-minutes/">
        Let me be a billboard for DuckDuckGo for a few minutes
      </a>
    </h1>

    <span class="post-date">Sat, Feb 22, 2014</span>

    <p>I would describe my job as 10% cleverness, 10% tenacity, 30% historical knowledge, and 50% searching the internet.</p>

<p>As you can see, a good search engine is extremely important to me. My job depends on it. Opening <a href="//www.chromium.org/Home">Chromium&rsquo;s</a> history, I can see that I have recently searched for microwaves, <a href="//rubygems.org/gems/activesupport">activesupport</a> compatibility in <a href="//www.ruby-lang.org/en/">ruby 2.1.0</a>, deleting branches in git, and glibc backwards compatibility.</p>

<p>I don&rsquo;t use <a href="//google.com">Lord Google</a> as my default search engine. Instead I use <a href="//duckduckgo.com">DuckDuckGo</a>. From <a href="//en.wikipedia.org/wiki/Duck_Duck_Go">Wikipedia</a>:</p>

<blockquote>
<p>DuckDuckGo is an Internet search engine that emphasizes protecting searchers&rsquo; privacy and avoiding the &ldquo;filter bubble&rdquo; of personalized search results. DuckDuckGo distinguishes itself from other search engines by not profiling its users and by deliberately showing all users the same search results for a given search term. DuckDuckGo also emphasizes getting information from the best sources rather than the most sources&hellip;.</p>
</blockquote>

<p>The gist is that DuckDuckGo does not personalize your search results based on demographics or search history. It doesn&rsquo;t store your IP address and it doesn&rsquo;t log your information. You cannot &ldquo;log in&rdquo; to the DuckDuckGo website.</p>

<p>Getting down to brass tacks: How does it do search?</p>

<p>Searching on DuckDuckGo for queries such as &ldquo;Will Ferrell&rdquo; or &ldquo;Markdown&rdquo; will give you a blurb at the top of your search results from Wikipedia about that matching query. Searching programming topics (like &ldquo;ruby random array&rdquo; or &ldquo;asp.net create table&rdquo;) will give you a near-matching StackOverflow answer. Searching for a single word will usually give you the definition.</p>

<p>A query that seems mistyped will ask you if you want to correct it. Search speed is comparable to Google, I&rsquo;ve noticed no difference.</p>

<p>Looking at the result of your query, you get your search results middle-aligned. <strong>Middle. Aligned</strong> I know you probably don&rsquo;t think that&rsquo;s a big deal, but go do a Google search right now. It&rsquo;s left-aligned. Same with <a href="//bing.com">Bing</a>. Do you see what&rsquo;s on the right half of your monitor? <strong>Nothing.</strong> When running a Google search with my 22&rdquo; monitor (~19&rdquo; of horizontal space), there are 13&rdquo; of wasted space. About 9&rdquo; on Bing.</p>

<p>So, you&rsquo;ve just done a search on DuckDuckGo. Now you can use the Up/Down arrows on your keyboard to navigate the search results. Pressing Enter takes you to the website. I vaguely remember that Google used to allow this, but it seems to have disappeared from the default search results.</p>

<p>Don&rsquo;t like being able to see the combined search results of 50+ search engines? !Bang syntax is the answer.</p>

<p>What is !bang syntax? Let&rsquo;s say you&rsquo;re me and you&rsquo;re looking for over-the range microwaves. I type into my DuckDuckGo search <code>microwaves !a</code> and DuckDuckGo takes me straight to <a href="//amazon.com">Amazon</a>, showing me search results for all those sweet, sweet microwaves. <code>!g</code> takes you to Google, <code>!w</code> takes you to Wikipedia, <code>!gi</code> takes you to Google Images, <code>!yt</code> takes you to Youtube, <code>!lowes</code> takes you to the Lowe&rsquo;s search results, <code>!gog</code> takes you to Good Ol&rsquo; Games, and <a href="//duckduckgo.com/bang.html">on and on and on and on and on</a>.</p>

<p>There are <a href="//duckduckgo.com/goodies">100s of other goodies</a> as well. Do math using an &ldquo;=&rdquo; sign, like &ldquo;=128*256&rdquo;. Find &ldquo;Hello, World&rdquo; examples by searching for &ldquo;hello world perl&rdquo; or &ldquo;hello world clojure&rdquo;. Do a Twitter hashtag search to find out what &ldquo;#yolo&rdquo; means. Currency conversions. Unit conversions. Convert between timezones.</p>

<p>Okay, enough shameless plugging for my favorite search engine. Give it a chance. Let those Google servers cool down for a few microseconds, they won&rsquo;t mind.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2014-02-22-convincing-rvm-to-let-you-use-ruby-2-dot-1-0/">
        Convincing rvm to let you use ruby 2.1.0
      </a>
    </h1>

    <span class="post-date">Sat, Feb 22, 2014</span>

    

<p><a href="//ruby-lang.org/en/news/2013/12/25/ruby-2-1-0-is-released/">Ruby 2.1.0 went stable</a> a few months ago, and <a href="//ruby-lang.org/en/news/2014/01/10/ruby-1-9-3-will-end-on-2015/">Ruby 1.9.3 support</a> will end in a just over a year.</p>

<p>You know what that means: Warplanes in the sky falling to the ground, dogs and cats getting along like old pals, and people wandering aimlessly through the streets trying to remember the last time they saw a green build.</p>

<p>Believe it or not, all of these things can be prevented. Once upon a time, I wrote about <a href="/blog/2013/10/08/rvm-quick-start/">configuring and using rvm</a> to control individual ruby environments for each of your projects. If it&rsquo;s been a while since you installed your copy of <a href="//rvm.io/">rvm</a>, you might have some trouble installing and using newer version of ruby. Lucky for us, those clever rvm developers made it easy to get around this.</p>

<p>In my case, I want to upgrade a project to use <code>ruby 2.1.0</code>. The first time I tried to run <code>rvm install ruby-2.1.0</code>, I ended up installing <code>ruby-2.1.0-preview1</code>. I realized that I had installed rvm on this machine around October 2013, and <code>ruby 2.1.0</code> was released in December 2013, so rvm had no idea that <code>ruby 2.1.0</code> was stable. Updating rvm (in the root of the project directory):</p>

<p>``` bash /home/lrp/Projects/2014/projNeedingRuby210
$ rvm get stable</p>

<pre><code>
There will be some amount of text on the screen if your system needs to be updated. Note that you must be connected to the internet if you want rvm to update. Now we do the install of our brand new ruby:

``` bash /home/lrp/Projects/2014/projNeedingRuby210
$ rvm install ruby-2.1.0
</code></pre>

<p>Again, text on the screen from fetching of data from the internet. But hopefully you see something that tells you the operation was successful. You can also verify which rubies you have installed using the <code>list</code> command:</p>

<p>``` bash /home/lrp/Projects/2014/projNeedingRuby210
$ rvm list rubies
   ruby-1.9.3-p448 [ x86_64 ]
=&gt; ruby-2.0.0-p247 [ x86_64 ]
 * ruby-2.1.0 [ x86_64 ]</p>

<h1 id="current:48edce78deba1629795925e6d06bbb9a">=&gt; - current</h1>

<h1 id="current-default:48edce78deba1629795925e6d06bbb9a">=* - current &amp;&amp; default</h1>

<h1 id="default:48edce78deba1629795925e6d06bbb9a">* - default</h1>

<pre><code>
Now we tell our current project to use `ruby 2.1.0`:

``` bash /home/lrp/Projects/2014/projNeedingRuby210
$ rm .ruby-version .ruby-gemset
$ rvm 2.1.0@projNeedingRuby210 --create --ruby-version
ruby-2.1.0 - #gemset created /home/lrp/.rvm/gems/ruby-2.1.0@projNeedingRuby210
ruby-2.1.0 - #generating projNeedingRuby210 wrappers.
$ rvm gemset copy 2.0.0-p247@projNeedingRuby210 2.1.0@projNeedingRuby210
Copying gemset from 2.0.0-p247@projNeedingRuby210 to 2.1.0@projNeedingRuby210
Generating gemset wrappers ruby-2.1.0@projNeedingRuby210.
Making gemset 2.1.0@projNeedingRuby210 pristine.
$ which ruby
/home/lrp/.rvm/rubies/ruby-2.1.0/bin/ruby
</code></pre>

<p>Alright! Crisis averted. If you&rsquo;re using <a href="//bundler.io/">bundler</a> with this project, be sure to change your ruby version (usually located near the top of the <code>Gemfile</code>).</p>

<p>What about setting up a new project using <code>ruby 2.1.0</code>? Easy! Switch to the project directory and:</p>

<p><code>bash /home/lrp/Projects/2014/newRubyProject
$ rvm 2.1.0@newRubyProject --create --ruby-version
</code></p>

<p>Oh, rvm, you make life <em>too</em> easy sometimes.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2014-02-13-letting-the-browser-decide-betwen-http-and-https/">
        Letting the Browser Decide Betwen HTTP and HTTPS
      </a>
    </h1>

    <span class="post-date">Thu, Feb 13, 2014</span>

    <p>While working on SEP Labs&rsquo; <a href="//h2w.cc">Health2Wealth</a> app, I got my first taste of setting up a website to use secure connections. I&rsquo;ve been using the browser extension <a href="//www.eff.org/https-everywhere">HTTPS Everywhere</a> for quite some time now, so all of the web pages that I visit attempt to using <code>HTTPS</code>instead of the standard <code>HTTP</code>. When I inadvertently started testing our app with <code>HTTPS</code>, things got a little weird.</p>

<p>My machine was able to open most of a page, but it wouldn&rsquo;t load some of the graphics or javascript we had embedded in the page. I was the only one able to reproduce it, so we chalked it up to a wonky machine. Then I suddenly remembered that I was using HTTPS Everywhere. I found the area in FireFox that warns you about insecure connections and found that our page was only <em>partially</em> loading on my browser because some of the content was insecure. From there I enabled an option to reveal the insecure elements, which forced my page to load everything correctly. So now we needed to find what was insecure about our page. I trekked through the codebase and found that some of our graphs and links were hard-coded to use <code>HTTP</code>. My initial thought was just to force them to use <code>HTTPS</code>, which is <a href="//lists.w3.org/Archives/Public/ietf-http-wg/2013OctDec/0625.html">almost certainly the impending standard</a>. With a quick search, I found that there exists a <strong>real</strong> solution to this problem.</p>

<p>Let&rsquo;s say I have a very normal web application, so I want to include <a href="//jquery.com">jQuery</a> embedded in my page. I initially copy-paste <code>&lt;script src='http://code.jquery.com/jquery.js'&gt;&lt;/script&gt;</code> right into my <code>&lt;head&gt;</code> node, which normally seems fine. Unfortunately, this is where issues arise. I&rsquo;m now forcing the user to make a connection which may or may not be secure to fetch data from an insecure page.</p>

<p>By removing the <code>http:</code> from the <code>http://</code>, the issue of deciding whether to fetch the file using <code>HTTP</code> or <code>HTTPS</code> is left to the web browser. So my script include becomes <code>&lt;script src='//code.jquery.com/jquery.js'&gt;&lt;/script&gt;</code>. This also works for links, images, and web fonts. In fact, every link included in this post uses the same principal, where I leave the protocol out of what becomes the <code>href</code> tag.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2014-02-12-custom-domain-with-github-pages/">
        Custom Domain with Github Pages
      </a>
    </h1>

    <span class="post-date">Wed, Feb 12, 2014</span>

    <p>As of today, I&rsquo;m the proud owner of <a href="//larry-price.com">larry-price.com</a>. On the recommendation from a friend, I used <a href="//domainmonster.com">domainmonster.com</a> for it&rsquo;s cost effectiveness and usable toolset. I wanted to link my Github Pages blog (this blog!) to my new site. In case I ever want to do this again, I&rsquo;ve provided myself (and you!) with a step-by-step guide below. Note that Github <a href="//help.github.com/articles/setting-up-a-custom-domain-with-pages">has a page that explains how to do this</a>, but there&rsquo;s some fluff and ordering issues that turned me off from using those instructions as any more than a reference.</p>

<p>####Step 0: Buy your domain####</p>

<p>All sites where you can purchase domains have the same domains available, but at different prices. From the sites I perused, <a href="//godaddy.com">GoDaddy</a> had the best search for domain names, suggesting different variations on the searched domain name. I found that <a href="//domainmonster.com">domainmonster.com</a> had the ugliest UI but the best prices. <a href="//hover.com">Hover.com</a> looked really modern and had moderate prices. Shop around and spend money.</p>

<p>####Step 0.5: Exercise restraint####</p>

<p>At this point in the process, <strong>don&rsquo;t go to your site</strong>.</p>

<p>My guess is you already have. If you don&rsquo;t have the ability to go back in time, don&rsquo;t sweat it, just know that you probably won&rsquo;t be able to verify the fruits of your labor for a few hours.</p>

<p>####Step 1: Setting up an &lsquo;A Record&rsquo;####</p>

<p>Find the ip address where your site is currently hosted. For me (replace URL with your own):</p>

<pre><code class="language-bash">$ nslookup larryprice.github.io
Server:   127.0.1.1
Address:  127.0.1.1#53

Non-authoritative answer:
Name: larryprice.github.io
Address: 199.27.74.133
</code></pre>

<p>You should be able to &ldquo;manage&rdquo; your domain on your domain provider&rsquo;s website. In the &ldquo;management&rdquo; area, you should be able to find a section about &ldquo;DNS&rdquo;. Find something labeled &ldquo;A records.&rdquo; There will likely already be one or two entries here - one for the IP address of your new domain and one with the IP address of your domain with &ldquo;www.&rdquo; prepended.</p>

<p>Modify the entry (or entries) with the IP address found using <code>nslookup</code> (&ldquo;199.27.74.133&rdquo; from the example above). Save your site settings.</p>

<p>####Step 2: Mucking with the &ldquo;www&rdquo; instance####</p>

<p>While we&rsquo;re modifying these settings, we might as well move the &lsquo;www&rsquo; case out of the &ldquo;A records&rdquo;. Go ahead and delete it.</p>

<p>Look for something named &ldquo;CNAME records&rdquo;, or figure out how to add records in general. We&rsquo;re going to add a CNAME record where the &ldquo;Alias&rdquo; is &ldquo;www&rdquo; and the &ldquo;Address&rdquo; is your site&rsquo;s name. In my case, my &ldquo;Alias&rdquo; field is &ldquo;www&rdquo; and my &ldquo;Address&rdquo; field is &ldquo;larry-price.com&rdquo;. Add the record and cross your fingers for success.</p>

<p>####Step 3: Telling Github Pages what to do####</p>

<p>Alhtough Github Pages is magical in its own right, it doesn&rsquo;t know what to do when receiving a request from the &ldquo;A record&rdquo; we created in Step 2 without further instruction.</p>

<p>If you&rsquo;re using Github Pages for a user page, we are going to make this change on the <code>master</code> branch. If this is a project page, do it on the <code>gh-pages</code> branch.</p>

<p>All we have to do is put our new domain into a file in the root folder called <code>CNAME</code>. Let&rsquo;s do it in one fell swoop of the command line.</p>

<pre><code class="language-bash">$ echo &quot;larry-price.com&quot; &gt; CNAME 
</code></pre>

<p>Push that to Github and wait 0 to 10 minutes for Github to refresh your page.</p>

<p>Note: If you&rsquo;re one of the few, the proud using the brilliant <a href="//octopress.org/">Octopress</a> to generate your blog, you want to make sure to add the <code>CNAME</code> file to the root of your <code>source/</code> directory. That way, when you call <code>deploy</code> your <code>CNAME</code> file will end up in the root of your <code>_deploy</code> directory.</p>

<p>####Step 4: Behold####</p>

<p>Check your Github repository&rsquo;s &ldquo;Settings&rdquo; section. In the &ldquo;GitHub Pages&rdquo; section, you should now see something along the lines of &ldquo;Your site is published at <a href="http://larry-price.com&quot;">http://larry-price.com&quot;</a>. Go, young one, and visit your new site; and behold the glory you have brought to your family.</p>

<p>I&rsquo;ll note that this is the point where not obeying Step 0.5 will cause issues. Once your internets knows that your page hit a certain DNS, it takes a few hours to refresh. In my case it only took about 2 hours, but it may take between 12 and 48 hours to refresh. A workaround to see if everything is working is to pull out your smart phone and use your carrier&rsquo;s network to check your new site, since that area of the internets is probably still untainted. (All of this paragraph is a simplified thought process on how DNS works, considering that&rsquo;s the level I understand it.)</p>

<p>Now fly, my children, and spread yourself over the internet with dozens of silly domain names!</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2014-01-06-finishing-the-google-go-writing-web-applications-tutorial/">
        Finishing the Google Go Writing Web Applications Tutorial
      </a>
    </h1>

    <span class="post-date">Tue, Jan 7, 2014</span>

    <p>###A golang web app tutorial</p>

<p>I did some work with <a href="http://golang.org/">Google Go</a> recently and had the chance to follow their great tutorial <em><a href="http://golang.org/doc/articles/wiki/">Writing Web Applications</a></em>. The tutorial is pretty simple: use the Go http library to create a very simple wiki-style site. I like this tutorial a lot because there&rsquo;s not too much hand-holding, but they do eventually hand you the <a href="http://golang.org/doc/articles/wiki/final.go">final code listing</a>. Then the good people at Google give you the tall task of completing the following &lsquo;Other tasks&rsquo; without solutions:</p>

<ul>
<li>Store templates in tmpl/ and page data in data/.</li>
<li>Add a handler to make the web root redirect to /view/FrontPage.</li>
<li>Spruce up the page templates by making them valid HTML and adding some CSS rules.</li>
<li>Implement inter-page linking by converting instances of [PageName] to
<code>&amp;lt;a href=&quot;/view/PageName&quot;&amp;gt;PageName&amp;lt;/a&amp;gt;</code>. (hint: you could use regexp.ReplaceAllFunc to do this)</li>
</ul>

<p>This is what I&rsquo;d like to go over. I scoured the web and didn&rsquo;t have much luck finding solutions to these issues. That would be okay if they were all trivial, but the final step is not straightforward. I&rsquo;m going to assume you&rsquo;ve already gone over the tutorial. You can see <a href="https://github.com/larryprice/gowiki/">my repository on Github</a>, and I have included links to the appropriate commits in the code sections of this blog post.</p>

<p>####Store templates in tmpl/ and page data in data/</p>

<p>The tutorial originally has the developer store all pages in the project directory. Every time a user made a new wiki page, a new file would creep into the project directory. All HTML templates were also stored in the project directory.</p>

<p>Moving templates is quite trivial. In the global scope:</p>

<p>``` diff wiki.go <a href="https://github.com/larryprice/gowiki/commit/9994d11b5275bc5faee911e5db2c994bc91052e2">https://github.com/larryprice/gowiki/commit/9994d11b5275bc5faee911e5db2c994bc91052e2</a>
-var templates = template.Must(template.ParseFiles(&ldquo;edit.html&rdquo;, &ldquo;view.html&rdquo;))
+var templates = template.Must(template.ParseFiles(&ldquo;tmpl/edit.html&rdquo;, &ldquo;tmpl/view.html&rdquo;))</p>

<pre><code>
I found moving the page data to `data/` was a little trickier, especially if the directory didn't already exist. You may not have the same issue, but I remedied this by creating the directory if it doesn't exist. My `save` function differences:

``` diff wiki.go https://github.com/larryprice/gowiki/commit/e86a707d37b802b2d59b8ef261b3fdcab46d5870
func (p *Page) save() error {
-    filename := p.Title + &quot;.txt&quot;
-    return ioutil.WriteFile(filename, p.Body, 0600)
+  os.Mkdir(&quot;data&quot;, 0777)
+  filename := &quot;data/&quot; + p.Title + &quot;.txt&quot;
+  return ioutil.WriteFile(filename, p.Body, 0600)
}
</code></pre>

<p>####Add a handler to make the web root redirect to /view/FrontPage</p>

<p>All we&rsquo;re going to do is create a simple handler called <code>rootHandler</code> that redirects to a new page called <code>FrontPage</code>. We then add it in the <code>main</code> function. The tutorial had us wrap out handlers in a function call to take some special actions, but that wrapper would mess up our handler in its current form. So I just <code>Redirect</code> to the <code>view</code> handler, which will then decide whether to view or create the FrontPage.</p>

<p>``` diff wiki.go <a href="https://github.com/larryprice/gowiki/commit/e41fccc2d244a3b0d62d600d94897a076c87d53d">https://github.com/larryprice/gowiki/commit/e41fccc2d244a3b0d62d600d94897a076c87d53d</a>
+ func rootHandler(w http.ResponseWriter, r *http.Request) {
+   http.Redirect(w, r, &ldquo;/view/FrontPage&rdquo;, http.StatusFound)
+ }</p>

<p>&hellip;</p>

<p>func main() {
+  http.HandleFunc(&ldquo;/&rdquo;, rootHandler)
  http.HandleFunc(&ldquo;/view/&rdquo;, makeHandler(viewHandler))
  http.HandleFunc(&ldquo;/edit/&rdquo;, makeHandler(editHandler))
  http.HandleFunc(&ldquo;/save/&rdquo;, makeHandler(saveHandler))</p>

<pre><code>
####Spruce up the page templates by making them valid HTML and adding some CSS rules.

I took my old `.html` files and put them through [a validator](http://validator.w3.org/#validate_by_input). Making them valid only involved adding `DOCTYPE`, `html`, and `head` tags. The `head` tag needed `meta`, and `title` tags and we were valid. I've shown `view.html` below.

``` diff view.html https://github.com/larryprice/gowiki/commit/771b4ecc8a550ee438720dc5c3d3f47954a1e4ff
+&lt;!DOCTYPE html&gt;
+&lt;html&gt;
+&lt;head&gt;
+&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot;&gt;
+&lt;title&gt;Wiki made using Golang&lt;/title&gt;
+&lt;/head&gt;
 &lt;h1&gt;{{.Title}}&lt;/h1&gt;
 
 &lt;p&gt;[&lt;a href=&quot;/edit/{{.Title}}&quot;&gt;edit&lt;/a&gt;]&lt;/p&gt;
 
 &lt;div&gt;{{printf &quot;%s&quot; .Body}}&lt;/div&gt;
+&lt;/html&gt;
</code></pre>

<p>####Implement inter-page linking by converting instances of [PageName]</p>

<p>Converting [PageName] to a hyperlink was a bit more complicated than expected. I originally just tried to run the string through <code>ReplaceAllFunc</code> and replace all instance of [PageName] with an equivalent hyperlink. This does not work because we use Go&rsquo;s <code>ExecuteTemplate</code> method to render our template. <code>ExecuteTemplate</code> escapes any HTML that we give it to prevent us from displaying unwanted HTML. Getting around this was the fun part, because I want the benefit of escaped HTML while still having the ability to substitute my own HTML.</p>

<p>As it turns out, <code>ExecuteTemplate</code> will not escape variables of the type <code>template.HTML</code>. So I added another variable onto the <code>Page</code> struct called <code>DisplayBody</code>.</p>

<p>``` diff wiki.go <a href="https://github.com/larryprice/gowiki/commit/38c48717420de78f15dc48152ce16d1bdb417288">https://github.com/larryprice/gowiki/commit/38c48717420de78f15dc48152ce16d1bdb417288</a>
type Page struct {
     Title string
     Body  []byte
+    DisplayBody template.HTML
}</p>

<pre><code>
Next, I create a regular expression to find instances of \[PageName\] and I put the defintion above the `main` method.

``` diff wiki.go https://github.com/larryprice/gowiki/commit/38c48717420de78f15dc48152ce16d1bdb417288
+var linkRegexp = regexp.MustCompile(&quot;\\[([a-zA-Z0-9]+)\\]&quot;)
</code></pre>

<p>In my <code>viewHandler</code>, I escape <code>Body</code> and then set <code>DisplayBody</code> to that escaped string with the links substituted.</p>

<p>``` diff wiki.go <a href="https://github.com/larryprice/gowiki/commit/38c48717420de78f15dc48152ce16d1bdb417288">https://github.com/larryprice/gowiki/commit/38c48717420de78f15dc48152ce16d1bdb417288</a>
+  escapedBody := []byte(template.HTMLEscapeString(string(p.Body)))
+
+  p.DisplayBody = template.HTML(linkRegexp.ReplaceAllFunc(escapedBody, func(str []byte) []byte {
+      matched := linkRegexp.FindStringSubmatch(string(str))
+      out := []byte(&rdquo;<a href=\"/view/"+matched[1]+"\">&rdquo;+matched[1]+&rdquo;</a>&rdquo;)
+      return out
+    }))
  renderTemplate(w, &ldquo;view&rdquo;, p)
}</p>

<pre><code>
To finish up, I modify the `view.html` to show `DisplayBody`. I don't use `printf`, because that would turn `DisplayBody` back into a `string` and `ExecuteTemplate` would escape it.

``` diff wiki.go https://github.com/larryprice/gowiki/commit/38c48717420de78f15dc48152ce16d1bdb417288
-&lt;div&gt;{{printf &quot;%s&quot; .Body}}&lt;/div&gt;
+&lt;div&gt;{{.DisplayBody}}&lt;/div&gt;
</code></pre>

<p>And that completes the extra exercises for Google&rsquo;s <em>Writing Web Applications</em> tutorial. Hopefully one day this helps someone who gets stuck.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2013-12-15-setting-up-a-go-environment-in-ubuntu-12-dot-04/">
        Setting up a Go environment in Ubuntu
      </a>
    </h1>

    <span class="post-date">Sun, Dec 15, 2013</span>

    <p><strong><em>Update Jan 17, 2015:</em></strong> <strong>It&rsquo;s 2015 and things are different. Check out my <a href="/blog/2015/01/18/managing-a-go-environment-in-ubuntu">updated post on managing Go dependencies</a> for a better solution.</strong></p>

<p>Some very light cajoling led me to do some investigation into <a href="http://golang.org/">Google Go</a> (often called <strong>golang</strong> for ease of internet search). This is a brief recounting of how I got up and running on <a href="http://ubuntu.com">Ubuntu</a> (first 12.04 and then 13.10). Luckily, this has been made espcially easy for us with the introduction of a <a href="http://packages.ubuntu.com/precise/golang">golang package in the Ubuntu package repositories</a>. There are also <a href="http://golang.org/doc/install">official installation instructions</a> if you don&rsquo;t like mine.</p>

<p>Open up a terminal and let loose:</p>

<pre><code class="language-bash">$ sudo apt-get install golang
</code></pre>

<p>The download is pretty heavy, so this step may take some time. Eventually the installer for <code>golang-go</code> will ask you if you want to &ldquo;Report installation of public packages to Go Dashboard.&rdquo; I&rsquo;ve been choosing &ldquo;No&rdquo; to this question and have no complaints.</p>

<p>Now comes the fun part. Serious Go development relies on having a &ldquo;workspace&rdquo; setup involving a specific directory structure including <code>bin/</code>, <code>pkg/</code>, and <code>src/</code> directories. Google&rsquo;s <a href="http://golang.org/doc/code.html">official set-up page</a> contains more information about these workspaces.</p>

<p>I&rsquo;m not a big fan of putting a visible directory in <code>$HOME</code>, so I opted to make a hidden directory called <code>.go</code>. After creating the directory, the environment variable <code>$GOPATH</code> needs to be set and <code>$PATH</code> needs to be adjusted.</p>

<pre><code class="language-bash">$ mkdir ~/.go
$ echo &quot;GOPATH=$HOME/.go&quot; &gt;&gt; ~/.bashrc
$ echo &quot;export GOPATH&quot; &gt;&gt; ~/.bashrc
$ echo &quot;PATH=\$PATH:\$GOPATH/bin # Add GOPATH/bin to PATH for scripting&quot; &gt;&gt; ~/.bashrc
$ source ~/.bashrc
</code></pre>

<p>Now I&rsquo;m going to create a go project and add a link to it in the workspace I just created.</p>

<pre><code class="language-bash">$ mkdir -p $GOPATH/src/github.com/user
$ mkdir ~/hello-go
$ ln -s ~/hello-go ~/.go/src/github.com/user/hello-go
</code></pre>

<p>For some actual test code, I&rsquo;ll add a file in my <code>hello-go/</code> directory called <code>hello.go</code> with the following code:</p>

<p>``` go hello.go
package main</p>

<p>import &ldquo;fmt&rdquo;</p>

<p>func main() {
  fmt.Println(&ldquo;Hello world&rdquo;)
}</p>

<pre><code>
Now I'm going to install the binary created from compiling this code into my `$GOPATH` to verify that my workspace is set up correctly, then I'll run it to behold the fruit of my efforts.

``` bash
$ go install github.com/user/hello-go
$ hello-go
Hello world
</code></pre>

<p>Installing is not necessary every time I want to test that my code compiles; running <code>go build</code> in the source directory will create a local executable that can be executed for incremental testing.</p>

<p>If you&rsquo;re interested in learning golang, I would recommend doing the <a href="http://tour.golang.org/">go tour</a>. It goes way beyond a trivial hello world program and gives you some insight into many coplex go concepts (I even posted <a href="https://gist.github.com/larryprice/7647808">my solutions as a gist</a>, if you&rsquo;re interested).</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2013-12-12-tell-your-users-when-you-fail/">
        Tell Your Users When You Fail
      </a>
    </h1>

    <span class="post-date">Thu, Dec 12, 2013</span>

    <p>Your users put a lot of faith in you. They put up with your terrible design, your horrible taste in color scheme, and your ability to take up over 100% of their computer&rsquo;s memory. With that in mind, don&rsquo;t these poor people deserve a little bit of honesty?</p>

<p>I came across some code recently that irked me. This code asks for a handle to a database abstraction class and then runs a query on it. It looks kinda like this:</p>

<p>``` ruby settings.rb
def changeSettings(newSettings)
  db = dbFactory.get(&ldquo;settings.db&rdquo;)
  if !db.nil?
    db.execute(buildSaveQuery(newSettings))
  end
end</p>

<pre><code>
How nice that `changeSettings` doesn't try to play with a `nil` database, right? But what about the user's data? It wasn't saved. And no one knows. _Not even you_. Now, maybe the user will happily continue what he's doing until he notices that his new settings aren't quite right. So he goes back to them again. Same result. Repeat ad infinitum.

How I would initially approach this is to add an `else` statement that launches a dialog giving some useful data to the user. Whatever you do, for the love of code, DO NOT tell the user that you had database problems. For most applications, the user will have no idea what that means. It might look something like this:

``` ruby settings.rb
def changeSettings(newSettings)
  db = dbFactory.get(&quot;settings.db&quot;)
  if !db.nil?
    db.execute(buildSaveQuery(newSettings))
  else
    showDialog(title=&quot;Save Failed!&quot;,
               msg=&quot;I'm sorry, but your data could not be saved.&quot; +
                   &quot;Press 'Try Again' to give it another go.&quot; +
                   &quot;If the problem persists, restart the application&quot; +
                   &quot; or contact system support.&quot;)
  end
end
</code></pre>

<p>This is not a bad solution. But what about all the other places in the code I get the database from the factory? I&rsquo;d have to update those as well. It would be better to be able to code the factory to launch a similar error dialog whenever this happens. Even better, let me hand the factory a reference to an appropriate dialog whenever I call <code>dbFactory.get</code>.</p>

<p>Another much more frightening possibility is to skip the <code>nil</code> check. Can you guarantee that <code>dbFactory.get</code> will never be <code>nil</code>? In that case, this option is actually pretty good.</p>

<p>Even if that&rsquo;s not a guarantee you can make, it may still be a valid solution. <a href="http://www.artima.com/intv/defenseP.html">Crash early before you do too much damage</a>. Now, if there&rsquo;s some kind of crash-handler or global exception-catcher in your application, then you can catch the impending crash and tell the user the application needs to be restarted&hellip; And the app probably needs to be restarted anyway! There&rsquo;s no need to keep running after you&rsquo;ve reached some horrible error state that needs to be addressed.</p>

<p>Just do <em>something</em>! Your users (especially if that happens to include me) will appreciate your honesty, even if it&rsquo;s so brutal that they have to restart the application.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2013-12-10-login-shell-not-sourcing-bashrc/">
        Login shell not sourcing .bashrc: A brief lesson in dot-files
      </a>
    </h1>

    <span class="post-date">Tue, Dec 10, 2013</span>

    <p>I have a confession: I&rsquo;ve been avoiding using <a href="https://rvm.io/">rvm</a> for the past few weeks for stupid reasons.</p>

<p>When using <code>rvm</code> with <code>gnome-terminal</code>, I have to tell <code>gnome-terminal</code> to run as a login shell so that <code>/etc/profile</code> is sourced. The login shell is then supposed to source <code>$HOME/profile</code>, which is then supposed to source <code>$HOME/.bashrc</code>. Installing <code>rvm</code> results in me editing my <code>.bash_profile</code> to add the following line:</p>

<p>``` bash .bash_profile
[[ -s &ldquo;$HOME/.rvm/scripts/rvm&rdquo; ]] &amp;&amp; source &ldquo;$HOME/.rvm/scripts/rvm&rdquo; # Load RVM into a shell session <em>as a function</em></p>

<pre><code>
All my `rvm` environments seem to work, so this is a success, right?

Well, I type the good ol' `ls` command and I notice that all my colors are missing. I notice that the terminal title no longer reads the present working directory, but instead greets me with a disinterested &quot;Terminal.&quot; What happened?

Eventually I realized that this was a problem caused by not sourcing my `.bashrc`. Where did I go wrong?

The login shell sources `$HOME/.profile` UNLESS `$HOME/.bash_profile` exists, in which case it only sources the latter. So what are the contents of my `$HOME/.profile`?

``` bash .profile
# ~/.profile: executed by the command interpreter for login shells.

# [cut for brevity]

# if running bash
if [ -n &quot;$BASH_VERSION&quot; ]; then
    # include .bashrc if it exists
    if [ -f &quot;$HOME/.bashrc&quot; ]; then
      . &quot;$HOME/.bashrc&quot;
    fi
fi

# [cut for brevity]
</code></pre>

<p>Aha! The sneaky dot-file actually sources <code>$HOME/.bashrc</code>, and my shiny new <code>$HOME/.bash_profile</code> doesn&rsquo;t. I fixed this by sourcing <code>$HOME/.profile</code> in <code>$HOME/.bash_profile</code>.</p>

<p><code>bash .bash_profile
[ -f &quot;$HOME/.profile&quot; ] &amp;&amp; source &quot;$HOME/.profile&quot;
[[ -s &quot;$HOME/.rvm/scripts/rvm&quot; ]] &amp;&amp; source &quot;$HOME/.rvm/scripts/rvm&quot; # Load RVM into a shell session *as a function*
</code></p>

<p>For the memory-impaired: <code>.bash_profile</code> sources <code>.profile</code> sources <code>.bashrc</code>.</p>

<p>Re-open <code>gnome-terminal</code> to find my colors are fixed, my title is correct, and <code>rvm</code> plays the right notes. The world is at peace once again, and I don&rsquo;t have to avoid using <code>rvm</code>.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2013-11-22-hooks-in-cucumber-cpp/">
        Hooks in cucumber-cpp
      </a>
    </h1>

    <span class="post-date">Fri, Nov 22, 2013</span>

    <p>A few months ago <a href="/blog/2013/04/15/tags-in-c-plus-plus-cucumber-tests/">I blogged about tags</a> in <a href="https://github.com/cucumber/cucumber-cpp">cucumber-c++</a>. The scenario I presented involved using tags to call a <code>BEFORE</code> hook before the first scenario and an <code>AFTER</code> hook after the last scenario. The code looked a little bit like this:</p>

<p>``` cucumber DoStuff.feature
@first
Scenario: Do it my way
  &hellip;</p>

<p>Scenario: Don&rsquo;t do it
  &hellip;</p>

<p>@last
Scenario: Do it your way
  &hellip;</p>

<pre><code>
``` c++ DoStuff_StepDefinitions.cpp

BEFORE(&quot;@first&quot;) { cout &lt;&lt; &quot;This is the first step!&quot; &lt;&lt; endl; }

AFTER(&quot;@last&quot;) { cout &lt;&lt; &quot;This is the last step!&quot; &lt;&lt; endl; }

...

</code></pre>

<p>The scnenario labeled <code>@first</code> would call the corresponding <code>BEFORE</code> macro and the <code>@last</code> scenario would call the <code>AFTER</code> macro. If I didn&rsquo;t have tags in place, the macros would have both been invoked before/after each scenario. Macros for <code>BEFORE_STEP</code> and <code>AROUND_STEP</code> are also available; <code>BEFORE_STEP</code> allows you to tag individual steps and <code>AROUND_STEP</code> acts as a before/after for individual steps.</p>

<p>This was a workaround. What I really wanted to do was to not use tags, and instead unconditionally perform an action before the first scenario was run and after the last scenario is complete. Since cucumber-cpp is open source, I decided to implement that a few weeks ago (<a href="https://github.com/cucumber/cucumber-cpp/commit/26e11d0248edf32a8bac17df9d2d4ceb135ed502">see changeset</a>). Now the above example becomes:</p>

<p>``` cucumber DoStuff.feature</p>

<p>Scenario: Do it my way
  &hellip;</p>

<p>Scenario: Don&rsquo;t do it
  &hellip;</p>

<p>Scenario: Do it your way
  &hellip;</p>

<pre><code>
``` c++ DoStuff_StepDefinitions.cpp

BEFORE_ALL() { cout &lt;&lt; &quot;This is the first step!&quot; &lt;&lt; endl; }

AFTER_ALL() { cout &lt;&lt; &quot;This is the last step!&quot; &lt;&lt; endl; }

...

</code></pre>

<p>This is the same behavior as the first example, except I don&rsquo;t have to force my fellow developers to move tags around when they add/remove scenarios. Also now my fellow developers can stop asking me why I was using tags and why when they added a scenario they couldn&rsquo;t get the tests to pass.</p>

<p>The moral of the story is that you should go implement that feature you want to see in your favorite open source project.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2013-11-17-sep-blog-battle-tools-of-the-trade/">
        SEP Blog Battle: Tools of the Trade
      </a>
    </h1>

    <span class="post-date">Sun, Nov 17, 2013</span>

    <p>To whom do I owe any programming success I may have in a given day? My education? My wonderful peers? The shriveled wad of grey goo in my head? None of the above.</p>

<p>My search engine. <a href="https://duckduckgo.com">DuckDuckGo</a>. <a href="https://encrypted.google.com">Google</a>. <a href="https://wikipedia.org">Wikipedia</a>. Hardly a problem exists that can&rsquo;t be assisted in some way by a quick search.</p>

<p>How do I use Google Go (<a href="http://golang.org/doc/effective_go.html">answer</a>)? How do I use tags in <a href="https://github.com/cucumber/cucumber-cpp">cucumber-cpp</a> (<a href="http://larryprice.github.io/blog/2013/04/15/tags-in-c-plus-plus-cucumber-tests/">answer</a>)? How do I brush my teeth without toothpaste (<a href="http://www.wikihow.com/Brush-Teeth-Without-Toothpaste">answer</a>? What&rsquo;s the deal with airline food (<a href="http://youtu.be/n0E7EaRLmSI">answer</a>)?</p>

<p>It&rsquo;s all so easy. It&rsquo;s right at your fingertips. A proficient programmer these days has to also be a proficient &ldquo;Googler.&rdquo; However, a programmer&rsquo;s job description is not &ldquo;copies all code from the internet.&rdquo; Although the odds are high that someone has had a problem very similar to yours, you need to be able to take that code as an example and adapt it to your current situation. If that weren&rsquo;t the case, I think we&rsquo;d be losing our jobs to high school kids pretty quickly.</p>

<p>So at the end of the day, make sure to be thankful to your search engine. Buy it flowers, make it dinner, rub its feet; just let it know how much you appreciate all the hard work it does for you when you do nothing but ask it silly questions all day.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2013-11-14-copy-data-using-qmake/">
        Copy Data Using qmake
      </a>
    </h1>

    <span class="post-date">Thu, Nov 14, 2013</span>

    <p>I&rsquo;ll take things that should be really easy but are in fact impossible for $1000, Mr Trebek.</p>

<p>I have a <a href="https://qt-project.org/wiki/Qt_5.0">Qt</a> desktop app that uses <a href="https://qt-project.org/doc/qt-4.8/qmake-manual.html">qmake</a>. I have tests. I have test data that I need to copy to my build directory. Not only that, but I want to copy a whole directory recursively. In Linux <em>and</em> Windows. You must be thinking to yourself, &lsquo;There&rsquo;s no way that&rsquo;s possible, leave me out of your crazy plans!&rsquo; Well to that I say nay. Nay indeed.</p>

<p>I originally copied my test data using the <code>INSTALLS</code> variable. My data folder is just a directory sitting in the test source called &ldquo;TestData.&rdquo; This solution is fantastic because it works cross-platform.</p>

<p>``` make MyBAProjectTest.pro
install_it.path = $${OUT_PWD}
install_it.files += TestData/</p>

<p>INSTALLS += install_it</p>

<pre><code>
However, this means that if I ever have a clean directory, I have to run `make install` to install my test data. What a pain! Why bother! Why even write tests when life is this unjust!

BUT WAIT! After combing the depths of the internets for much of the evening, I was able to find many halfway solutions to my original problem. The concept is to add commands to the `QMAKE_POST_LINK` variable.

For Linux, I use `cp`:

``` make MyBAProjectTest.pro
QMAKE_POST_LINK += $$quote(cp -rf $${PWD}/TestData $${OUT_PWD})
</code></pre>

<p>For Windows, I use <code>xcopy</code>:</p>

<p>``` make MyBAProjectTest.pro
PWD_WIN = $${PWD}
PWD_WIN ~= s,/,\,g</p>

<p>QMAKE_POST_LINK += $$quote(mkdir DestFolder)
QMAKE_POST_LINK += $$quote(xcopy $${PWD_WIN}\TestData $${OUT_PWD_WIN}\TestData /E)</p>

<pre><code>
I also want that directory to be deleted when I run `make clean`. Cleaning up just means adding some commands to the `QMAKE_CLEAN` directive. I also want to run the appropriate commands whether I'm on Unix or Windows without having to modify my `.pro` file. Wrapping the previous commands in what I call an &quot;OS-space&quot; will cause those commands to only run in the specified operating system.

``` make MyBAProjectTest.pro
win32 {
    PWD_WIN = $${PWD}
    PWD_WIN ~= s,/,\\,g

    QMAKE_POST_LINK += $$quote(mkdir DestFolder)
    QMAKE_POST_LINK += $$quote(xcopy $${PWD_WIN}\\TestData $${OUT_PWD_WIN}\\TestData /E)

    QMAKE_CLEAN += /s /f /q TestData &amp;&amp; rd /s /q TestData
}

unix {
    QMAKE_POST_LINK += $$quote(cp -rf $${PWD}/TestData $${OUT_PWD})

    QMAKE_CLEAN += -r TestData
}
</code></pre>

<p>Data copied, tests working again. Take that, Nokia; no matter how difficult you make your build-processing tool, I&rsquo;ll figure out how to contort it to my whims.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2013-10-13-installing-gtest-and-gmock-libs-in-ubuntu-13-dot-04/">
        Installing GTest and GMock Libs in Ubuntu 13.04
      </a>
    </h1>

    <span class="post-date">Sun, Oct 13, 2013</span>

    <p>I started trying to work on an open-source project and found that I needed to install <a href="https://code.google.com/p/googletest/">googletest</a> and <a href="https://code.google.com/p/googlemock/">googlemock</a> on my home machine. Seemed easy enough, I found a package called <code>google-mock</code> in the <a href="http://packages.ubuntu.com/raring/google-mock">Raring</a> repositories which depends on a package called <code>libgtest-dev</code>. So I install it:</p>

<pre><code class="language-bash">$ sudo apt-get install -y google-mock
</code></pre>

<p>And the CMake file I was running before tells me that I have gmock, but I&rsquo;m still missing gtest. What&rsquo;s going on here?</p>

<p>Well, there was a changeset applied in Ubuntu 12.04 (Precise) with the following text (<a href="http://www.ubuntuupdates.org/package/core/precise/universe/base/gtest">source</a>):</p>

<blockquote>
<p>Stop distributing static library (although still build it, to ensure gtest
  works). Upstream recommends against shipping the libary at all, just the
  source. (See: <a href="http://code.google.com/p/googletest/wiki/FAQ">http://code.google.com/p/googletest/wiki/FAQ</a>)
  The Debian maintainer plans to do this also (see BTS: 639795); do it in
  Ubuntu now to fulfil MIR requirements.</p>

<p>&ndash; Christopher James Halse Rogers Thu, 08 Mar 2012 17:45:29 +1100</p>
</blockquote>

<p>What does that mean? That means we get to build and &ldquo;install&rdquo; the gtest libs ourselves. The source is conveniently installed in <code>/usr/src</code> after installing <code>libgtest-dev</code> (which we automatically got when we installed <code>google-mock</code>).</p>

<p><code>bash Installing gtest libs
$ sudo apt-get install -y cmake --quiet
$ cd /usr/src/gtest
$ sudo cmake -E make_directory build
$ sudo cmake -E chdir build cmake .. &gt;&gt; /dev/null
$ sudo cmake --build build &gt;&gt; /dev/null
$ ls build/libgtest*
build/libgtest.a  build/libgtest_main.a
$ sudo cp build/libgtest* /usr/local/lib/
$ sudo rm -rf build
</code></p>

<p>The <code>&gt;&gt; /dev/null</code> can be dropped if you would like to see the output of these commands when successful, any error text will still show up with this redirect in place. I like to move all my personally-compiled libraries (and includes) to <code>/usr/local</code>, but you could just as easily copy them over to <code>/usr/lib</code>. All of this could also be done in <code>/tmp</code> if you&rsquo;re so inclined.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2013-10-08-rvm-quick-start/">
        RVM Quick Start
      </a>
    </h1>

    <span class="post-date">Tue, Oct 8, 2013</span>

    <p>When I was working on a few different projects at once, I started running into issues where my Ruby gem versions would start to mismatch. How did I fix that issue? Naively. I adjusted the versions as necessary so my gems were always the same version. That was&hellip; pretty dumb. To make up for my past ignorance, I&rsquo;ve been exploring ways to manage my Ruby versions and my gems intelligently. Enter <a href="https://rvm.io/">RVM</a>.</p>

<p>RVM is a simple tool to solve just problems. And it works pretty well. I hit some kinks along the way, but my installation pleases me well enough. Getting RVM is not for the faint of heart. Maybe there are better ways to do it, but the website says to execute the following:</p>

<p>``` bash /home/lrp/my_project
&gt; curl -L <a href="https://get.rvm.io">https://get.rvm.io</a> | bash -s stable</p>

<pre><code>
This command uses curl to fetch the data that lives at `https://get.rvm.io`, which happens to be a big bash script. It executes the bash script with the args `-s stable`. 'Stable' means the latest stable release of RVM. I could just as easily give it 'dev' and get the latest developer release instead, but I really don't want that. So that command does a lot of stuff and may give you some further instructions to run before you can continue. Use that big head of yours and follow the instructions. You may also need to restart a terminal to get RVM to be recognized as a command. Since I was using `gnome-terminal`, I had to follow these [instructions](https://rvm.io/integration/gnome-terminal).

Now I want RVM to know about some Ruby versions. For a full list of possible Ruby versions to install, run `rvm list known`. I just want 1.9.3. I found that I needed to do this even though I had 1.9.3 installed on my system previously.

``` bash /home/lrp/my_project
&gt; rvm install ruby-1.9.3
</code></pre>

<p>In Ubuntu 13.04, this command installs ruby-1.9.3 in <code>~/.rvm/rubies/ruby-1.9.3-p448/bin/ruby</code>. I&rsquo;ve found that this also sets my default Ruby to the RVM version of Ruby, which I don&rsquo;t want. To verify and undo this, I executed the following commands outside of my project directory.</p>

<p>``` bash /home/lrp
&gt; which ruby
/home/lrp/.rvm/rubies/ruby-1.9.3-p448/bin/ruby
&gt; echo &ldquo;D&rsquo;oh&rdquo;
D&rsquo;oh
&gt; rvm use system
Now using system ruby.
&gt; which ruby
/usr/bin/ruby
&gt;</p>

<pre><code>
Now that that's settled, I want to tell RVM to use the local version of Ruby for my project and to install any gems in a special location.

``` bash /home/lrp/my_project
&gt; rvm 1.9.3@my-project --create --ruby-version
</code></pre>

<p>This creates a gemset and ruby-version file (<code>.ruby-gemset</code> and <code>.ruby-version</code> files) using the Ruby installation 1.9.3 created above. I specifiy to use <code>--ruby-version</code> instead of <code>--rvmrc</code> because RVM told me that I should. After some research, the <code>.ruby-version</code> file is used by several other tools, so this will keep my potential number of config files low. Now I check that all my Ruby versions are okay.</p>

<p><code>bash /home/lrp/my_project
&gt; which ruby
/home/lrp/.rvm/rubies/ruby-1.9.3-p448/bin/ruby
&gt; cd ..
&gt; which ruby
/usr/bin/ruby
&gt;
</code></p>

<p>When in my project directory, all the gems I install will be installed to my specified gemset, which means they are no longer cluttering my global gemspace, even when I install them using Bundler. It also means that I can use ruby-1.9.3 for this project and 2.0 for another project with minimal mental overhead. This makes me a happy developer.</p>

<p>I only glazed over the installation process and documentation for RVM. Go to <a href="https://rvm.io/">the web site</a> for more.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2013-09-08-the-pragmatic-programmer/">
        The Pragmatic Programmer
      </a>
    </h1>

    <span class="post-date">Sun, Sep 8, 2013</span>

    <blockquote>
<p>Don&rsquo;t be a slave to history. Don&rsquo;t let existing code dictate future code. All code can be replaced if it is no longer appropriate</p>
</blockquote>

<p>###The Gist</p>

<p><a href="http://www.amazon.com/gp/product/020161622X/ref=as_li_ss_tl?ie=UTF8&amp;camp=1789&amp;creative=390957&amp;creativeASIN=020161622X&amp;linkCode=as2&amp;tag=larpriandthee-20"><em>The Pragmatic Programmer</em></a> written by Andrew Hunt and David Thomas is a book about being an above-average software developer.</p>

<p>###My Opinion</p>

<p>There are many good concepts in this book. However, I&rsquo;ve been reading a bit much lately and found that most of the topics covered have been rehashed in other books. As it turns out, re-reading this kind of motivational book is less exciting when you&rsquo;ve read similar texts earlier in the year.</p>

<p>I did enjoy the section on Refactoring; there has been some discussion on my current project team of what to do when you see &ldquo;gnarly&rdquo; code. This section reiterates the fact that poorly-written code should be updated. The authors talk about treating code as organic. Refactoring your code as it grows is the same as reevaluating oneself as one grows older. Changing one&rsquo;s hair or clothes, changing what one eats or reads or watches (inputs), or changing a daily routine is just refactoring of your daily life: the person is the same and accomplishes largely the same tasks, but in a slightly different manner.</p>

<p>One tip in this book is &ldquo;Use one editor well.&rdquo; I&rsquo;ve found that I love to use <a href="http://www.sublimetext.com/">Sublime Text</a> for my work in Ruby, Python, and markup languages. Having said that, I find Sublime an inappropriate tool for doing C++ (<a href="https://qt-project.org/wiki/Category:Tools::QtCreator">Qt Creator</a>), Java (<a href="http://eclipse.org/">Eclipse</a> or even <a href="https://netbeans.org/">NetBeans</a>), or anything .NET (duh Visual Studio). Considering my job could involve any programming language, I would revise this tip to &ldquo;Use the right editor for the job, and learn to use it well.&rdquo;</p>

<p>The chapter introductions were largely worthless to me: long-winded summaries of EVERYTHING in the chapter. I eventually trained myself to automatically skip the chapter intros in favor of reading the details. It seems that I could have just as easily gone the other way and gotten away with only reading the intros, but that hardly seems like any fun.</p>

<p>###Who Would Like This</p>

<p>Fresh-outs should read this book. It&rsquo;s not too long and it&rsquo;s split into manageable chapters. Great for fresh-out book clubs, in which I probably should have participated.</p>

<p>Who would not like this? People who have read books with similar premeses, such as <a href="/blog/2013/02/19/code-complete-second-edition/"><em>Code Complete</em></a>, within recent memory.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2013-08-31-using-foreman-to-create-an-upstart-service/">
        Using Foreman to Create an Upstart Service
      </a>
    </h1>

    <span class="post-date">Sat, Aug 31, 2013</span>

    <p>I just finished my first attempt at deploying a web app to run automatically in the background on a friend&rsquo;s server. Pretty easy, really. The first thing I did was install <a href="https://github.com/ddollar/foreman">foreman</a>. Assuming you have ruby and rubygems installed:</p>

<pre><code class="language-bash">$ sudo gem install foreman
</code></pre>

<p>Next I needed to give foreman the commands to start my app. I created a file in the root of my project directory called &lsquo;Procfile&rsquo; and gave it the steps I would run to start my app manually. For the sake of simplicity, let&rsquo;s say I run my app pretty barebones:</p>

<p>``` bash Procfile
web: bundle exec rackup</p>

<pre><code>
Now when I run `foreman start`, foreman will use [Bundler](http://bundler.io/) to execute rackup with the correct gems in my Gemfile. Now exporting upstart config files is pretty easy.

``` bash
$ sudo foreman export upstart --app=MyApp --user=root /etc/init
</code></pre>

<p>That command creates the .conf files needed for upstart to control the service called &lsquo;MyApp&rsquo; as the user &lsquo;root.&rsquo; It puts all the .conf files in <code>/etc/init</code> (which is where Ubuntu puts such things) and will create a default log directory in <code>/var/log/MyApp</code>. Now I can control my service by running <code>service MyApp start</code>, <code>service MyApp stop</code>, <code>service MyApp restart</code>, and <code>service MyApp status</code>. Hooray for me.</p>

<p>But I need to run my app in two ways: in dev mode on a local port with my dev database, and I need to run it in production mode using port 80 and the production database. I&rsquo;ve also heard that using <a href="https://en.wikipedia.org/wiki/WEBrick">webrick</a> (the default server installed with rackup) is great for develpment, but I should be using something else for my production server. So I made some config files for foreman:</p>

<p>``` bash development.env
RACK_ENV=development
PORT=9292
SERVER=rackup</p>

<pre><code>
``` bash production.env
RACK_ENV=production
PORT=80
SERVER=unicorn
</code></pre>

<p>And I change my Procfile to:</p>

<p>``` bash Procfile
web: bundle exec $SERVER -p $PORT -E $RACK_ENV</p>

<pre><code>
Ridiculously configured. Now when I run `foreman start`, it will error out. I need to specify my environment file:

``` bash
$ foreman start -e production.env
</code></pre>

<p>Now foreman will use Bundler to startup the server specified in <code>$SERVER</code>, run the app on port <code>$PORT</code> (-p), and will pass through the environment listed as <code>$RACK_ENV</code> to my application (-E), allowing my app to do whatever configuration it does given the current environment. Power to the people.</p>

<p><a href="http://michaelvanrooijen.com/articles/2011/06/08-managing-and-monitoring-your-ruby-application-with-foreman-and-upstart/">I found that this guy</a> does a lot more complicated stuff with Foreman, if you need more.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2013-08-26-on-the-futility-of-man-and-trying-to-divide-a-sinatra-app-into-separate-controllers/">
        On the Futility of Man and Trying to Divide a Sinatra App into Separate Controllers
      </a>
    </h1>

    <span class="post-date">Mon, Aug 26, 2013</span>

    <p>Oh, <a href="http://www.sinatrarb.com/">Sinatra</a>. You&rsquo;re oh-so-very dear to me. You made it so easy for me to write my <a href="http://capitalpunishment.herokuapp.com">first</a> <a href="http://pokephile.herokuapp.com">web</a> apps. All I had to do was write a couple routes and throw together a few HTML-like files and I had a web app. I used pattern matching to reduce the web-facing code for <a href="https://github.com/larryprice/CapitalPunishment">Capital Punishment</a> from ~500 lines of code to &lt;100 lines of code. You are perfect for writing small-time web applications.</p>

<p>But what about large web applications? What about a web app that has normal users and admin users, makes lots of database reads and writes (my previous apps only did reads from a user-facing perspective), and has to be able to show the history of everything, forever, to the authorized users who request it?</p>

<p>You see, Sinatra is kind of an <a href="https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller">MVC framework</a>, but not exactly. In Sinatra, you have Views (your HTML inter-mixed with Ruby code in your desired DSL) and you have Controllers (each of your routes). When a database is involved, you can use something like <a href="https://github.com/bmizerany/sinatra-activerecord">ActiveRecord</a> or <a href="http://mongoid.org/en/mongoid/index.html">Mongoid</a> or <a href="http://datamapper.org/">DataMapper</a> and you have yourself Models.</p>

<p>So every route is kind of a Controller. Every. Route. In Capital Punishment, there were once 8 routes (there are now 7). In the project I&rsquo;ve been working on recently, there are currently 56 routes. 56 routes in the language described above means I kind of have 56 controllers.</p>

<p>That&rsquo;s been pretty overwhelming, especially since the traditional way of creating routes in Sinatra is to shove them all in the same file. There are a few ways I could think of to address this. The way we chose six months ago (for better or worse) was found <a href="http://stackoverflow.com/questions/5877000/what-is-a-controller-in-sinatra">on StackOverflow</a>, and involves creating a bunch of different files where you shove all related routes. So you get this situation:</p>

<p>``` ruby app.rb
class App &lt; Sinatra::Base
end</p>

<p>require_relative &lsquo;controllers/helpers&rsquo;</p>

<p>Dir.glob(&ldquo;#{File.dirname(<strong>FILE</strong>)}/controllers/*.rb&rdquo;).each do |file|
  require file.chomp(File.extname(file))
end</p>

<p>class App
  get &lsquo;/&rsquo; do
    erb :home
  end
end</p>

<pre><code>
``` ruby controllers/reports_controller.rb
class App
  get '/reports/user_bills' do
    erb :user_bills_report
  end
  ...
end
</code></pre>

<p>And so on and so forth. This works fine for a while, but we&rsquo;ve ended up with 13 &ldquo;controller&rdquo; files, many of which are not trivial. This also makes the App class quite large since its controllers handle most of the logic for the app. This also doesn&rsquo;t enforce any kind of URL-naming logic, so if a developer is working hard (s)he may create both <code>/reports/user_bills</code> and <code>user_info_reports</code> without realizing the inconsistency (s)he just injected into the system.</p>

<p>In hindsight, this method is not perfect. I think that the Rails method of individual controllers is significantly better for large apps. Some people have been using other methods for trying to make Sinatra more MVC, such as <a href="https://github.com/jorrizza/sinatra-mvc">sinatra-mvc</a>. To be frank, sinatra-mvc pretty much does the same thing we&rsquo;ve done, but with more structure.</p>

<p>I think what I&rsquo;ve learned is that you should use a tool for its intended purpose. Sinatra was written to quickly create web apps in Ruby with minimal effort. Once you have more than 10-15 routes, you should reconsider whether your app can still be called &ldquo;minimal effort.&rdquo; Sinatra may fly you to the moon, but you&rsquo;re unlikely to see what spring is like on Jupiter or Mars.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2013-08-22-beware-of-group-projects/">
        Beware of Group Projects
      </a>
    </h1>

    <span class="post-date">Thu, Aug 22, 2013</span>

    <p>Relying on other people is hard. I&rsquo;ve always found it difficult to understand that other people aren&rsquo;t me. Don&rsquo;t get me wrong, working with others can be really rewarding. Maybe &ldquo;Beware of Group Projects&rdquo; is not the best title. More like &ldquo;Be Wary that Working with Others is Not the Same as Working with Yourself.&rdquo; But that&rsquo;s a pretty long title, and reading (like working with others) is hard.</p>

<p>I&rsquo;ve been spending a lot of my spare time collaborating on a project with a small group of other developers. I normally do this kind of thing on my own. I started thinking about the differences in working by myself and collaborating with other devs. Then I decided that it would look good in a list format comparing each circumstance from both sides. I was wrong, but couldn&rsquo;t think of a better way to present it.</p>

<p>##Let&rsquo;s Start a New Project!##</p>

<p><strong>As an Individual</strong>: This project is going to help me! I can use this new technology and I&rsquo;ll learn so much!<br />
<strong>As a Group</strong>: This project is going to help our customer! We can use this new technology and everyone will learn so much!</p>

<p>##Let&rsquo;s Work!##</p>

<p><strong>As an Individual</strong>: I&rsquo;ve got 5 minutes, that&rsquo;s enough time to make those adjustments I&rsquo;ve been thinking about&hellip;<br />
<strong>As a Group</strong>: We&rsquo;ve got 5 minutes, but once we find a conference room, set up the projector, and update our branch I&rsquo;ll have to go pick up my wife. Pass.</p>

<p>##Let&rsquo;s Not Work##</p>

<p><strong>As an Individual</strong>: I could work, or I could just play Prison Architect all weekend. &hellip;I&rsquo;ll have the happiest inmates this side of Alcatraz by Monday morning!<br />
<strong>As a Group</strong>: We&rsquo;ve set aside these times to meet, you should come help! There might be pizza if you stay long enough.</p>

<p>##Knowledge##</p>

<p><strong>As an Individual</strong>: Now I know how to do X.<br />
<strong>As a Group</strong>: Now I know how to do X. Now you know how to do X, and you know how to do X, and you know how to do X! I&rsquo;m the Oprah of Knowing X!</p>

<p>##Coding Standards##</p>

<p><strong>As an Individual</strong>: Whoops, I mixed camelCase and under<em>scores when naming my classes. Oh well.<br />
<strong>As a Group</strong>: For the love of Linux Torvalds, how do you not remember to prefix your public member variables with &lsquo;pub</em>&rsquo; and postfix your private member variables with &lsquo;_private&rsquo;?</p>

<p>##Testing##</p>

<p><strong>As an Individual</strong>: Pfft.<br />
<strong>As a Group</strong>: TEST ALL THE THINGS! It&rsquo;s the best way we can guarantee that our code changes don&rsquo;t break existing functionality.</p>

<p>##I&rsquo;m Bored##</p>

<p><strong>As an Individual</strong>: Forget the months of work spent on X, I think I&rsquo;ll work on Y now.<br />
<strong>As a Group</strong>: If we finish, we&rsquo;ll have made something useful. Someone needs us this! You&rsquo;ll be happy you kept working on it in a few weeks.</p>

<p>##We&rsquo;re Done!##</p>

<p><strong>As an Individual</strong>: I made an app that let&rsquo;s you draw circles. A job well done, if I do say so myself. I believe I&rsquo;ll have a beer.<br />
<strong>As a Group</strong>: We invented the warp drive, but it hits a theoretical limit at approximately 9.5 warp. Beer all around! We start work on version 2.0 next week!</p>

<p>The point is that working with others is not bad. In fact, working with others helps give me a sense of responsibility in what I&rsquo;m working on, and motivates me to continue even when I&rsquo;m in a lull. I&rsquo;ve thrown out so many individual side-projects because I just wasn&rsquo;t motivated, or was no longer convinced of its usefulness. It&rsquo;s also (theoretically) easier to build bigger projects with groups because there are more arms to swing more hammers.</p>

<p>&ldquo;Beware of Group Projects&rdquo; if you don&rsquo;t have time, or if you can&rsquo;t compromise, or if you don&rsquo;t care. Otherwise, just be wary that working with others is not the same as working with yourself.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2013-08-07-the-trouble-with-time-zones-aka-learn-from-your-mistakes-pt-1/">
        The Trouble with Time Zones (aka Learn From My Mistakes Part 1)
      </a>
    </h1>

    <span class="post-date">Wed, Aug 7, 2013</span>

    <blockquote>
<p>As a user, my data&rsquo;s LastModifiedDate should not be updated when I Export it, and it should be in UTC.</p>
</blockquote>

<p>That&rsquo;s the gist of the story I was tasked with a few weeks ago. Seemed easy enough: just set the &ldquo;LastModifiedDate&rdquo; field of each XML node to the LastModifiedDate pulled from the database converted to UTC. I can do the development and write up some Cucumber tests in an hour, two hours tops. Find a few small caveats along the way, get it out of development and through code review by the next morning. Push it to the mainline and watch the build go green. All done, dust off my hands and move on to something else.</p>

<p>When has anything ever been that simple? Certainly not in the fantastical world of software development! About ten minutes after the build server confirmed a successful build of my code on the tip of our main branch, a face popped up over the cube wall. &ldquo;Hey, why&rsquo;d you break the build?&rdquo; My teammate was having trouble running my LastModifiedDate tests. All of his time comparisons were off by an hour. My computer (and the build server) were in one time zone; his was in another. I immediately realized the exact lines of the code that weren&rsquo;t dealing with time zones. We agreed to let the code remain on the build server instead of backing it out since the build server was green, and I created/tested/pushed a couple of patches to fix the problem. Green build on the build server. Green build amongst all my time-disabled peers. The next morning I had a panic attack in the shower thinking about how some of my test data could be affected by the switch to UTC. I rushed into work early and put in another patch, this one slightly changing the format of some of my test data. After doing this, I realized that what I had done was completely unnecessary and decided I should probably get my blood pressure checked.</p>

<p>Then: silence. I was satisfied I&rsquo;d seen the end of my time zone issues which I&rsquo;d spent nearly as much time patching as I had developing the initial solution. Two weeks pass. Monday morning there&rsquo;s an email from another country in my inbox, &ldquo;This test was written that only works in American time zones! Who is fixing this?&rdquo; After quite a few emails and chats I found that their main branch had merged in a version of our main branch between my original solution and my patch. The developer agreed to be patient until his team could start using the newer version of our branch. Four hours later I get another email from developers on another continent. I sent them the patches I made previously compressed into one to keep them working.</p>

<p>Was this a small mistake? On a project with a small, local team the answer is definitely yes. This project in particular involves a large number of developers who don&rsquo;t all test in the same time zone and who work on a number of different branches that feed into each other in weekly chunks. Despite that, I think this error could have gone greatly unnoticed had I simply backed out the original changes and pushed the patches and original solution together. My confidence (hubris?) really bit me on this one. Initially only a single developer seemed to be affected by my oversight; fate selected a build between my original solution and my patches to push to the other branches to make sure more people noticed my mistake.</p>

<p><strong>In hindsight</strong>, The Right Thing to Do was to assume fault and back out immediately. One developer having build issues is still one more than should have been affected. Here&rsquo;s hoping this bit o&rsquo; hindsight today leads to better foresight tomorrow.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2013-07-16-effective-c-plus-plus/">
        Effective C&#43;&#43;
      </a>
    </h1>

    <span class="post-date">Tue, Jul 16, 2013</span>

    <p>###The Gist</p>

<p><a href="http://www.amazon.com/gp/product/0321334876/ref=as_li_ss_tl?ie=UTF8&amp;camp=1789&amp;creative=390957&amp;creativeASIN=0321334876&amp;linkCode=as2&amp;tag=larpriandthee-20"><em>Effective C++</em></a> is a list of ways to write not-your-average-bear C++ code. The author, <a href="http://www.aristeia.com/">Scott Meyers</a>, outlines 8 specific topics for improving code, and a few more miscellaneous tips.</p>

<p>###My Opinion</p>

<p>Lots of good can come from reading this book. I borrowed it from a more-experienced co-worker and noticed many of the interesting coding standards this co-worker used came directly from this book. And I agree with it. I&rsquo;ve been actively trying to follow the lessons learned in this book from the moment I picked it up.</p>

<p>I learned C++ the hard way: I was thrown into an internship where I didn&rsquo;t really have enough skills to contribute to the project, and my &ldquo;boss&rdquo; didn&rsquo;t really have anywhere to put me. So I was handed a book, pointed to <a href="http://www.cplusplus.com/">this wonderous website</a>, and I wrote some little helper apps for the project. I wasn&rsquo;t taught anything about form or any of that formal business. Then I took a C++ class in college, and never bothered to learn any of the coding standards because I had enough previous knowledge to get by my own way (and appear to be really good while doing it).</p>

<p>So this book showed me a lot of the why certain things in C++ are the way they are. It explained to me that a copy constructor is called every time you pass an object directly through a function, and how assignment operators are used whenever an equals sign appears. It told me why my destructors need to be virtual. It explained a lot about smart_ptr and auto_ptr that I never thought to think about.</p>

<p>Admittedly, there are parts of the book that are hard to follow. I consider Chapter 7 (Templates and Generic Programming) and Chapter 8 (Customizing new and delete) to be extremely technical chapters not meant for the faint of heart, and the lessons learned in these chapters are not necessarily useful in day-to-day programming. Chapter 9 is simply called Miscellany, and it delivers no new information for improving one&rsquo;s C++ skills.</p>

<p>###Who Would Like This</p>

<p>C++ Programmers should have this book (at least the first 6 chapters) crammed down their throats and into their squishy pink brains. After learning all the &ldquo;basic&rdquo; concepts of C++, the lessons this book teaches in design and the nature of C++ should be taken into consideration.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2013-04-28-joel-on-software/">
        Joel On Software
      </a>
    </h1>

    <span class="post-date">Sun, Apr 28, 2013</span>

    <blockquote>
<p>We&rsquo;re programmers. Programmers are, in their hearts, architects, and the
first thing they want to do when they get to a site is to bulldoze the place
flat and build something grand. We&rsquo;re not excited by incremental renovation:
tinkering, improving, planting flower beds.</p>

<p>&ndash; Joel Spolsky, &ldquo;Things you Should Never Do, Part I&rdquo;</p>
</blockquote>

<p>###The Gist</p>

<p><a href="http://www.amazon.com/gp/product/1590593898/ref=as_li_ss_tl?ie=UTF8&amp;camp=1789&amp;creative=390957&amp;creativeASIN=1590593898&amp;linkCode=as2&amp;tag=larpriandthee-20"><em>Joel On Software</em></a> is a collection of blog posts by the great <a href="http://www.joelonsoftware.com/">Joel Spolsky</a>. He has risen to Internet Fame after his experience working for Microsoft and eventually starting his own company. The &ldquo;chapters&rdquo; (blog posts) provide insight into picking a language for your codebase, recruiting engineers, managing programmers, fixing bugs, paper prototyping, and how Microsoft works.</p>

<p>###My Opinion</p>

<p>Joel Spolsky is a god sent down from Mount Olympus to calmly explain to us why we are sometimes terrible people and then goes on to tell us it&rsquo;s okay and we should learn from our past. I loved this book, especially since I read it at the same time as some really terrible books (namely <a href="http://www.amazon.com/gp/product/0672326140/ref=as_li_ss_tl?ie=UTF8&amp;camp=1789&amp;creative=390957&amp;creativeASIN=0672326140&amp;linkCode=as2&amp;tag=larpriandthee-20">The Inmates are Running the Asylum</a> and <a href="http://www.amazon.com/gp/product/1491017082/ref=as_li_ss_tl?ie=UTF8&amp;camp=1789&amp;creative=390957&amp;creativeASIN=1491017082&amp;linkCode=as2&amp;tag=larpriandthee-20">Enterprise Games</a>; I do not recommend these books).</p>

<p>Spolsky talks a lot about specs in the first part of the book, and at first I thought that he was stating too much of the obvious; but then why don&rsquo;t we do specs in this obvious way? Instead, we resign ourselves to write a tiny portion of the spec, start programming, and then implicitly change the spec while only haphazardly updating our documentation. I&rsquo;ve been on projects before where we would have greatly benefitted from having a solid spec; we knew exactly what needed to be done, because we were rewriting a successful product the company had released several years ago. With an ever-changing spec, we programmed ourselves into a hole, and struggled for at least half a year to claw our way back out. I have to wonder if more pre-planning would have saved us from ourselves.</p>

<p>Spolsky&rsquo;s advice on hiring people is invaluable (<a href="http://www.joelonsoftware.com/articles/GuerrillaInterviewing3.html">The Guerrilla Guide to Interviewing</a>). In fact, I wish that I had read some of these blog posts while I was interviewing. Spolsky says that recruiters should ask &ldquo;impossible questions&rdquo; and not worry about what the answers given are, just that the recruit comes up with something. He says to stop asking trivia questions. He talks about relying on all interviewers equally: if any two interviewers say &ldquo;No&rdquo; to a candidate, the candidate is toast. He talks about asking candidates about projects and looking for passion, which is almost always the sign of a good programmer.</p>

<p>Spolsky talks about the commodity market of software/hardware. To sum it up, the supply of one drives the demand of the other. This section made me think about the current PC market: hardware is cheap <em>and</em> software is cheap. Not only is software cheap, but it&rsquo;s often <em>free</em>. Prices for hardware haven&rsquo;t been going down at nearly the rate it used to, but that seems natural as the price approaches the cost of labor and parts. Most of the hardware innovation right now seems to be aimed at the tiny computers in our pockets (or <a href="http://www.google.com/glass/start/">on our face</a>, soon enough). Google&rsquo;s software makes money by displaying ads using its search engine, so Google has entered the market of making software that is compatible with all kinds of different hardware. Google has played the commodities game like a champ, getting hardware running their software into hundreds of millions of pockets.</p>

<p>Some of the weaker parts of the book are when Spolsky talks about .NET. I&rsquo;m not going to go into detail, but when he wrote these posts, .NET was just entering the market. Spolsky starts by bashing .NET for making all the old Windows API code unusable, but in later blog posts falls hard for .NET and starts thinking about ways to rewrite his entire life in .NET.</p>

<p>###Who Would Like This</p>

<p>I believe that programmers are the main audience for this book, and I am a programmer who loved reading it. Spolsky does not talk down to the reader, nor does he dumb down the nitty-gritty technical blog posts.</p>

<p>Programmers who intend to become managers may get added benefit from this book, as Spolsky discusses some interesting recruiting techniques and ways to deal with programmers. My company uses some of Spolsky&rsquo;s advice when hiring engineers (quite a bit of it, thinking back to my interview), and we&rsquo;ve been hiring only the best and brightest cowboys in the Midwest for years.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2013-04-15-tags-in-c-plus-plus-cucumber-tests/">
        Tags in C&#43;&#43; Cucumber tests
      </a>
    </h1>

    <span class="post-date">Mon, Apr 15, 2013</span>

    <p>The project I&rsquo;m working on is slowly adding <a href="https://github.com/cucumber/cucumber-cpp">Cucumber</a> acceptance tests to our massive code base in order to replace aging <a href="https://code.google.com/p/robotframework/">Robot tests</a>. One would think that getting developers on our team to use Cucumber would be east, since it uses <a href="https://code.google.com/p/googletest/">googletest</a> and <a href="https://code.google.com/p/googlemock/">googlemock</a> which we use for our unit tests. Unfortunately, very few people on the team have been motivated to write integration tests using the new framework, so I have very few people to go to when I have problems writing my own integration tests.</p>

<p>The area of the code I deal with uses <a href="http://www.mono-project.com/Embedding_Mono">embedded mono</a> to communicate with some C# libraries that we share with other applications. This means we have unmanaged memory which talks with managed memory. This has caused us more headaches than I care to remember. One such problem is that we have a static object that we only want to create and destroy once. So I write my first Cucumber test:</p>

<p>``` cucumber DoStuff.feature
Feature: Do that thing that we have to do</p>

<p>Scenario: Do it my way
  Given I have done step 1
  When I do step 2
  Then I should see results</p>

<pre><code>
``` c++ DoStuff_StepDefinitions.cpp
#include &lt;cucumber-cpp/defs.hpp&gt;
#include &lt;gtest/gtest.h&gt;
#include &lt;mono/jit/jit.h&gt;

const QString DOMAIN_NAME = &quot;bridge&quot;;

class Context
{
  // The static Mono object
  static MonoDomain *Domain;
}

BEFORE() { Context::Domain = mono_jit_init(DOMAIN_NAME); }

AFTER() { mono_jit_cleanup(Context::Domain); }

GIVEN(&quot;^I have done step 1$&quot;) { /* ... */ }

WHEN(&quot;^I do step 2$&quot;) { /* ... */ }

THEN(&quot;^I should see results$&quot;) { /* ... */ }

</code></pre>

<p>Before my scenario starts, the <code>BEFORE()</code> function is called and my MonoDomain object is created. When the scenario ends, my <code>AFTER()</code> statement is called and the objects in my MonoDomain are cleaned up. Now, I add a second scenario.</p>

<p>``` cucumber DoStuff.feature
Feature: Do that thing that we have to do</p>

<p>Scenario: Do it my way
  &hellip;</p>

<p>Scenario: Do it your way
  &hellip;</p>

<pre><code>
Now I run my Cucumber test, and Mono explodes. Why? Because the ```BEFORE()``` and ```AFTER()``` functions are not _before all_ and _after all_, but _before each_ and _after each_.

So what should we do? Move the function calls in the ```BEFORE()``` and ```AFTER()``` statements into the constructor and destructor of the Context class?

Same problem. Are there ```BEFORE_ALL()``` and ```AFTER_ALL()``` macros? No.

I began to panic. I asked the person who taught me how to write Cucumber tests in C++. Our idea was to create the MonoDomain during what I knew would be the first step, and delete it after what I knew would be the last step. Oh, the horror! That would mean not being able to reuse those steps, not to mention moving the creation/destruction code around anytime I wanted to add new steps or change the order of my previous steps. We also thought about making specific steps and sticking them at the front of the first scenario and at the end of the last scenario. This still meant that the lay developer would have to recognize these first and last steps from the others. I asked my local senior engineer, and his advice was to create separate Cucumber tests for each scenario I intended to create. My plan was to write 6 scenarios in the long-term for this feature, and I really didn't want to turn these very similar tests with beautifully reusable steps into 6 features.

Then it hit me: Cucumber is open source. I found the source [on Github](https://github.com/cucumber/cucumber-cpp) and started looking through [the example code](https://github.com/cucumber/cucumber-cpp/tree/master/examples/). It was there that I discovered [tags](https://github.com/cucumber/cucumber-cpp/tree/master/examples/FeatureShowcase/tag). Tags were the solution to my problem.

``` cucumber DoStuff.feature
Feature: Do that thing that we have to do

@first
Scenario: Do it my way
  ...

@last
Scenario: Do it your way
  ...
</code></pre>

<p>Using tags, I could label my scenarios with meaningful <code>@first</code> and <code>@last</code> tags to signify the beginning and end of my tests. The trick is to then add the required tags to my <code>BEFORE()</code> and <code>AFTER()</code> macro as such:</p>

<p>``` c++ DoStuff_StepDefinitions.cpp
#include <cucumber-cpp/defs.hpp>
#include <gtest/gtest.h>
#include <mono/jit/jit.h></p>

<p>const QString DOMAIN_NAME = &ldquo;bridge&rdquo;;</p>

<p>class Context
{
  // The static Mono object
  static MonoDomain *Domain;
}</p>

<p>BEFORE(&ldquo;@first&rdquo;) { Context::Domain = mono_jit_init(DOMAIN_NAME); }</p>

<p>AFTER(&ldquo;@last&rdquo;) { mono_jit_cleanup(Context::Domain); }</p>

<p>// &hellip;</p>

<p>```</p>

<p>Now my MonoDomain is only created <em>before</em> the scenario labeled <code>@first</code> and <em>after</em> the scenario labeled <code>@last</code>. Obviously, this isn&rsquo;t the cleanest fix imaginable, but it was the cleanest fix <em>available</em>. Whenever someone wants to add a new step to this test, they need to remember to move the <code>@last</code> tag to their scenario. However, I have the hope that it will be pretty obvious that the second scenario is no longer &ldquo;last&rdquo; when there is a third scenario following the &ldquo;last&rdquo; scenario. Anyway, it leaves me happy enough, since now my tests don&rsquo;t explode and I&rsquo;m able to reuse ~50% of the steps I had already written for the first scenario. I added a third scenario later on and 9 out of the 10 steps in the scenario were reused from the first and second scenario.</p>

<p>There are lots of other cool things you can do with Cucumber tags, like having multiple tags on objects. All tags that match <code>@first</code> will do one thing, but tags that match <code>@first</code> and <code>@second</code> can have multiple <code>BEFORE()</code> or <code>AFTER()</code> clauses.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2013-04-09-changing-plans/">
        Changing Plans
      </a>
    </h1>

    <span class="post-date">Tue, Apr 9, 2013</span>

    <p>Your code is being sent to the dump.</p>

<p>Don&rsquo;t take it personally. Your code isn&rsquo;t <em>bad</em>. It&rsquo;s just <em>garbage</em>.</p>

<p>Maybe your code wasn&rsquo;t written the way they wanted you to write it. Or maybe they realized that they had already written this code three months ago. Or maybe the customer suddenly decided that they don&rsquo;t need their smartphone to emit fragrances based on the text message they just received.</p>

<p>The &ldquo;why&rdquo; doesn&rsquo;t matter. Plans changed. Your unused code isn&rsquo;t aging well and it&rsquo;s starting to stink up the place, so just do us all a favor and get it outta here!</p>

<p>As developers, we <em>always</em> take this kind of thing personally. Our code is an extension of ourselves. When we feel good, we write code that&rsquo;s clean and concise. When we feel meh, our code is unimaginative and takes longer to write. When we feel bad, we litter the code with variables that don&rsquo;t do anything and then name them after our managers.</p>

<p>But it&rsquo;s not personal, is it? Management doesn&rsquo;t sit in their mansion each evening, sipping a gin martini while adjusting their toupee, thinking about how worthless you are and how to properly punish you while continuing to pay you. Management has better things to think about, like ditching the toupee in favor of hair plugs or Rogaine or whatever hair fad is popular that day.</p>

<p>Plans change. You can lament your loss of three days of &ldquo;ingenious&rdquo; code that will never see the light of day, but management will be equally depressed about the hundreds (thousands?) of dollars lost paying you to work on something that&rsquo;s not production-worthy. You may feel cheated in the short-term, but hopefully you can get something positive out of this change of plan. Maybe your second attempt at the code will jive better with the base architecture, or maybe you&rsquo;ll be able to extract the functionality you need out of another component and limit code duplication, or maybe you&rsquo;ll be able to deliver a different feature that the customer can actually use.</p>

<p>Sure, there may be an occasional senior engineer who thinks that the program should be implemented his or her way, and will make you throw out anything you write that has any deviation from The Plan (which never quite made it out of their heads and into any documentation). Usually you can satiate that senior engineer by listening to them and nodding your head for a few minutes. There&rsquo;s a reason that engineer carries so much weight on the project, so they&rsquo;ll probably be making a valid point while you nod your head and they&rsquo;ll respect you for agreeing with them, even though you secretly wish you could just keep doing it the way you originally planned.</p>

<p>Don&rsquo;t cry over spilled milk. No one&rsquo;s actually questioning your coding competency when they change the plan. The odds are in your favor that the plan changed in the best interest of the project, and whatever code is being thrown out is likely a necessary casualty to benefit the system as a whole. Remember that most of the code you write is used, at least for a little while, so try not to dwell on the code that isn&rsquo;t.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2013-04-01-whats-still-possible/">
        What&#39;s Still Possible
      </a>
    </h1>

    <span class="post-date">Mon, Apr 1, 2013</span>

    <p>If every Miss America candidate had her way, there would be peace on Earth and all the hungry mouths would be fed. While Earthlings enjoy violence and controlling others too much to achieve world peace, I have a proposal to help feed those around the world who don&rsquo;t have enough to eat.</p>

<p>It&rsquo;s not an ad campaign. I&rsquo;m not going to send random people a nickle in the mail and then tell them that they could use that nickle to feed a starving child. I&rsquo;m certainly not going to change any of my eating habits. I happen to know a huge source of food that we underutilize. My plan is to kill two birds with one stone. Well, preferably something like 3 million birds with however many stones it takes.</p>

<p>I&rsquo;m talking, of course, about the terrible tyranny of the <a href="http://en.wikipedia.org/wiki/Canada_Goose">Canadian Goose</a>. A little history:</p>

<p>Our ancestors domesticated Canadian Geese in ancient times and used these waterfowl for various acts of labor, including pulling tugboats down the Mississippi, plowing the great Canadian rice paddies, and keeping our elderly company during their final days of life. The young goslings flapped gingerly in the meadows pollinating the wildflowers, apple trees, and various other meadow-related objects. Much to our delight, some of our beloved geese bretheren became sentient, and started selling us medical insurance while performing a spot-on <a href="http://en.wikipedia.org/wiki/Gilbert_Gottfried">Gilbert Gottfried</a> impression.</p>

<p>False. I must apologize for fooling you in this way sweet, sweet reader, but everything you read in the last paragraph was neither true nor fact. In reality, Canadian Geese serve no purpose. Canadian Geese were created accidentally during the Manhatten Project while one of the lab techs from the local university was trying to combine nuclear fission and the bubonic plague to get back at his ex-girlfriend for cheating on him. He quickly became bored of this task when she stopped responding to his texts, and thusly tossed the waste from his experiments in the river. The rest, of course, is history.</p>

<p>Now here we are. There are well over <a href="http://www.ducks.org/hunting/waterfowl-id/canada-goose">3 million Canadian Geese nationwide</a>, which is decidedly more than anyone finds pleasant. These geese are no longer afraid of humans, so they tend not to run away from us. In fact, we have spoiled the birds so much that some geese will actually approach humans demanding a bite of stale bread. If no bread gift is offered, the foul fowl will emit a frightening hissing noise, raise its wings, and chase off the poor human. Any sidewalk near a pond quickly becomes covered in goose byproducts during the breeding season, which might as well be year-round. I, for one, think that the geese have gone too far. They ruin our picnics, our walks in the park, our egg-stealing competitions, and our feather-collecting scavenger hunts. It&rsquo;s time for the final showdown: Man versus Goose.</p>

<p>Time to tie in the beginning and the parts where I raved like a lunatic: We hunt the geese, and we feed them to people. &lsquo;Nuff said.</p>

<p>People already hunt geese, of course, but it&rsquo;s clearly not enough. Not to mention that these hunters currently just leave the gooseflesh in the woods where lower animals reap the rewards. I propose we extend goose season year-round, and provide free boxes to encourage hunters to package the gooseflesh and send it to the needy in other countries. We&rsquo;ll poison our waterways to take out as many geese as possible, and we will make a wondrous soup for whomever needs it.</p>

<p>It&rsquo;s still possible to feed the hungry. But we need to <em>focus</em> in order to do it. Man versus Goose is not the solution. It&rsquo;s a demonstration of getting distracted from the original cause. The next time someone tries to get you riled up about feeding the hungry through some crazy scheme, remember that there&rsquo;s no better way than addressing the problem directly. It&rsquo;s still possible to do good in this world if you can avoid the crazy.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2013-03-25-pvreryvre-of-fyne-coddes/">
        Blog Battle: Pvreryvre of fyne coddes
      </a>
    </h1>

    <span class="post-date">Mon, Mar 25, 2013</span>

    <p>Ice pellets bounced off my head as I walked myself home late one night. The air was dreadfully cold, so I swooped into one of Carmel&rsquo;s seedy side alleys to take a shotcut. Out of the shadows crept a man wearing a long trenchcoat and thick-rimmed glasses. Hunched over, he brushed his unkempt hair out of his eyes. His coffee-stained breath rushed from beneath his pencil moustache as he asked, &ldquo;Can I interest you in any of these fine iPhone apps?&rdquo; I tried to cautiously back away. &ldquo;How would you like a real BaZynga game, only ninety-nine cents, it&rsquo;s called Perturbed Birds with Pals?&rdquo; I was briefly distracted by sirens in the distance; by the time I returned my glance to the man&rsquo;s last position he had disappeared, my virtual wallet was empty, and my phone was filled with bloatware and repetitive &lsquo;Ville-style games.</p>

<p>There are more KLOCs in this world than there have been McDonald&rsquo;s hamburgers sold. How do the good programmers differentiate themselves from the common street peddlers? How do companies convince you to pay $2.99 for their app when a clone is released less than a week later for free?</p>

<p>The answer? Maybe they don&rsquo;t. Maybe a comparison can be made between software companies and pharamceutical companies.</p>

<p>Big Pharmaceutical companies spend many years researching, developing, and testing drugs to treat the common cold, arthritis, bad cholesterol, or even to sedate your energetic children. These drugs spend several years on the market where patents on the drug are valid, meaning that only the company that invented the drug can legally sell it. After the patent protections expire (approx 7-12 years), any big, small, or mom &amp; pop drug manufacturer is legally allowed to &ldquo;clone&rdquo; this drug and make what&rsquo;s called a &ldquo;generic.&rdquo; Generics are sold at a fraction of the cost of the original drug. At this point, no one wants to give Big Pharma $20 for 6 tablets to cure their heartburn when they could pay $5 for a year&rsquo;s supply of generics.</p>

<p>Software companies tend to spend somewhere between 12 weeks and 12 months developing apps that will be consumed by the general population. If the company just released an Android or iOS app, then the product will stay relevant somewhere between 2 weeks and 2 years. After that time, the app will either no longer have market value or will need to be revamped to please the modern consumer. Within a short number of days or weeks, there is a high probability that surly software pirates will begin to copy your app and put it on the market for free. At this point, no one wants to give your company $4.99 for an endless runner when they could just as easily find a copy for free. Of course, app developers can submit complaints and get the pirated app taken down, but more and more will crop up as time goes on, and eventually it won&rsquo;t be worth the trouble to get the doppelgangers removed.</p>

<p>For both industries, a company comes up with a novel idea and presents it to the world. People who like that product can start associating the brand name with other products. After recognizing the brand, a person may start to trust that company and look for other products associated with the brand. That company will become known as a purveyor of fine wares.</p>

<p>So here we stand, reader. Make code that you can be proud of; not for getting tens of thousands of downloads, but for scrawling your good name on the white boards of the world in Sharpie. The customers will keep coming back as long as you&rsquo;ve got the cure for what ails them.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2013-02-19-code-complete-second-edition/">
        Code Complete Second Edition
      </a>
    </h1>

    <span class="post-date">Tue, Feb 19, 2013</span>

    <blockquote>
<p>Design is a process of carefully planning small mistakes in order to avoid making big ones.
&ndash; Steve McConnell</p>
</blockquote>

<p>###The Gist</p>

<p><em><a href="http://www.amazon.com/gp/product/0735619670/ref=as_li_tf_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=0735619670&amp;linkCode=as2&amp;tag=larpriandthee-20">Code Complete Second Edition</a></em> by Steve McConnell is the ultimate programmer&rsquo;s handbook, though certainly not a pocket guide considering its massive 850+ page size. This book contains a seemingly endless amount of information regarding the state of programming circa 2004. Topics range from extremely technical, such as making code readable above making it clever, to office politics, such as dealing with non-technical managers.</p>

<p>###My Opinion</p>

<p>McConnell has written an encyclopedia for software development. In doing so, the book sometimes suffers from the &ldquo;wide as an ocean, shallow as a puddle&rdquo; complex. Nonetheless, the book holds an incredible amount of information that I found refreshing to see in print.</p>

<p>The use of the term &ldquo;construction&rdquo; to refer to coding throughout the book is an apt analogy for McConnell&rsquo;s views on the world of software development. Before beginning construction, a team should have a plan. Construction requires a solid base. While constructing a project, individuals should ensure that anyone else could look at their part of the project and figure out what&rsquo;s happening. Working with a partner often improves quality. People doing construction should test their work to ensure the integrity of their product. Redoing lower levels causes a lot of pain. The team is unlikely to hit the original due date. Etc, etc.</p>

<p>Many things in this book go directly against what I was taught in at university. McConnell recites a quote several times in the book:</p>

<blockquote>
<p>Debugging is twice as hard as writing the code in the first place. Therefore, if you write the code as cleverly as possible, you are, by definition, not smart enough to debug it.
&ndash; Brian Kernighan</p>
</blockquote>

<p>At university, we&rsquo;re taught all the secrets of writing clever code: pointer manipulation, recursion, inappropriate variable reuse, and others. We were also never taught to plan ahead (&hellip;besides flowcharts, which were never required) or test, both of which McConnell highly recommends as necessary steps in software development. It&rsquo;s no wonder my programs took so long to debug! Of course, I&rsquo;ve learned to perform these tasks naturally while working as a Real Life Programmer. Reading this book is likely more helpful than taking the first few semesters of programming at university.</p>

<p>A small issue I had was a wishy-washy attitude towards comments. In one chapter, McConnell describes having minimal comments in a code and keeping it mostly self-documenting. He then goes on to show all kinds of different, horrifying comments and justifies why they are sometimes okay.</p>

<p>This is where I will note that <em>Code Complete Second Edition</em> is a book published by <a href="http://en.wikipedia.org/wiki/Microsoft_Press">Microsoft Press</a>. I was often surprised by McConnell&rsquo;s adamance that Visual Basic is the most popular programming language at the time of publishing. Even circa 2004 (the year this book was published), the <a href="http://www.tiobe.com/index.php/content/paperinfo/tpci/index.html">Tiobe index</a> shows VB behind Java, C, and C++. The <a href="https://sites.google.com/site/pydatalog/pypl/PyPL-PopularitY-of-Programming-Language">PyPl index</a> also shows VB behind Java, PHP, C, and C++ in 2004. For the record, VB is a silly language.</p>

<p>###Who Would Like This</p>

<p>This book would be nice required reading for students. Given the length and technical depth, it&rsquo;s practically a textbook. Developers a few years out of university would still enjoy this text, but some topics are so obvious or overdone that many readers may start skipping chapters. If a developer knew of precisely the area he or she wanted to improve, then said developer could likely benefit from perusing a chapter of this book covering that topic.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2013-01-20-pushing-an-application-to-heroku-that-uses-ruby-and-mongo/">
        Pushing an Application to Heroku that Uses Ruby and Mongo
      </a>
    </h1>

    <span class="post-date">Sun, Jan 20, 2013</span>

    <p><em>This is Part 3 in a multi-part series to detail the creation of a &ldquo;simple&rdquo; project combining <a href="http://www.ruby-lang.org/">Ruby</a>, <a href="http://www.mongodb.org/">MongoDB</a>, <a href="http://rspec.info/">RSpec</a>, <a href="http://www.sinatrarb.com/">Sinatra</a>, and <a href="https://github.com/jnicklas/capybara">Capybara</a> in preperation for a larger-scale side project set to begin January 2013. For more in this series, see the <a href="/blog/categories/pokephile">Pokephile category</a>. Part 4 of this series details moving from a development environment to a production environment using <a href="http://heroku.com/">Heroku</a>. The code for this side-project is located <a href="https://github.com/larryprice/Pokephile">on Github</a>, and the final product can be found <a href="http://pokephile.herokuapp.com">here</a>.</em></p>

<p><a href="http://heroku.com/">Heroku</a> is a hosting service for different types of web applications. The best thing about Heroku is it&rsquo;s free, you get a decent subdomain for your application, and there&rsquo;s no spam email. Go ahead and <a href="http://api.heroku.com/signup">sign up</a> if you don&rsquo;t already have an account.</p>

<p>Now we need the Heroku Toolbelt. I&rsquo;ll illustrate for Ubuntu 12.10, but there&rsquo;s also <a href="https://toolbelt.heroku.com/">documentation for installing on any OS</a>.</p>

<pre><code class="language-bash">$ wget -qO- https://toolbelt.heroku.com/install-ubuntu.sh | sh
</code></pre>

<p>The toolbelt installs some Heroku-specific applications in addition to ensuring you have Foreman and <a href="http://git-scm.com/">Git</a> on your system. Now it&rsquo;s time to tell the Heroku Toolbelt who we are.</p>

<p>``` bash Step 3 - Modified Excerpt from the Heroku Getting Started guide
$ heroku login
Enter your Heroku credentials.
Email: larry@example.com
Password:
Could not find an existing public key.
Would you like to generate one? [Yn]
Generating new SSH public key.
Uploading ssh public key /home/larry/.ssh/id_rsa.pub</p>

<pre><code>
In order for Heroku to figure out what ruby gems are needed to run your application, you need to specify a Gemfile. It's wise to specify a specific version of Ruby, and it's also a good idea to keep the gems' versions close to the state you developed with. For the [Pokephile][series-tag] application created in this series, this is my Gemfile:

``` ruby project/Gemfile
source :rubygems

ruby '1.9.3'

gem 'sinatra', '~&gt;1.3.2'
gem 'haml', '~&gt;3.1.6'
gem 'mongoid', '~&gt;3.0.14'

group :development, :test do
	gem 'capybara', '~&gt;2.0.1'
	gem 'rspec', '~&gt;2.11.0'
	gem 'nokogiri', '~&gt;1.5.5'
end
</code></pre>

<p>First I specify a source for my gems: &lsquo;rubygems&rsquo; defaults to &ldquo;<a href="http://rubygems.org&quot;">http://rubygems.org&quot;</a> and hasn&rsquo;t failed me yet. Next I specify that I want to use Ruby 1.9.3, a necessity because Mongoid 3.x doesn&rsquo;t work correctly with 1.9.2. The versions of the first three gems were chosen by typing the following in the command line to determine which version I had installed on my machine:</p>

<pre><code class="language-bash">$ gem query | grep 'sinatra\|haml\|mongoid'
haml (3.1.7, 3.1.6)
mongoid (3.0.17, 3.0.15, 3.0.14)
sinatra (1.3.3, 1.3.2)
sinatra-contrib (1.3.2)
sinatra-reloader (1.0)
</code></pre>

<p>The &lsquo;~&gt;&rsquo; operator tells Bundler to use greater-than-equal but stop before next highest version. So, for Sinatra &lsquo;~&gt;1.3.2&rsquo; means that Bundler will accept anything greater-than-or-equal-to &lsquo;1.3.2&rsquo; and less than &lsquo;1.4.0.&rsquo; I tend to rely on the &lsquo;~&gt;&rsquo; operator so I can be sure no APIs are changed in my gems.</p>

<p>The next block is a conditional checking in which environment the gems are being installed. This defaults to :development if none is specified. I put the gems used for testing in this block since they&rsquo;re not needed to run the application, but a developer/tester would need these to run the tests.</p>

<p>For this Gemfile to be meaningful, we need to use a program called <a href="http://gembundler.com/">Bundler</a> to &ldquo;bundle&rdquo; the gems and their dependencies in a Gemfile.lock file.</p>

<pre><code class="language-bash">$ pwd
project/
$ sudo apt-get install bundler
...
$ bundle install
...
Your bundle is complete! Use `bundle show [gemname]` to see where a bundled gem is installed.
</code></pre>

<p>Running bundler will create a Gemfile.lock file and make sure your system has the specified gems. If some gems are missing or need new versions to be installed, bundler will ask the user for their password to get the required gems.</p>

<p>The next step for setting things up is to set up Git. If your application is already using Git, you only need to commit all files to verify that the Gemfile and Gemfile.lock make it into the repository.</p>

<pre><code class="language-bash">$ cd project/
$ git init
$ git add .
$ git commit -m &quot;Initial commit.&quot;
</code></pre>

<p>Now we create a Heroku project and give it a meaningful name. If you can&rsquo;t think of a meaningful name, use &lsquo;heroku create&rsquo; and Heroku will come up with something for you.</p>

<pre><code class="language-bash">$ heroku create meaningful-name
Creating meaningful-name... done, stack is cedar
http://meaningful-name.herokuapp.com/ | git@heroku.com:meaningful-name.git
Git remote heroku added
</code></pre>

<p>We&rsquo;re almost there. Because we included accessing Mongo databases in our application, we have to take care of that on the web. The easiest way to do that is using a Heroku Add-on. At this time, there are two major Heroku Add-ons for Mongo databases: <a href="https://addons.heroku.com/mongolab">MongoLab</a> and <a href="https://addons.heroku.com/mongohq">MongoHQ</a>. Both services have a starter service for $0/month, which is pretty awesome in my opinion. I flipped a coin and picked MongoLab for this application. Adding the add-on to our project:</p>

<pre><code class="language-bash">$ heroku addons:add mongolab:starter
</code></pre>

<p>If you haven&rsquo;t already, Heroku will ask you to &ldquo;verify your account&rdquo; before continuing. This means that you have to put in some credit card information. Note that you will not be charged, I guess Heroku just wants some indication that you might eventually pay for something. After you put in your credit card information, you may need to run the above command again.</p>

<p>Now that MongoLab is set up on the server-side, we need to tell Mongoid how to connect to that server. The following command will give you the environment variable needed to connect to the server:</p>

<pre><code class="language-bash">$ heroku config | grep MONGOLAB_URI
</code></pre>

<p>Now we update our mongoid.yml file to use that string:</p>

<p>``` yml project/mongoid.yml
development:
  sessions:
    default:
      database: dev
      hosts:
        - localhost
  options:</p>

<p>test:
  sessions:
    default:
      database: test
      hosts:
        - localhost</p>

<p>production:
  sessions:
    default:
      uri: &lt;%= ENV[&lsquo;MONGOLAB_URI&rsquo;] %&gt;
      options:
        skip_version_check: true
        safe: true</p>

<pre><code>
Because of the way my application works, I want to prepopulate the database with some Pokemon.

``` bash
$ export MONGOLAB_URI=`heroku config | grep MONGOLAB_URI | cut -c 15-`
$ pwd
project/
$ cd tools/populate
$ irb
&gt;&gt; require './populater'
true
&gt;&gt; require 'mongoid'
true
&gt;&gt; Mongoid.load! '../../mongoid.yml', :production
{&quot;sessions&quot;=&gt;{&quot;default&quot;=&gt;{&quot;uri&quot;=&gt;nil, &quot;options&quot;=&gt;{&quot;skip_version_check&quot;=&gt;true, &quot;safe&quot;=&gt;true}}}}
&gt;&gt; Populater.new.add_pokemon 1000
nil
</code></pre>

<p>With the production database populated, we need to set an environment variable in our production application defining the environment.</p>

<pre><code class="language-bash">$ heroku config:add MONGOID_ENV=production
</code></pre>

<p>Now that we&rsquo;ve made changes to the mongoid.yml file, we should commit again and push to Heroku.</p>

<pre><code class="language-bash">$ git commit -a -m &quot;Updating mongoid.yml file for production&quot;
...
$ git push heroku master
</code></pre>

<p>And that&rsquo;s it! Check your Heroku URL to make sure everything looks okay and call it a day, or make some upgrades as I did for my <a href="http://pokephile.herokuapp.com">personal version of this project</a>.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2013-01-19-testing-a-sinatra-app-with-capybara/">
        Testing a Sinatra App with Capybara
      </a>
    </h1>

    <span class="post-date">Sat, Jan 19, 2013</span>

    <p><em>This is Part 3 in a multi-part series to detail the creation of a &ldquo;simple&rdquo; project combining <a href="http://www.ruby-lang.org/">Ruby</a>, <a href="http://www.mongodb.org/">MongoDB</a>, <a href="http://rspec.info/">RSpec</a>, <a href="http://www.sinatrarb.com/">Sinatra</a>, and <a href="https://github.com/jnicklas/capybara">Capybara</a> in preperation for a larger-scale side project set to begin January 2013. For more in this series, see the <a href="/blog/categories/pokephile">Pokephile category</a>. Part 3 of this series describes using Capybara to test a Sinatra application. The code for this side-project is located <a href="https://github.com/larryprice/Pokephile">on Github</a>, and the final product can be found <a href="http://pokephile.herokuapp.com">here</a>.</em></p>

<p>Now that <a href="/blog/2013/01/05/schemaless-databases-with-ruby-and-mongodb/">the database is populated</a> with data and I&rsquo;ve switched over to <a href="/blog/2013/01/05/moving-from-the-mongodb-ruby-driver-to-mongoid/">a simpler interface with Mongo</a>, I can actually start creating a UI. For simplicity&rsquo;s sake, I like to use Sinatra on small projects. Sinatra makes it easy to create a web application with minimal effort. With an emphasis on testing this <a href="/blog/categories/pokephile">series</a>, I want to be sure to throughly test my UI and any application integration. <a href="http://cukes.info/">Cucumber</a> is a brilliant DSL which allows a programmer to describe in plain English how an application should be behaving. The <a href="https://github.com/jnicklas/capybara">Capybara gem</a> is a Rack app that simulates running your application and performing basic user tasks, such as clicking a button, following a link, or, on a lower level, looking at your HTML source. Install Capybara like so:</p>

<pre><code class="language-bash">sudo gem install capybara
</code></pre>

<p>Here&rsquo;s what I want my application to do:</p>

<ul>
<li>User is on home page.</li>
<li>User enters name of Pokemon and presses &lsquo;Search&rsquo;.</li>
<li>User is redirected to search page.</li>
<li>User can see some information about Pokemon.</li>
<li>User can repeat the search process.</li>
</ul>

<p>Error scenario:</p>

<ul>
<li>User enters garbage data.</li>
<li>User is redirected to search page.</li>
<li>User sees error message.</li>
<li>User can repeat search process.</li>
</ul>

<p>So I&rsquo;ll begin by writing my features. Cucumber syntax is meant to be readable by non-technical persons, so the &ldquo;code&rdquo; may look a bit odd. All Cucumber feature files are written something like this:</p>

<pre><code class="language-Cucumber">Feature: Viewer visits the Home Page
  In order to read the page
  As a viewer
  I want to see the home page of my app

Scenario: View the home page
	Given I am on the home page
	Then I should see &quot;Zowee, mama!&quot; on the page
</code></pre>

<p>The &ldquo;Feature&rdquo; lines are not used in testing; they are simply to give some relevance to the file&rsquo;s feature and to attempt to prevent scope creep in the file. The &ldquo;Scenario&rdquo; lines are what&rsquo;s important. The first line is the test name, the &ldquo;Given&rdquo; line is the pre-condition, and the final line is what should be observed.</p>

<p>In reality, I have only one main feature: &ldquo;Search.&rdquo; One can argue that I also have a feature of &ldquo;seeing&rdquo; my home page and my search page, but those are both trivial cases, so for the purpose of this blog post, I&rsquo;ll skip such tests. Both my success and error case revolves around searching, and there&rsquo;s not really much else to do in the app. I have to create a directory for the cukes, and that directory is called &ldquo;features.&rdquo; I create such a directory in my &ldquo;project/tools/test&rdquo; directory and create a new file called &ldquo;search.feature.&rdquo; Now I&rsquo;ll write the feature:</p>

<p>``` Cucumber project/tools/test/features/search.feature
Feature: Viewer vists the page
    In order to search the page
    As a visitor
    I want to search for Pokemon.</p>

<p>Scenario: Find correct Pokemon from home page
    Given I am on the home page
    When I type &ldquo;Bulbasaur&rdquo; in the search bar
    And I click &ldquo;Search&rdquo;
    Then I should be on the &ldquo;search&rdquo; page
    And I should see &ldquo;#001 - Bulbasaur&rdquo;
    And I should see an image with url &ldquo;<a href="http://img.pokemondb.net/artwork/bulbasaur.jpg&quot;">http://img.pokemondb.net/artwork/bulbasaur.jpg&quot;</a>
    And I should see &ldquo;Types: Grass, Poison&rdquo;</p>

<p>Scenario: Show error text from home page
    Given I am on the home page
    When I type &ldquo;Johnny Bravo&rdquo; in the search bar
    And I click &ldquo;Search&rdquo;
    Then I should be on the &ldquo;search&rdquo; page
    And I should see &ldquo;Lol! Could not find a Pokemon named &lsquo;Johnny Bravo.&rsquo; Try something else!&rdquo;</p>

<p>Scenario: Find correct Pokemon from search page
    Given I am on the search page
    When I type &ldquo;Bulbasaur&rdquo; in the search bar
    And I click &ldquo;Search&rdquo;
    Then I should see &ldquo;#001 - Bulbasaur&rdquo;
    And I should see an image with url &ldquo;<a href="http://img.pokemondb.net/artwork/bulbasaur.jpg&quot;">http://img.pokemondb.net/artwork/bulbasaur.jpg&quot;</a>
    And I should see &ldquo;Types: Grass, Poison&rdquo;</p>

<p>Scenario: Show error text from search page
    Given I am on the search page
    When I type &ldquo;Johnny Bravo&rdquo; in the search bar
    And I click &ldquo;Search&rdquo;
    Then I should be on the &ldquo;search&rdquo; page
    And I should see &ldquo;Lol! Could not find a Pokemon named &lsquo;Johnny Bravo.&rsquo; Try something else!&rdquo;</p>

<pre><code>
Now I've overlooked a lot of tests that one would normally write while doing this, such as verifying that the search bar and search buttons exist and are enabled, but I'd like to keep it simple for now and just stick to testing my search feature. What do these tests do? The first scenario starts on the home page, enters data in the search box, presses the search button, and then verifies that all expected Pokemon data is visible. When writing cukes, I can append statements with an &quot;And&quot; statement as seen above. Run Cucumber:

``` sh project/tools/test
$ cucumber
</code></pre>

<p>Cucumber doesn&rsquo;t exactly give us errors, but it also doesn&rsquo;t give us success. Fortunately, what it did give us was sample code for all of the steps we need to write. So, let&rsquo;s perform some copy/paste magic and create a steps file:</p>

<p>``` sh project/tools/test
$ mkdir -p features/step_definitions
$ touch features/step_definitions/search_steps.rb</p>

<pre><code>
``` ruby project/tools/test/features/step_definitions/search_steps.rb
Given /^I am on the home page$/ do
  pending # express the regexp above with the code you wish you had
end

When /^I type &quot;(.*?)&quot; in the search bar$/ do |arg1|
  pending # express the regexp above with the code you wish you had
end

When /^I click &quot;(.*?)&quot;$/ do |arg1|
  pending # express the regexp above with the code you wish you had
end

Then /^I should be on the &quot;(.*?)&quot; page$/ do |arg1|
  pending # express the regexp above with the code you wish you had
end

Then /^I should see &quot;(.*?)&quot;$/ do |arg1|
  pending # express the regexp above with the code you wish you had
end

Then /^I should see an image with url &quot;(.*?)&quot;$/ do |arg1|
  pending # express the regexp above with the code you wish you had
end

Given /^I am on the search page$/ do
  pending # express the regexp above with the code you wish you had
end
</code></pre>

<p>If I futilely run &ldquo;cucumber&rdquo; again now, my tests still don&rsquo;t pass because I haven&rsquo;t actually implemented my steps. This is where Capybara comes in. I found that a <a href="https://gist.github.com/428105">Capybara cheat sheet</a> is quite helpful while writing out my steps. The syntax I&rsquo;m going to use is similar to RSpec, except that it includes some Capybara methods. The first two test steps I want to deal with are the &ldquo;Given&rdquo; steps.</p>

<p>``` ruby project/tools/test/features/step_definitions/search_steps.rb
Given /^I am on the home page$/ do
  visit &lsquo;/&rsquo;
end</p>

<p>Given /^I am on the search page$/ do
  visit &lsquo;/&rsquo;
  click_button &ldquo;Search&rdquo;
end</p>

<pre><code>
All these statements are just Regular Expressions, as indicated by the /^$/. The regex acts as a sort of method name that Cucumber finds to run the steps. Given I am on the home page is trivial: just 'visit' the index. Given I am on the search page will first require me to click the &quot;search&quot; button. This is valid because my spec above says this is how to get to the search page. Now can do the 'When' statements.

``` ruby project/tools/test/features/step_definitions/search_steps.rb
When /^I type &quot;(.*?)&quot; in the search bar$/ do |arg1|
  fill_in &quot;pokemon-input&quot;, :with =&gt; arg1
end

When /^I click &quot;(.*?)&quot;$/ do |arg1|
  click_button arg1
end
</code></pre>

<p>When I click just needs to click a button/link/whatever on the screen. The &ldquo;(.*?)&rdquo; is a regular expression that will match anything in quotes and assign it to the variable &lsquo;arg1.&rsquo; So I can give any button description and Capybara will try to click a button with the given content. When I type in the search bar takes the regex arg1 and uses the &ldquo;fill_in&rdquo; method to fill in a text input with id &ldquo;pokemon-input.&rdquo; The rest of the steps are all about what should be observed after performing the Given/When steps.</p>

<p>``` ruby project/tools/test/features/step_definitions/search_steps.rb
Then /^I should be on the &ldquo;(.*?)&rdquo; page$/ do |arg1|
  current_path.should == &ldquo;/#{arg1}&rdquo;
end</p>

<p>Then /^I should see &ldquo;(.*?)&ldquo;$/ do |arg1|
  page.should have_content(arg1)
end</p>

<p>Then /^I should see an image with url &ldquo;(.*?)&ldquo;$/ do |arg1|
  find(:xpath, &ldquo;//img[@src=&lsquo;#{arg1}&rsquo;]&ldquo;).should_not be_nil
end</p>

<pre><code>
Now I have all of the necessary steps defined! So, I'll run Cucumber and... Actual errors! None of my four tests made it past the Given step, so I see the output '(4 failed, 19 skipped).' The only way to fix these errors is to finally start writing a web application. So I'll move back out to the root of my project directory and create a file for my application called 'app.rb' and give it the most basic information to run. And, if you haven't already, install Sinatra.

``` bash
$ sudo gem install sinatra
</code></pre>

<p>``` ruby project/app.rb
require &lsquo;sinatra&rsquo;
require &lsquo;haml&rsquo;</p>

<p>class Application &lt; Sinatra::Base
    get &lsquo;/&rsquo; do
        haml :index
    end
end</p>

<pre><code>
The Application class inherits from the Sinatra::Base class. This allows me to define a 'get' operation to perform actions and load a web page. 'get \'\' do' signifies the first page a user sees when they go to my web application, commonly known as a home or index page. I plan to use [HAML][haml] to create my page, so I make a call to haml followed by the name of my HAML document as a symbol. We need to define an 'index.haml' page and stick it in a directory called 'views' for Sinatra to find it.



``` bash
$ sudo gem install haml
</code></pre>

<p>``` haml project/views/index.haml
!!!
%html
    %head
        %title Pokemon App
    %body
        LOL HAI.</p>

<pre><code>
Tough work. If you're not familiar with HAML, it's a markup language that is &quot;compiled&quot; into an HTML page. The main difference between HAML and HTML is that HAML parses white space to figure out where closing tags should be placed. So now I want to run my application. I want to run it using 'rackup,' so I'd like to define a 'config.ru' file in the root of my project directory to do all the work for me.

``` ruby project/config.ru
require './app'

run Application.new
</code></pre>

<p>Now we run &lsquo;rackup&rsquo; from the root of my project directory and see the fruits of my labor. Open up a web browser and enter &lsquo;localhost:9292&rsquo; in the address bar. You should see a very simple web page with the content of &ldquo;LOL HAI&rdquo; and a title of &ldquo;Pokemon App.&rdquo; If you view the source, you&rsquo;ll see the HTML the HAML was compiled into. Just beautiful, isn&rsquo;t it? Now if I switch back to my test directory and run Cucumber, what happens? The same result. That&rsquo;s because I need to tell Capybara what to load before trying to run the tests. I do this by defining an &ldquo;env.rb&rdquo; file in a &ldquo;support&rdquo; directory of the features directory.</p>

<p>``` ruby project/tools/test/features/support/env.rb
require &lsquo;capybara&rsquo;
require &lsquo;capybara/cucumber&rsquo;</p>

<p>require_relative &ldquo;../../../../app&rdquo;</p>

<p>Capybara.app = Application</p>

<pre><code>
All I do is require my &quot;app.rb&quot; file which is seemingly _forever_ away and then set the Capybara.app variable to my Application class. Now I run Cucumber and... '(4 failed, 17 skipped, 2 passed)' Two steps passed! Yippee! Now if only the rest passed as well. Looking at my 'search.feature' file, I can see that the first 'When' step is about typing into the search bar. So my first design decision is what kind of search bar I want. I've opted for the fun way out: using the [Twitter Bootstrap's][boots] [typeahead][typeahead]. The typeahead has functionality to give suggestions while the user types, and the best news is this is already coded for us. Adding the code for my search bar and a search button:




``` haml project/views/index.haml
!!!
%html
	%head
		%title Pokemon App
		%link(rel=&quot;stylesheet&quot; href=&quot;http://twitter.github.com/bootstrap/assets/css/bootstrap.css&quot;)
	%body
		%script{:type =&gt; &quot;text/javascript&quot;, :src  =&gt; &quot;http://code.jquery.com/jquery.min.js&quot;}
		%script{:type =&gt; &quot;text/javascript&quot;, :src  =&gt; &quot;http://twitter.github.com/bootstrap/assets/js/bootstrap-typeahead.js&quot;}
		#search{:style =&gt; &quot;position: absolute; width: 100%; text-align: center; top: 10%;&quot;}
			%form{:action =&gt; &quot;search&quot;, :method =&gt; &quot;POST&quot;, :id =&gt; &quot;pokemon-search&quot;}
				%input{:type =&gt; &quot;text&quot;, :class =&gt; &quot;input-large&quot;, :id =&gt; &quot;pokemon-input&quot;, :name =&gt; &quot;pokemon&quot;, &quot;data-provide&quot;=&gt;&quot;typeahead&quot;, &quot;data-items&quot;=&gt;&quot;10&quot;, &quot;autocomplete&quot;=&gt;&quot;off&quot;, :autofocus =&gt; &quot;&quot;, :placeholder =&gt; &quot;Find a Pokémon...&quot;, &quot;data-source&quot; =&gt; Pokemon.only(:name).map {|x| x.name}}
				%button{:type=&gt;&quot;submit&quot;, :class =&gt; &quot;btn btn-small&quot;, :style =&gt; &quot;margin-bottom: 10px; font-weight: bold;&quot;}
					Search
</code></pre>

<p>In the &lt;head&gt; tag, I include a link to the Bootstrap stylesheet. In the &lt;body&gt; tag, I include a link to the JQuery and Bootstrap Typeahead JavaScript files remotely so I don&rsquo;t have to keep track of them. I then add a &lt;div&gt; tag called &ldquo;search&rdquo; and center it on the page. Inside the div tag I create a form whose action sends a POST signal to the &ldquo;search&rdquo; action. Inside the form is first the typeahead, then a small submit button. The important parameters in the typeahead are &ldquo;data-items&rdquo; and &ldquo;data-source;&rdquo; &ldquo;data-items&rdquo; tells the JavaScript function how many items to suggest at a time, and &ldquo;data-source&rdquo; is an array of data for the JavaScript to search. Notice that my &ldquo;data-source&rdquo; uses the Pokemon class <a href="/blog/2013/01/05/schemaless-databases-with-ruby-and-mongodb/">created previously</a>, so I need to be able to set up a <a href="/blog/2013/01/05/moving-from-the-mongodb-ruby-driver-to-mongoid/">Mongoid connection</a> to access that data. I&rsquo;ll make this connection in my &ldquo;config.ru&rdquo; file:</p>

<p>``` ruby project/config.ru
require &lsquo;./app&rsquo;
require &lsquo;mongoid&rsquo;</p>

<p>class Application
    configure do
        Mongoid.load! &lsquo;mongoid.yml&rsquo;
    end
end</p>

<p>run Application.new</p>

<pre><code>
I have chosen to extend the Application class in my &quot;config.ru&quot; file to prevent interference with my test setups later. Taking a look at the application would be a good idea, but if I run &quot;rackup&quot; now Mongoid will complain about environment setup. By default, &quot;Mongoid.load!&quot; will try to load the &quot;development&quot; settings, so I need to include a &quot;development&quot; setup in my &quot;mongoid.yml.&quot; For now, it's going to be identical to my &quot;test&quot; environment setup except for the database name:

``` yml project/mongoid.yml
test:
  sessions:
    default:
      database: test
      hosts:
        - localhost

development:
  sessions:
    default:
      database: dev
      hosts:
        - localhost

</code></pre>

<p>And ensuring some Pokemon are in the &ldquo;dev&rdquo; database:</p>

<p>``` bash Populating the dev database
$ irb
&gt;&gt; Dir.pwd
=&gt; &ldquo;project/tools/populate&rdquo;
&gt;&gt; require &lsquo;mongoid&rsquo;
=&gt; true
&gt;&gt; Mongoid.load! &lsquo;../../mongoid.yml&rsquo;
=&gt; {&ldquo;sessions&rdquo;=&gt;{&ldquo;default&rdquo;=&gt;{&ldquo;database&rdquo;=&gt;&ldquo;dev&rdquo;, &ldquo;hosts&rdquo;=&gt;[&ldquo;localhost&rdquo;]}}}
&gt;&gt; require &lsquo;./populater&rsquo;
=&gt; true
&gt;&gt; Populater.new.add_pokemon 152
=&gt; nil
&gt;&gt;</p>

<pre><code>
And requiring the Pokemon model in app.rb:

``` ruby project/app.rb
require 'sinatra'
require 'haml'

require_relative 'pokemon'

class Application &lt; Sinatra::Base
	get '/' do
		haml :index
	end
end
</code></pre>

<p>Finally, run &lsquo;rackup&rsquo; from the root of the &lsquo;project&rsquo; directory and load up the web application at &lsquo;localhost:9292.&rsquo; There&rsquo;s now a typeahead and a search button in the top center of the page, and typing in the &lsquo;Search&rsquo; bar shows up to 10 suggestion Pokemon. Now I&rsquo;ll return to my Cucumber tests. I need to add a line in the &lsquo;env.rb&rsquo; file to set up the Mongoid environment and ensure there are Pokemon in the collection.</p>

<p>``` ruby project/tools/test/features/support/env.rb
require &lsquo;capybara&rsquo;
require &lsquo;capybara/cucumber&rsquo;
require &lsquo;mongoid&rsquo;</p>

<p>require_relative &lsquo;../../../populate/populater&rsquo;
require_relative &ldquo;../../../../app&rdquo;</p>

<p>Mongoid.load! &lsquo;../../mongoid.yml&rsquo;, :test</p>

<p>Populater.new.add_pokemon(10)</p>

<p>Capybara.app = Application</p>

<pre><code>
Now I can run Cucumber and see some jovial results: '(4 failed, 9 skipped, 10 passed).' I now have more steps passing than failing! The root cause of the failures is that there currently is no &quot;search&quot; page; let's fix that:

``` ruby project/app.rb
...
class Application &lt; Sinatra::Base
	...
	post '/search' do
		haml :search
	end
end
</code></pre>

<p>I want my search page to have a search bar just like my index page. If I want them to be identical, I want to only have to change that code once. When writing HAML, I can create a &lsquo;layout.haml&rsquo; file to act as a base page for my application and move all the text from &lsquo;index.haml.&rsquo; I&rsquo;ll add a &lsquo;=yield&rsquo; statement where I want the information from &lsquo;index.haml&rsquo; and &lsquo;search.haml&rsquo; to be placed.</p>

<p>``` haml project/views/layout.haml
!!!
%html
    %head
        %title Pokemon App
        %link(rel=&ldquo;stylesheet&rdquo; href=&ldquo;<a href="http://twitter.github.com/bootstrap/assets/css/bootstrap.css&quot;">http://twitter.github.com/bootstrap/assets/css/bootstrap.css&quot;</a>)
    %body
        %script{:type =&gt; &ldquo;text/javascript&rdquo;, :src  =&gt; &ldquo;<a href="http://code.jquery.com/jquery.min.js&quot;">http://code.jquery.com/jquery.min.js&quot;</a>}
        %script{:type =&gt; &ldquo;text/javascript&rdquo;, :src  =&gt; &ldquo;<a href="http://twitter.github.com/bootstrap/assets/js/bootstrap-typeahead.js&quot;">http://twitter.github.com/bootstrap/assets/js/bootstrap-typeahead.js&quot;</a>}
        #search{:style =&gt; &ldquo;position: absolute; width: 100%; text-align: center; top: 10%;&ldquo;}
            %form{:action =&gt; &ldquo;search&rdquo;, :method =&gt; &ldquo;POST&rdquo;, :id =&gt; &ldquo;pokemon-search&rdquo;}
                %input{:type =&gt; &ldquo;text&rdquo;, :class =&gt; &ldquo;input-large&rdquo;, :id =&gt; &ldquo;pokemon-input&rdquo;, :name =&gt; &ldquo;pokemon&rdquo;, &ldquo;data-provide&rdquo;=&gt;&ldquo;typeahead&rdquo;, &ldquo;data-items&rdquo;=&gt;&ldquo;10&rdquo;, &ldquo;autocomplete&rdquo;=&gt;&ldquo;off&rdquo;, :autofocus =&gt; &ldquo;&rdquo;, :placeholder =&gt; &ldquo;Find a Pokémon&hellip;&rdquo;, &ldquo;data-source&rdquo; =&gt; Pokemon.only(:name).map {|x| x.name}}
                %button{:type=&gt;&ldquo;submit&rdquo;, :class =&gt; &ldquo;btn btn-small&rdquo;, :style =&gt; &ldquo;margin-bottom: 10px; font-weight: bold;&ldquo;}
                    Search
        =yield</p>

<pre><code>
``` haml project/views/index.haml
#search-text{:style =&gt; &quot;position: absolute; width: 100%; text-align: center; top: 2%; font-weight: bold;&quot;}
	Begin typing to search for your Pokemon!
</code></pre>

<p>At this point, I&rsquo;ll create a &lsquo;search.haml&rsquo; file in the &lsquo;views&rsquo; directory, but leave it empty. Running Cucumber now, I get &lsquo;(4 failed, 4 skipped, 15 passed).&rsquo; Pretty close! All I fail now is actually seeing the desired information on the page. First I want to get access to the Pokemon searched for: I can do that by parsing the params passed to us in app.rb:</p>

<p>``` ruby project/app.rb
&hellip;</p>

<p>class Application &lt; Sinatra::Base
    &hellip;
    post &lsquo;/search&rsquo; do
        @pokemon = Pokemon.where(name: params[:pokemon]).first
        haml :search
    end
end</p>

<pre><code>
So now on my search page:

``` haml project/views/search.haml
#search-text{:style =&gt; &quot;position: absolute; width: 100%; text-align: center; top: 2%; font-weight: bold;&quot;}
	Search for another Pokemon.
#search-results{:style =&gt; &quot;position: absolute; width: 100%; text-align: center; top: 20%; font-weight: bold;&quot;}
	%img{:src =&gt; @pokemon.image, :height =&gt; &quot;250px&quot;}
	%br
	= &quot;##{@pokemon.number} - #{@pokemon.name}&quot;
	%br
	= &quot;Types: #{@pokemon.types.first}#{@pokemon.types.count &lt; 2 ? ' ' : ', ' + @pokemon.types.last}&quot;
</code></pre>

<p>I reference the class variable &ldquo;@pokemon&rdquo; and access its data. To output Ruby-formatted strings, I use an &ldquo;=&rdquo; sign. Running Cucumber, I now see &lsquo;(2 failed, 21 passed).&rsquo; 2 of my 4 tests are passing! A trivial amount of investigation reveals that I didn&rsquo;t deal with the situation where the user types in garbage data. That can mostly be done in the HAML file, but I also want a way to get the bad text the user gave me so they can see what was wrong.</p>

<p>``` haml project/views/search.haml
#search-text{:style =&gt; &ldquo;position: absolute; width: 100%; text-align: center; top: 2%; font-weight: bold;&ldquo;}
    Search for another Pokemon.
#search-results{:style =&gt; &ldquo;position: absolute; width: 100%; text-align: center; top: 20%; font-weight: bold;&ldquo;}
    - unless @pokemon.nil?
        %img{:src =&gt; @pokemon.image, :height =&gt; &ldquo;250px&rdquo;}
        %br
        = &ldquo;##{@pokemon.number} - #{@pokemon.name}&rdquo;
        %br
        = &ldquo;Types: #{@pokemon.types.first}#{@pokemon.types.count &lt; 2 ? &lsquo; &rsquo; : &lsquo;, &rsquo; + @pokemon.types.last}&rdquo;
    - else
        = &ldquo;Lol! Could not find a Pokemon named &lsquo;#{@name}.&rsquo; Try something else!&rdquo;</p>

<pre><code>
``` ruby project/app.rb
...
class Application &lt; Sinatra::Base
	...
	post '/search' do
		@name = params[:pokemon]
		@pokemon = Pokemon.where(name: @name).first
		haml :search
	end
end
</code></pre>

<p>Ruby code with no output is preceded with a &lsquo;-&rsquo; and because HAML is space-sensitive, there&rsquo;s no need to include &lsquo;end&rsquo; statements. Now I run Cucumber and&hellip; 4 scenarios/23 steps passed! I have a functional web application! Of course, the page itself is somewhat bland, some of the styles could be put in a stylesheet and reused, and the only tests I&rsquo;ve written are for super-high-level functionality. Those are all problems someone with infinite time would deal with, so I&rsquo;ll just leave the page is is for now.</p>

<p>The next blog post <a href="/blog/categories/pokephile">in this series</a> will be about deploying this application to the web using Heroku.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2013-01-05-moving-from-the-mongodb-ruby-driver-to-mongoid/">
        Moving from the MongoDB Ruby Driver to Mongoid
      </a>
    </h1>

    <span class="post-date">Sat, Jan 5, 2013</span>

    <p>This is Part 2 in a multi-part series to detail the creation of a &ldquo;simple&rdquo; project combining <a href="http://www.ruby-lang.org/">Ruby</a>, <a href="http://www.mongodb.org/">MongoDB</a>, <a href="http://rspec.info/">RSpec</a>, <a href="http://www.sinatrarb.com/">Sinatra</a>, and <a href="https://github.com/jnicklas/capybara">Capybara</a> in preperation for a larger-scale side project set to begin January 2013. For more in this series, see the <a href="/blog/categories/pokephile">Pokephile category</a>. Part 2 details refactoring code using the MongoDB Ruby driver to use Mongoid. The code for this side-project is located <a href="https://github.com/larryprice/Pokephile">on Github</a>.</p>

<p>###What I&rsquo;ve Done</p>

<p>In a <a href="/blog/2013/01/05/schemaless-databases-with-ruby-and-mongodb/">previous post</a>, I described creating a class that would populate a database with data scraped from the internet. I used the MongoDB Ruby driver to accomplish this. However, using the driver can be laborious and there are simpler ways. In this post, I&rsquo;m going to refactor the Populater class to use Mongoid.</p>

<p>###Mongoid###</p>

<p><a href="http://http://mongoid.org/en/mongoid/index.html">Mongoid</a> (pronounced mann-goyd) is an Object-Document Wrapper for Ruby. Using mongoid abstracts some of the database operations that must be performed when using the MongoDB Ruby driver. It comes in handy when using models in an MVC application. To install the Mongoid gem:</p>

<pre><code>sudo gem install mongoid
</code></pre>

<p>###Refactoring###</p>

<p>In populater.rb, we only inserted one structure of document into our &ldquo;pokemons&rdquo; collection. That makes this a great opportunity to use Mongoid. We remember that there were four fields in our document: number (string), name (string), image link (string), and types (array). Knowing this, we can create a model for this data:</p>

<p>``` ruby project/pokemon.rb
require &lsquo;mongoid&rsquo;</p>

<p>class Pokemon
    include Mongoid::Document</p>

<pre><code>field :number, type: String
field :name, type: String
field :types, type: Array
field :image, type: String
</code></pre>

<p>end</p>

<pre><code>
And that's it for our model. Although we specified the types in this case, it's not necessary if we want a looser definition of our model. Here's how we change our implementation file:

``` ruby project/tools/populate/populater.rb
#require 'mongo' #deleted
require_relative '../../pokemon' #added
require 'nokogiri'
require 'open-uri'

class Populater
	#def initialize(db_name) #removed
  def initialize #added
      #@col = Mongo::Connection.new.db(db_name)[&quot;pokemons&quot;] #deleted
      #@col.remove #deleted
      Pokemon.delete_all #added
      @data = Nokogiri::HTML(open(&quot;http://pokemon.wikia.com/wiki/List_of_Pok%C3%A9mon&quot;))
  end

  def add_pokemon(num_to_add)
    @data.xpath(&quot;//table[@class='wikitable sortable']/tr&quot;).each do |row|
        break if num_to_add &lt;= 0
        dex_num = row.at_xpath('td/text()').to_s.strip
        next if dex_num.nil? || dex_num.empty?
        dex_name = row.at_xpath('td[2]/a/text()').to_s.strip

        unless dex_num == &quot;000&quot;
            type_1 = row.at_xpath('td[4]/a/span/text()').to_s.strip
            type_2 = row.at_xpath('td[5]/a/span/text()').to_s.strip || row.at_xpath('td[5]/text()').to_s.strip
            image_link = &quot;http://img.pokemondb.net/artwork/#{dex_name.downcase}.jpg&quot;
        else
            type_1 = row.at_xpath('td[4]/text()').to_s.strip
            type_2 = row.at_xpath('td[5]/text()').to_s.strip
            image_link = &quot;images/missingo.png&quot;
        end

        types = Array.new
        types &lt;&lt; type_1 unless type_1.nil? || type_1.empty?
        types &lt;&lt; type_2 unless type_2.nil? || type_2.empty?

        #@col.insert({:number =&gt; dex_num, :name =&gt; dex_name, :types =&gt; types, :image =&gt; image_link}) #deleted
        Pokemon.create {:number =&gt; dex_num, :name =&gt; dex_name, :types =&gt; types, :image =&gt; image_link} #added

        num_to_add -= 1
    end
  end
end
</code></pre>

<p>That one&rsquo;s easy. We deleted four lines and added 3. However, now you can see that the Populater does not have to deal with connecting to the database, it only has to know what model it wants to modify. So we&rsquo;ve removed some complexity from this file by no longer requiring the database name on initialization. However, that means that someone else has to be in charge of setting up the initial connection. In the overlying project, we want that someone else to be a controller. In our tests, we want that someone else to be our test file. So let&rsquo;s do it. We&rsquo;re going to start by adding a config section in our before:all block.</p>

<p>``` ruby project/tools/test/spec/populater_spec.rb
require_relative &lsquo;../../populate/populater&rsquo;
#require &lsquo;mongo&rsquo; #removed
require &lsquo;mongoid&rsquo; #added
require_relative &lsquo;../../../pokemon&rsquo;</p>

<p>describe Populater do
    before:all do
        Mongoid.configure do |config| #added
            config.connect_to &lsquo;test&rsquo; #added
        end # added
        #@col = Mongo::Connection.new.db(&lsquo;test&rsquo;)[&ldquo;pokemons&rdquo;] # removed
    end
    &hellip;
end</p>

<pre><code>
In doing this, we've set up any of our document models to use the 'test' database. Now we go through each test and replace the Mongo Ruby Driver syntax with Mongoid syntax, which is similar to Ruby's Array syntax.

``` ruby project/tools/test/spec/populater_spec.rb
...

describe Populater do
	...
	before:each do
		#@populater = Populater.new('test') #removed
		@populater = Populater.new #added
	end

	describe &quot;#new&quot; do
		it &quot;does not throw when creating instance&quot; do
			#expect {Populater.new('test')}.to_not raise_error #removed
			expect {Populater.new}.to_not raise_error #added
		end

		it &quot;takes one param and returns a Populater instance&quot; do
			@populater.should be_an_instance_of Populater
		end

		it &quot;empties pokemon collection&quot; do
			#@col.insert({:test =&gt; &quot;hi there&quot;}) #removed
			#@col.find.count.should_not eql 0 #removed
			#Populater.new('test') #removed
			#@col.find.count.should eql 0 #removed
			Pokemon.create #added
			Pokemon.count.should eql 1 #added
			Populater.new #added
			Pokemon.count.should eql 0 #added
		end
	end
	...
end
</code></pre>

<p>The &lsquo;new&rsquo; tests are straightforward. We remove the usage of an input parameter to the Populater initializer. The only significant change we make is to the &ldquo;empties pokemon collection&rdquo; test. Here we replace the Mongo Ruby Driver syntax of inserting into a collection with Mongoid syntax of creating a Pokemon document. The &lsquo;create&rsquo; method inserts a document into the collection with the given values, or defaults if none are given. We also see that we can remove the &ldquo;find&rdquo; syntax completely and just use a &ldquo;count&rdquo; method on the document type.</p>

<p>``` ruby project/tools/test/spec/populater_spec.rb
&hellip;
describe Populater do
    &hellip;
    describe &ldquo;#add_pokemon&rdquo; do
        it &ldquo;adds 0 pokemon given 0&rdquo; do
            @populater.add_pokemon 0
            #@col.find.count.should eql 0 #removed
            Pokemon.count.should eql 0 #added
        end
        &hellip;
        it &ldquo;adds pokemon with a number&rdquo; do
            @populater.add_pokemon 1
            #@col.find.count.should eql 1 #removed
            #@col.find.first[&lsquo;number&rsquo;].should_not be_nil #removed
            Pokemon.count.should eql 1 #added
            Pokemon.first[&lsquo;number&rsquo;].should_not be_nil #added
    end
      &hellip;
    end
end</p>

<pre><code>
The tests for adding 0, 1, and 2 documents to the collection are all very similar. The only change is to replace the Mongo Ruby Driver &quot;find.count&quot; syntax with the Mongoid &quot;count.&quot; The &quot;adds pokemon with a ____&quot; tests all undergo the same changes. I replace the &quot;.find.first&quot; statement with a simple &quot;.first&quot; to get the same meaning. So our Populater has been converted to use Mongoid instead of the Mongo Ruby Driver. Bully for us.

There's one more change that would be nice to make before we hang up our hats. Configuring Mongoid using the .config syntax is okay, but it would be a lot nicer to keep all of our configuration in a file. We can create such a file called &quot;mongoid.yml&quot; and put some configuration information in it:

``` yml project/mongoid.yml
test:
  sessions:
    default:
      database: test
      hosts:
        - localhost
</code></pre>

<p>This syntax is valid in Mongoid 3.x. This is a very simply configuration for our test environment. Now we can go back into our test file and change the &lsquo;before:all&rsquo; block:</p>

<p><code>ruby project/tools/test/spec/populater_spec.rb
...
describe Populater do
    before:all do
        #Mongoid.configure do |config| #removed
        #   config.connect_to 'test' #removed
        #end # removed
        Mongoid.load! '../../../mongoid.yml', 'test' #added
    end
    ...
end
</code></p>

<p>The second parameter can be a string or a symbol. Now there&rsquo;s only one file to modify the environment configurations, and we&rsquo;re better off for it.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2013-01-05-schemaless-databases-with-ruby-and-mongodb/">
        Schemaless databases with Ruby and MongoDB
      </a>
    </h1>

    <span class="post-date">Sat, Jan 5, 2013</span>

    <p>This is Part 1 in a multi-part series to detail the creation of a &ldquo;simple&rdquo; project combining <a href="http://www.ruby-lang.org/">Ruby</a>, <a href="http://www.mongodb.org/">MongoDB</a>, <a href="http://rspec.info/">RSpec</a>, <a href="http://www.sinatrarb.com/">Sinatra</a>, and <a href="https://github.com/jnicklas/capybara">Capybara</a> in preperation for a larger-scale side project set to begin January 2013. For more in this series, see the <a href="/blog/categories/pokephile">Pokephile category</a>. Part 1 details getting started with MongoDB and creating a collection using data scraped off the web using <a href="http://nokogiri.org/">Nokogiri</a>. The code for this side-project is located <a href="https://github.com/larryprice/Pokephile">on Github</a>.</p>

<p>###A little background###</p>

<p>NoSQL is a database service used when working with a large amount of data that doesn&rsquo;t fit a relational model (read: <a href="http://en.wikipedia.org/wiki/Nosql">wikipedia</a>). It allows for mass storage without the overhead of SQL relations. There are many types of schemaless database services (<a href="http://en.wikipedia.org/wiki/Nosql#Taxonomy">here&rsquo;s a list</a>), but in particular I&rsquo;ve been looking into what&rsquo;s called &ldquo;Document Store.&rdquo;</p>

<p>Documents can be any number of key-value fields with a unique id. Document Store services usually encode data in a simple format such as XML, YAML, JSON, or BSON for storage purposes. MongoDB is a document store service which uses BSON to store documents. In Mongo, we connect to a specific database and then we can look through &ldquo;collections,&rdquo; which are more-or-less equivalent to &ldquo;tables&rdquo; in relational databases.</p>

<p>###What about MongoDB and the Ruby driver?###</p>

<p>The first step is to get MongoDB working on your machine. Install MongoDB for your system &ndash; on Ubuntu 12.10 I do this:</p>

<pre><code>sudo apt-get install mongodb mongodb-dev mongodb-clients mongodb-server
</code></pre>

<p>Then we start up the daemon:</p>

<pre><code>sudo service mongodb start
</code></pre>

<p>###What&rsquo;s the concept?###</p>

<p>The concept here is that we are going to have a database populated with <a href="http://www.pokemon.com/">Pokemon</a>. The user types a Pokemon&rsquo;s name into a search field and submits the form, which brings up an image of the Pokemon and some useful information.</p>

<p>###Getting started###</p>

<p>Since I would like to focus on MongoDB, we can start by populating our database with Pokemon. If you&rsquo;re not familiar with Pokemon, there are lots of them (~650 at the date of this blog post). For my purposes, I may want to only add the first ~150 Pokemon, or I may want to add every Pokemon imaginable. I want it to be easy to add more if any new ones are added. So I&rsquo;m going to start this project by creating a Populater, and we&rsquo;re going to use TDD to help us create it.</p>

<p>If you don&rsquo;t have RSpec installed, it&rsquo;s as easy as opening up a shell and:</p>

<pre><code>$ sudo gem install rspec mongo
</code></pre>

<p>I&rsquo;m going to put the Populater in a tools directory, and I&rsquo;m going to put my spec files in a test/spec directory. The directory structure I want to use is as follows:</p>

<pre><code>project
--tools
----populate
----test
------spec
</code></pre>

<p>In the &lsquo;tools/test/spec&rsquo; directory, I create &lsquo;populater_spec.rb.&rsquo; We&rsquo;ll write our first test:</p>

<p>``` ruby project/tools/test/spec/populater_spec.rb
describe Populater do
    describe &ldquo;#new&rdquo; do
        it &ldquo;does not throw when creating instance&rdquo; do
            expect {Populater.new}.to_not raise_error
        end
    end
end</p>

<pre><code>
The syntax for RSpec is mostly pseudo-English, so it's fairly straightforward to follow. The first 'describe' block says that we are describing the Populater class. The second 'describe' block says that we are describing the 'new' method of the 'Populater' class. The inner-most block is our test. We want to make sure that no exception is thrown when we create a new Populater. To run this test, open a terminal and type:

``` bash Running Rspec
$ pwd
~/project/tools/test
$ rspec populater_spec.rb
</code></pre>

<p>We get a big fat compile error, obviously due to the fact that there&rsquo;s no such thing as a &lsquo;Populater&rsquo; class. So create the file &lsquo;populater.rb&rsquo; in &lsquo;project/tools/populate&rsquo; and create the class:</p>

<p>``` ruby project/tools/populate/populater.rb
class Populater
end</p>

<pre><code>
And include the 'Populater' class in our spec file:

``` ruby project/tools/test/spec/populater_spec.rb
require_relative '../../populate/populater'

describe Populater do
	describe &quot;#new&quot; do
		it &quot;does not throw when creating instance&quot; do
			expect {Populater.new}.to_not raise_error
		end
	end
end
</code></pre>

<p>Now run rspec. Hooray, we&rsquo;re passing all our tests! Let&rsquo;s add another test and some let&rsquo;s have RSpec do a little work before each test.</p>

<p>``` ruby project/tools/test/spec/populater_spec.rb
require_relative &lsquo;../../populate/populater&rsquo;</p>

<p>describe Populater do
    before:each do
        @populater = Populater.new
    end</p>

<pre><code>describe &quot;#new&quot; do
    it &quot;does not throw when creating instance&quot; do
        expect {Populater.new}.to_not raise_error
    end

    it &quot;takes no params and returns a Populater instance&quot; do
        @populater.should be_an_instance_of Populater
    end
end
</code></pre>

<p>end</p>

<pre><code>
The 'before:each' syntax tells RSpec to perform this action before running each test. This way, we don't have to type out 'Populater.new' in each test. When we run RSpec, this test passes. Now let's actually do something meaningful in our new call. We want the Populater to empty all Pokemon from our database as it begins. In order to do this, we need to also tell the Populater what database to use, so we'll refactor slightly to pass in the name of our database to the Populater.

``` ruby project/tools/test/spec/populater_spec.rb
require_relative '../../populate/populater'
require 'mongo'

describe Populater do
	before:all do
		@col = Mongo::Connection.new.db('test')[&quot;pokemons&quot;]
	end
	before:each do
		@populater = Populater.new('test')
	end

	describe &quot;#new&quot; do
		it &quot;does not throw when creating instance&quot; do
			expect {Populater.new('test')}.to_not raise_error
		end

		it &quot;takes one param and returns a Populater instance&quot; do
			@populater.should be_an_instance_of Populater
		end

		it &quot;empties pokemon collection&quot; do
			@col.insert({:test =&gt; &quot;hi there&quot;})
			@col.find.count.should_not eql 0
			Populater.new('test')
			@col.find.count.should eql 0
		end
	end
end
</code></pre>

<p>Similar to the &lsquo;before:each&rsquo; syntax, the &lsquo;before:all&rsquo; syntax runs the statement once. Here we want to get a handle to the &lsquo;pokemons&rsquo; collection from our &lsquo;test&rsquo; database. In our test, we run a &lsquo;find&rsquo; with no arguments on the &lsquo;pokemons&rsquo; collection to query everything in that collection. We also have an &lsquo;insert&rsquo; statement where we insert an arbitrary document into our collection. You&rsquo;ll note later that this garbage document looks nothing like the Pokemon documents we insert, which is just another reason to love document-store databases. We run RSpec and we fail the test. Let&rsquo;s open up &lsquo;populater.rb&rsquo; and fix this.</p>

<p>``` ruby project/tools/populate/populater.rb
require &lsquo;mongo&rsquo;</p>

<p>class Populater
    def initialize(db_name)
        @col = Mongo::Connection.new.db(db_name)[&ldquo;pokemons&rdquo;]
        @col.remove
    end
end</p>

<pre><code>
Test fixed. We connect to the same database and access the same collection and remove all the old data on intialize. So now we actually want to add Pokemon to the collection. We'll pick up a new 'describe' block for an 'add_pokemon' method. We'll then test that calling it with 0 adds no Pokemon to the collection.

``` ruby project/tools/test/spec/populater_spec.rb
...
describe &quot;#add_pokemon&quot; do
	it &quot;adds 0 pokemon given 0&quot; do
		@populater.add_pokemon 0
		@col.find.count.should eql 0
	end
end
...
</code></pre>

<p>When we run our tests, we get a NoMethodError and fail. We create a trivial fix in populater.rb</p>

<p>``` ruby project/tools/populate/populater.rb
class Populater
    &hellip;</p>

<pre><code>def add_pokemon(num)
end
</code></pre>

<p>end</p>

<pre><code>
And we pass the test, having added 0 Pokemon to our database. Let's do it with 1 now.

``` ruby project/tools/test/spec/populater_spec.rb
...
describe &quot;#add_pokemon&quot; do
	...
	it &quot;adds 1 pokemon given 1&quot; do
		@populater.add_pokemon 1
		@col.find.count.should eql 1
	end
end
...
</code></pre>

<p>We fail. Another trivial fix:</p>

<p>``` ruby project/tools/populate/populater.rb
class Populater
    &hellip;</p>

<pre><code>def add_pokemon(num)
    (0...num).each do |x|
        @col.insert({number: x})
    end
end
</code></pre>

<p>end</p>

<pre><code>
We pass again. We'll also pass when checking for multiple Pokemon:

``` ruby project/tools/test/spec/populater_spec.rb
...
describe &quot;#add_pokemon&quot; do
	...
	it &quot;adds 2 pokemon given 2&quot; do
		@populater.add_pokemon 2
		@col.find.count.should eql 2
	end
end
...
</code></pre>

<p>But we&rsquo;re missing substance. There&rsquo;s only garbage being shoved in our database. Our TDD methodology breaks down slightly here because we want our database to have dynamic information scraped from a website, and I don&rsquo;t want to hard code any data nor do I want to scrape the same website in my tests and my implementation. So we&rsquo;re going to do a little bit of behind-the-scenes stuff and test that the fields we want are simply not nil. I want each Pokemon to have a number, name, an array of types, and a link to an image:</p>

<p>``` ruby project/tools/test/spec/populater_spec.rb
&hellip;
describe &ldquo;#add_pokemon&rdquo; do
    &hellip;
    it &ldquo;adds pokemon with a number&rdquo; do
        @populater.add_pokemon 1
        @col.find.count.should eql 1
        @col.find.first[&lsquo;number&rsquo;].should_not be_nil
    end
    it &ldquo;adds pokemon with a name&rdquo; do
        @populater.add_pokemon 1
        @col.find.count.should eql 1
        @col.find.first[&lsquo;name&rsquo;].should_not be_nil
    end
    it &ldquo;adds pokemon with array of types&rdquo; do
        @populater.add_pokemon 1
        @col.find.count.should eql 1
        types = @col.find.first[&lsquo;types&rsquo;]
        types.should_not be_nil
        types.should be_an_instance_of Array
        types.should have_at_least(1).items
        types.should have_at_most(2).items
    end
    it &ldquo;adds pokemon with image link&rdquo; do
        @populater.add_pokemon 1
        @col.find.count.should eql 1
        image = @col.find.first[&lsquo;image&rsquo;]
        image.should_not be_nil
        image.should_not be_empty
    end
end
&hellip;</p>

<pre><code>
There are many websites where you can get this kind of data for each Pokemon, but I chose [the Pokemon Wiki][pokewiki] for its consistency. In the initializer of the Populater, I open up the URL using Nokogiri so I can access the sweet, creamy data contained within. In my add_pokemon method, I extract this data I want based on the way the table is set up on the website. To continue, we need to install the Nokogiri gem:



</code></pre>

<p>sudo gem install nokogiri</p>

<pre><code>
And now we add the logic to add_pokemon:

``` ruby project/tools/populate/populater.rb
require 'mongo'
require 'nokogiri'
require 'open-uri'

class Populater
	def initialize(db_name)
		@col = Mongo::Connection.new.db(db_name)[&quot;pokemons&quot;]
		@col.remove
		@data = Nokogiri::HTML(open(&quot;http://pokemon.wikia.com/wiki/List_of_Pok%C3%A9mon&quot;))
	end

	def add_pokemon(num_to_add)
		@data.xpath(&quot;//table[@class='wikitable sortable']/tr&quot;).each do |row|
			break if num_to_add &lt;= 0
			dex_num = row.at_xpath('td/text()').to_s.strip
			next if dex_num.nil? || dex_num.empty?
			dex_name = row.at_xpath('td[2]/a/text()').to_s.strip

			unless dex_num == &quot;000&quot;
				type_1 = row.at_xpath('td[4]/a/span/text()').to_s.strip
				type_2 = row.at_xpath('td[5]/a/span/text()').to_s.strip || row.at_xpath('td[5]/text()').to_s.strip
				image_link = &quot;http://img.pokemondb.net/artwork/#{dex_name.downcase}.jpg&quot;
			else
				type_1 = row.at_xpath('td[4]/text()').to_s.strip
				type_2 = row.at_xpath('td[5]/text()').to_s.strip
				image_link = &quot;images/missingo.png&quot;
			end

			types = Array.new
			types &lt;&lt; type_1 unless type_1.nil? || type_1.empty?
			types &lt;&lt; type_2 unless type_2.nil? || type_2.empty?

			@col.insert({:number =&gt; dex_num, :name =&gt; dex_name, :types =&gt; types, :image =&gt; image_link})

			num_to_add -= 1
		end
	end
end
</code></pre>

<p>I&rsquo;ll admit The add_pokemon method is now quite a bit more daunting to interpret. Here&rsquo;s the breakdown of what&rsquo;s going on: Nokogiri finds us the table tag with class of &lsquo;wikitable sortable&rsquo; and we iterate over that. There are two breaking conditions of our loop: we hit the max number of Pokemon as given, or we can&rsquo;t find anymore Pokemon in the table. So we check that we haven&rsquo;t hit our max. Then we find the Pokemon&rsquo;s number in the table after we manually parse the HTML. In the case of this table, the first row is all garbage, so we continue to the next row if we are on the first row.  We then grab the name from the table, which is luckily always in the same place. The branch is for the special case of Pokemon #000 (Missingo), which is set up slightly differently in the table for some reason. We create an empty array and shove our types in it, but we have to be careful because not all Pokemon have two types. We then create a document in the braces and insert it into the collection. The final step is to decrement the loop counter.</p>

<p>Tests pass. We now have a working Populater! Now we can either write a script or open up the irb and populate as necessary and we know that the Populater is functional:</p>

<p><code>ruby Populating Databases
$ irb
&gt;&gt; Dir.pwd
=&gt; &quot;project/tools/populate&quot;
&gt;&gt; require 'mongo'
=&gt; true
&gt;&gt; col = Mongo::Connection.new.db('dev')[&quot;pokemons&quot;]
=&gt; ...
&gt;&gt; col.find.count
=&gt; 0
&gt;&gt; require './populater'
=&gt; true
&gt;&gt; Populater.new('dev').add_pokemon 152
=&gt; nil
&gt;&gt; col.find.count
152
&gt;&gt;
</code></p>

<p>If you want to further familiarize yourself with the MongoDB Ruby driver, you should check out the MongoDB Koans. Unfortunately, the original <a href="https://github.com/tredfern/MongoDB_Koans">MongoDB Koans</a> have not been updated in a while, and so my more recent installations of Ruby and the MongoDB driver didn&rsquo;t work. I found a set of <a href="https://github.com/edgecase/ruby_koans">updated koans</a> which worked with my install of Ruby 1.9.3. However, the updated version also had a couple of annoying issues with deprecations, so I created <a href="https://github.com/larryprice/MongoDB_Koans">my own fork</a> on GitHub with the fixes.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2012-11-27-who-moved-my-cheese-an-amazing-way-to-deal-with-change-in-your-work-and-in-your-life/">
        Who Moved My Cheese?: An Amazing Way to Deal with Change in Your Work and in Your Life
      </a>
    </h1>

    <span class="post-date">Tue, Nov 27, 2012</span>

    <p><img src="http://dontstepinthepoop.com/wp-content/uploads/2010/01/cheese.jpg" style="border: 0" width="130px" title="Who Moved My Cheese?" alt="Cover for Who Moved My Cheese?" /><br />
<a href="http://www.amazon.com/gp/product/0399144463/ref=as_li_ss_tl?ie=UTF8&amp;camp=1789&amp;creative=390957&amp;creativeASIN=0399144463&amp;linkCode=as2&amp;tag=larpriandthee-20"><strong>Who Moved My Cheese?: An Amazing Way to Deal with Change in Your Work and in Your Life</strong></a><br />
<strong>Spencer Johnson</strong></p>

<hr />

<p>###The Gist###</p>

<p><em>Who Moved My Cheese?</em> is a book about being prepared to lose your job. The book was written during times of rapid economic growth caused by the <a href="http://en.wikipedia.org/wiki/Dot-com_boom">dot-com bubble</a>, which resulted in many companies emerging out of the primordial ooze and then falling back down into the tarpit after an extremely short time on the market. The author uses a cute analogy about cheese to convey that success is fleeting, and each day could be the day a company will shut down.</p>

<p>###My Feelings###</p>

<p>This is another book I read during summer 2012 and wrote a mediocre write-up regarding. This write-up is fresh and in my new write-up style.</p>

<p>The authors of this book want to help people realize that their job is a gift, not a privilage. Just because a company is doing well this quarter does not imply that it will still be in business next quarter. During the time period this book was written in, this was especially true. The theory of companies during the late &lsquo;90s was to spend as much money as possible to gather as many customers as possible disregarding profits in the short-term (read: <a href="http://www.paulgraham.com/start.html">Get Large or Get Lost</a>). Of course, this kind of mentality did not fit all businesses, and many companies which looked like they would be the future leaders of the American economy were quickly forgotten by the mid-2000s (see: <a href="http://en.wikipedia.org/wiki/Pets.com">Pets.com</a>).</p>

<p>The authors want employees to stop fearing change, and to accept it as a normal part of life. Sometimes companies falter, and oftentimes there&rsquo;s nothing an individual can do about it. In doing so, sometimes old friends are left behind while an individual moves on in search of bigger and better things. Sometimes it takes a long time to find those bigger and better things, but every time it&rsquo;s worth it due to the thrill of confronting your fears and exploring something new.</p>

<p>The use of a &ldquo;maze&rdquo; with two tiny people and two anthropomorphic mice is strange and feels purposefully forced. The authors wanted to make a memorable anecdote, and they succeeded with their strange analogy. Having said that, several times I was confused by the names of the four characters as they were very similar and nonsensical. Because of this, I had to reread some sections after referencing the first page of the book to determine who was who.</p>

<p>The primary author appended &ldquo;MD&rdquo; to his name on the front cover. Similarly, the &ldquo;secondary&rdquo; author appended a &ldquo;PhD&rdquo; to his name on the front cover. This bothered me as it is an obvious ploy to make people value the opinions held within the book more highly because they are written by &ldquo;doctors.&rdquo;</p>

<p>###Who Would Like This###</p>

<p>This is a book that tries to prepare people for the worst and to teach them not to just give up when the future looks grim. It could be an interesting book for anyone, especially after several years of an economic boom caused by a new technology. A person who is very content in their current position at a company could also benefit from this book, as it may give them some incentive to seek out change.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2012-11-26-the-passionate-programmer-creating-a-remarkable-career-in-software-development/">
        The Passionate Programmer: Creating a Remarkable Career in Software Development
      </a>
    </h1>

    <span class="post-date">Mon, Nov 26, 2012</span>

    <p><img src="http://www.inquisitivechap.com/wp-content/uploads/2010/11/ThePassionateProgrammerCover.png" style="border: 0" width="130px" title="The Passionate Programmer: Creating a Remarkable Career in Software Development" alt="Cover for The Passionate Programmer" /><br />
<a href="http://www.amazon.com/gp/product/1934356344/ref=as_li_ss_tl?ie=UTF8&amp;camp=1789&amp;creative=390957&amp;creativeASIN=1934356344&amp;linkCode=as2&amp;tag=larpriandthee-20"><strong>The Passionate Programmer: Creating a Remarkable Career in Software Development</strong></a><br />
<strong>Chad Fowler</strong></p>

<hr />

<p>###The Gist###</p>

<p>This book tells the story of Chad Fowler (no relation to <a href="http://martinfowler.com/">Martin Fowler</a>). Fowler got himself into a software development slump and was able to turn it around and rejuvinate his passion for his career. Much of the book revolves around how to keep oneself engaged with one&rsquo;s work and how to determine when it&rsquo;s time to shake things up.</p>

<p>###My Feelings###</p>

<p>I read this book in Summer 2012 and did a mediocre write-up on my old blog, so I&rsquo;ve decided to quickly redo the write-up from scratch using my new format.</p>

<p>What Fowler talks about in his book is exactly what I was afraid of when looking for a job last fall: getting stuck. It&rsquo;s easy to do: many employers are looking for employees who are willing to work on projects throughout their entire lifespan, which may be 12 months, 5 years or in some cases the lifespan of the company.</p>

<p>Personal story time. I was offered a job at an Indianapolis company with many long-term projects. One of my interviewers had been working on his current project for 5 years, and was trying desparately to get out of it. However, based on his seniority and domain knowledge of the project, he was told it would be at least another 6 months before he could move on. The developer was miserable working his current job and had no exit routes available to him, which scared me quite a bit.</p>

<p>Fowler&rsquo;s methods don&rsquo;t describe how to avoid this situation. They describe how to keep yourself happy by learning new technology and branching away from your &ldquo;domain knowledge&rdquo; while still remaining the go-to guy on your current project. Showing an interest in doing things outside of your current project should show an employer that you&rsquo;re capable of more, and that you&rsquo;re more than willing to do something new.</p>

<p>Fowler also talks about moving jobs if you&rsquo;re unhappy, noting that the new world of software development doesn&rsquo;t offer all the bells and whistles that it used to. Although I agree that you should try to find a new job if you&rsquo;re unhappy, it&rsquo;s not always as easy to pack up your things and move as the author makes it seem.</p>

<p>The coolest parts of the book were the personal stories of several high-tech big-wigs. The silliest parts were the &lsquo;Act On It&rsquo; sections. The &lsquo;Act On It&rsquo; sections described how to implement some of the methods detailed in the book, but they often seemed obvious and unnecessary to me.</p>

<p>###Who Would Like This###</p>

<p>This book can offer a lot to someone who wants to revitalize their career after getting in a rut. It may also be able to serve as a guide to preventing yourself from getting in a rut. As a recent college grad with many of my dreams still alive, I only found a moderate amount of honey in this beehive. An interesting read, but maybe not entirely relevant to fresh faces.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2012-11-26-how-linux-works-what-every-superuser-should-know/">
        How Linux Works: What Every Superuser Should Know
      </a>
    </h1>

    <span class="post-date">Mon, Nov 26, 2012</span>

    <p><img src="http://books.gigaimg.com/avaxhome/77/6b/000c6b77_medium.jpeg" style="border: 0" width="130px" title="How Linux Works" alt="Cover for How Linux Works" /><br />
<a href="http://www.amazon.com/gp/product/1593270356/ref=as_li_ss_tl?ie=UTF8&amp;camp=1789&amp;creative=390957&amp;creativeASIN=1593270356&amp;linkCode=as2&amp;tag=larpriandthee-20"><strong>How Linux Works: Things Every Superuser Should Know</strong></a><br />
<strong>Brian Ward</strong></p>

<hr />

<p>###The Gist###</p>

<p>Linux is a complicated operating system which gives its users the freedom to do anything. This book details things that any Linux superuser should be aware of, including printing, networking, scripting, compiling source code, setting up users, and buying hardware.</p>

<p>###My Feelings###</p>

<p>I&rsquo;ve been running <a href="http://ubuntu.com/">Ubuntu</a> as the only operating system on my home computer since the 11.04 Natty Narwhal release in 2011, and I&rsquo;ve been using Ubuntu in varying degrees since 9.04 Lucid Lynx. I&rsquo;ve also recently ported my wife&rsquo;s computer over to Ubuntu after she finally got fed up with Linux. There is a course at Purdue called ECE364 that taught us lots of cool Linux commands which I had forgotten, so I&rsquo;ve been looking for a good refresher. This book helped jog my memory of things like grep, sed, and awk. The book also provided lots of information on things that I&rsquo;d been using for years without really realizing what I was doing.</p>

<p>This book was written in 2004, which was a long time ago in the computing world. In 2004, Ubuntu Linux (<a href="http://www.pcworld.com/article/254516/which_linux_distro_is_fairest_of_them_all_ubuntu_survey_says.html">the most popular personal desktop Linux distribution</a>) was released. Ward makes mentions of setting up network interfaces, firewalls, and printers through the terminal, which are all things that now are either done automatically by most operating systems or at a minimum have a GUI to support setup. Ward also mentions that <a href="http://en.wikipedia.org/wiki/Cathode_ray_tube">CRT monitors</a> are on the cheap, but if you want the best resolution an <a href="http://en.wikipedia.org/wiki/Lcd">LCD monitor</a> is the new cool thang. He talks about <a href="http://en.wikipedia.org/wiki/Pentium">Pentium processors</a>, half gigabytes of DDR, and slow, heavy laptops. Be warned that you won&rsquo;t find anything in this book about 64-bit processors, SSDs, or cloud computing.</p>

<p>Most of the book is still very relevant. As mentioned previously, I got a lot of benefit from reading the section on common commands. The section on setting up dot-files was also extremely useful for me. There was also a lot of interesting information about the Linux filesystem being databases that I had never really thought about before.</p>

<p>###Who Would Like This###</p>

<p>Those new to Linux or those needing a refresher would benefit from scanning this book, at least the interesting sections. This book is not for people looking for bleeding-edge information on their new hardware or software. The reader can get a large amount of information that has aged well and will continue to be relevant for Linux users for years to come.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2012-11-08-the-optimistic-programmer/">
        The Optimistic Programmer
      </a>
    </h1>

    <span class="post-date">Thu, Nov 8, 2012</span>

    <p>Meet Anne. Anne&rsquo;s a programmer in a thriving tech company. Anne goes into work every day to work on a shiny new product for her company.</p>

<p>Anne&rsquo;s customer knows exactly what they want. Anne writes all of her tests using pure TDD. Anne updates her tasks on the company&rsquo;s ALM software, which was defined with programmers in mind and not just managers. She knows everything about her domain, and every UI element she touches is the epitome of good user experience. She works with 100 other programmers, each of which is equally as skilled as she is. Every time she pushes her most recent file changes, there are no merge conflicts and the build server works without a hitch. The deadline for the project is defined as whenever the last feature is finished. The best part: Anne spends fewer than an hour a week in meetings, none of which is a complete waste of time.</p>

<p>You&rsquo;ve got to be kidding me.</p>

<p>If I experienced a day like I just described for Anne, I would have to assume I had been killed in a tragic car accident on my way into work.</p>

<p>How can a programmer possibly be optimistic? Let me say: The client never knows what they want. The programmer couldn&rsquo;t possibly write all of their tests TDD style unless they&rsquo;re a saint. ALM software has a tendency to suck. Programmers don&rsquo;t have the inherent ability to know precisely how a user will try to use the product. Oftentimes your teammates may not be on the same level as you are, or you may not be on as high a level as they are. There are always merge conflicts and build server anomalies. &lsquo;Random&rsquo; is generally an apt description of project deadlines. Lastly, we spend lots of times in meetings which often don&rsquo;t appear to provide much face value. Those are the facts of life.</p>

<p>If we&rsquo;re optimists, why would we bother writing tests for anything beyond happy-path? How could we ever justify refactoring if we&rsquo;re optimistic that we did it right the first time? Why bother putting in security if no one will ever try to use their 1337 hax to get to the client&rsquo;s data? It&rsquo;s important that we stay planted firmly in reality to ensure we think of most everything that can go wrong when a customer uses a product.</p>

<p>I&rsquo;m not saying there aren&rsquo;t optimistic moments in a programmer&rsquo;s life. Phrases like &ldquo;I&rsquo;m optimistic the project will end some day&rdquo; and &ldquo;I&rsquo;m pretty sure the customer will like this&rdquo; and &ldquo;I highly doubt we&rsquo;ll get sued for that&rdquo; are phrases that I&rsquo;d feel inclined to throw around most any time to raise the morale of my companions.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2012-10-30-good-idea-bad-idea/">
        Good Idea, Bad Idea
      </a>
    </h1>

    <span class="post-date">Tue, Oct 30, 2012</span>

    <p>There is a general, unnamed rule when coming up with ideas:</p>

<p><strong><em>A person is required to have one or more bad ideas before having a single good idea</em></strong>.</p>

<p>Since this rule is unnamed, it shall henceforth be referred to as Larry&rsquo;s Law.</p>

<p>Note that the thinker in question is not limited to just one bad idea under Larry&rsquo;s Law, but as many as he so desires. Also note that Larry&rsquo;s Law does not imply that the thinker will necessarily ever have any good ideas.</p>

<p>Having bad ideas is necessary. Bad ideas let the brain see what it shouldn&rsquo;t be thinking about, which has the potential to lead to good ideas. Then again, many bad ideas may just spawn more bad ideas. That&rsquo;s just Larry&rsquo;s Law.</p>

<p>###Examples###</p>

<p>You sit down at your desk and pick up a bug. Your first idea doesn&rsquo;t fix the code. Your second idea doesn&rsquo;t compile. Your third idea breaks all 3400 unit tests in the test suite. Your fourth idea is a complete hack. Your fifth idea breaks some other component of the application. Your sixth idea seems genius to you but doesn&rsquo;t survive the code review. Your seventh idea is a winner.</p>

<p>Before Edison could invent the <a href="http://edison.rutgers.edu/ticker.htm">Universal Stock Ticker</a>, he had to invent a <a href="http://edison.rutgers.edu/vote.htm">crummy vote recorder</a>.</p>

<p>Do you have any idea the number of albums Pink Floyd released before <a href="http://en.wikipedia.org/wiki/The_Dark_Side_of_the_Moon"><em>The Dark Side of the Moon</em></a>? <a href="http://en.wikipedia.org/wiki/Pink_Floyd_discography">Seven</a>. Don&rsquo;t kid yourself: these seven albums were not gems. But don&rsquo;t fret! Larry&rsquo;s Law states that these albums had to be low quality to allow <em>The Dark Side of the Moon</em> to be a monumental album.</p>

<p>Someone invented <a href="http://en.wikipedia.org/wiki/New_coke">New Coke</a>. This is an instance of someone making a bad decision without any corresponding good decisions.</p>

<p>Domino&rsquo;s pizza was <a href="http://www.nowpublic.com/culture/pizza-turnaround-dominos-pizza-knows-they-suck-2555951.html">terrible</a> until very recently. Now it&rsquo;s delicious, at least according to <a href="http://answers.yahoo.com/question/index?qid=20110609112806AABnOTo">this man on Yahoo! Answers</a>.</p>

<p>A group of people wants to go out to eat. Jon Doe will suggest Jimmy John&rsquo;s, then Penn Station, McDonald&rsquo;s, Five Guys, Taco Bell, and Denny&rsquo;s. Finally Jon Doe offers a reasonable idea, like YATS. This process will now be repeated by every person in the group, and the best decision will never become visible. And Larry&rsquo;s Law specifies that the group may never come to a good decision, and will probably end up eating at Five Guys.</p>

<p>###Conclusion###</p>

<p>The next time you have a bad idea, embrace it. Realize that having that bad idea might clear space in your head for a good idea. Or possibly an infinite number of bad ideas. Either way, that&rsquo;s just Larry&rsquo;s Law.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2012-10-24-i-dont-have-time/">
        I Don&#39;t Have Time
      </a>
    </h1>

    <span class="post-date">Wed, Oct 24, 2012</span>

    <p>&ldquo;Wanna go for a walk?&rdquo; my wife asks over my shoulder.</p>

<p>&ldquo;I don&rsquo;t have time for your walks, woman! I&rsquo;ve got a city to run!&rdquo; I exclaim as I frantically move the mouse around the screen to raise taxes on the rich so I can afford to build another statue of myself in the blossoming city of Velcro. I&rsquo;d been absolutely engulfed in the popular city simulator <a href="http://en.wikipedia.org/wiki/Simcity_4"><em>SimCity 4</em></a> for about five hours already that day. Needless to say, my wife &ldquo;convinced&rdquo; me to hit the pause button on the game and join her back in reality, where I&rsquo;m a software developer who has to go on walks to counter his poor eating habits.</p>

<p>We take time too seriously.</p>

<p>When we feel like we don&rsquo;t have enough time, we complain. When we feel like we have too much time, we think we&rsquo;re bored, and so we complain about that.</p>

<p>Maybe if we spent less time complaining, we&rsquo;d have time to see how ridiculous we are.</p>

<p>Time is time. What&rsquo;s there is there, and we&rsquo;re not getting any more or less of it based on what we get accomplished in a given day.</p>

<p>&hellip;Unless of course what you accomplish is manipulating time in some manner. Or you create a serum to slow/expediate/stop the aging process. But those are side projects to talk about in another blog post on another day.</p>

<p>Back to <em>SimCity 4</em>. After I rediscovered the dusty game disc at my parents&rsquo; house, the game completely absorbed me, even 10 years after it was originally released (my computer is finally powerful enough to play it). I didn&rsquo;t mind that it was taking up so much of my time. I had a myriad of more conventional things I wanted to do that weekend: side projects to work on, books to read, TV shows to watch, internets to check, housework to do, groceries to buy, and meals to cook; but none of that mattered.</p>

<p>I repeat: none of that important-sounding stuff mattered. I had stumbled upon this completely arbitrary childhood memory to relive, so everything else took a back seat. I don&rsquo;t regret all the hours I ended up spending on that game, as a kid or as an adult. A compulsive opportunity arose to have some fun and I snatched it up. I stopped worrying about time and decided to just enjoy myself. You should try it sometime. We spend way too much of our time trying to abide by our schedules and to-do lists. The best parts of life are when you stumble upon something that makes you completely forget what you were doing before you found it, and then continues to obliterate any plans you might have had for the rest of the day.</p>

<p>Now if you&rsquo;ll excuse me, I have a city to run.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="http://localhost:1313/blog/2012-10-19-a-hacky-solution-to-the-unicode-data-in-a-unicode-only-collation-problem/">
        A Hacky Solution to the Unicode data in a Unicode-only collation problem
      </a>
    </h1>

    <span class="post-date">Fri, Oct 19, 2012</span>

    

<h2 id="the-issue-rises-a-id-problem-a:a2aad8e9f521de4be9814af43014a140">The Issue Rises <a id="problem"></a></h2>

<p>Earlier this week a defect was found in my application. A defect that I could have sworn I fixed several weeks ago and written about in a <a href="http://nullablevoid.blogspot.com/2012/10/unicode-data-in-unicode-only-collation.html">previous blog post</a>. Let me start from the beginning:</p>

<h4 id="the-setup:a2aad8e9f521de4be9814af43014a140">The Setup</h4>

<p>The application is a web app using Rails 3.2, MSSQL Server for the database, and Tiny-TDS for database communications from the CloudFoundry server. There are three different types of builds and three databases I access: development (for development, obviously), staging (for testing), and production (for the users to complain about, mostly).</p>

<h4 id="the-original-issue:a2aad8e9f521de4be9814af43014a140">The Original Issue</h4>

<p>I inherited this code and ran it on my dev build with no issues. Upon doing some testing with the staging build, the page crashed. The logs revealed the following (horrible) error:</p>

<p>``` ruby Vague error
Unicode data in a Unicode-only collation or ntext data cannot be sent to clients using DB-Library (such as ISQL) or ODBC version 3.7 or earlier.</p>

<pre><code>
What does this mean? Well. Beats me. [Several][s1] [sources][s2] had [similar][s3] [issues][s4] and the ones I liked eventually came to the conclusion that ntext and nvarchar variables in the database were ticking off the host server. [Apparently][msdn], text variables are translated to nvarchar(MAX), where MAX is something like 2GB of data. I hunted through my database and, sure enough, the 'Narrative' column was an nvarchar(MAX).







#### The Original Fix ####

Based on the mighty power of the internet, I decided that the best thing for me to do was to change the variable in the database from a &quot;text&quot; to a &quot;string&quot; with a limit of 8000 (which translates to varchar(8000)) using this migration:

``` ruby Simple migration
class ChangeNarrativeColumnToVarChar &lt; ActiveRecord::Migration
  def change
    change_column :evaluation, :narrative, :string, :limit =&gt; 8000
  end
</code></pre>

<p>I ran through my repro steps and&hellip; Drumroll&hellip; Suspense&hellip; It worked! Or so it appeared. I went to the narrative textbox and put some words in it, saved, and confirmed that everything was great. Then I pushed it to production and heard nothing for two weeks.</p>

<h2 id="failure-is-always-an-option-a-id-failure-a:a2aad8e9f521de4be9814af43014a140">Failure Is Always An Option <a id="failure"></a></h2>

<p>Too bad that wasn&rsquo;t the end of the story. This week my users finally started using the app again. They found all kinds of defects, of course, but one in particular that caught me off guard: When viewing the narrative text, which we had &ldquo;fixed&rdquo; using that little migration above, the text cut off to about two lines. Two lines? I never really bothered to test more than a couple words or a short, goofy phrase. So I opened up the app on my dev build and it worked great with up to 8000 characters. I switched over to the staging build and was able to reproduce the error immediately.</p>

<p>At first I thought it was just the test_area, but I was wrong. Even static fields which displayed narrative cut off text. After some testing, the text was always cut off to 255 characters. I watched the SQL logs and confirmed that all 8000 characters would come back from the SQL queries. I looked in the database and verified the data was still present. What was going on?</p>

<h4 id="dear-rails-oh-you:a2aad8e9f521de4be9814af43014a140">Dear Rails: Oh, you</h4>

<p>I thought and eventually realized something: the default of a &ldquo;string&rdquo; in Rails is 255 characters. Rails was cutting off my text. Curse you, Rails, I trusted you with my heart!</p>

<h4 id="the-fix:a2aad8e9f521de4be9814af43014a140">The Fix</h4>

<p>Alright. The fix. Unfortunately, the fix sucks. In my app, I had to get the whole model that contained a narrative. Doing only that, the narrative would be cut short. So then I had to get the narrative again, and this time cast that sucker to a &ldquo;text.&rdquo;</p>

<p><code>ruby &lt; 1337 Hax
@eval = Evaluation.find(:id =&gt; id)
@eval.narrative = Evaluation.select(&quot;id as id, CAST(narrative as text) as narrative&quot;).where(:id =&gt; id).first.narrative
</code></p>

<p>There&rsquo;s a part of me that likes sensible, clean code. This code did not come from that part of me. If you really want, you can do a select and get all the columns of your model, and then case the field in question, but what if your columns change? I didn&rsquo;t want to be responsible for that, especially after I hand this code off to someone else in the coming weeks.</p>

  </div>
  
</div>
</div>

  <script>document.write('<script src="http://'
        + (location.host || 'localhost').split(':')[0]
		+ ':1313/livereload.js?mindelay=10"></'
        + 'script>')</script></body>
</html>
